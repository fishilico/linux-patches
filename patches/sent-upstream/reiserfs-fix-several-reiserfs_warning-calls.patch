From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: Nicolas Iooss <nicolas.iooss_linux@m4x.org>
Date: Mon, 2 Mar 2015 22:48:59 +0800
Subject: [PATCH] reiserfs: fix several reiserfs_warning calls

reiserfs_warning takes an id and a format as arguments, not a single
format argument.  Fix 4 calls which do not follow this.

These bugs were found by adding __printf(4, 5) attribute to
__reiserfs_warning and using "gcc -Wformat=2" when compiling the
kernel.

Fixes: 45b03d5e8e67 ("reiserfs: rework reiserfs_warning")
Signed-off-by: Nicolas Iooss <nicolas.iooss_linux@m4x.org>

Sent-upstream: https://lkml.org/lkml/2015/3/6/311
---
 fs/reiserfs/bitmap.c  | 4 ++--
 fs/reiserfs/journal.c | 4 ++--
 fs/reiserfs/procfs.c  | 4 ++--
 3 files changed, 6 insertions(+), 6 deletions(-)

diff --git a/fs/reiserfs/bitmap.c b/fs/reiserfs/bitmap.c
index dc198bc64c61..1d02f184863d 100644
--- a/fs/reiserfs/bitmap.c
+++ b/fs/reiserfs/bitmap.c
@@ -1423,8 +1423,8 @@ struct buffer_head *reiserfs_read_bitmap_block(struct super_block *sb,
 
 	bh = sb_bread(sb, block);
 	if (bh == NULL)
-		reiserfs_warning(sb, "sh-2029: %s: bitmap block (#%u) "
-		                 "reading failed", __func__, block);
+		reiserfs_warning(sb, "sh-2029",
+				 "bitmap block (#%u) reading failed", block);
 	else {
 		if (buffer_locked(bh)) {
 			int depth;
diff --git a/fs/reiserfs/journal.c b/fs/reiserfs/journal.c
index bc2dde2423c2..cdce05fe323e 100644
--- a/fs/reiserfs/journal.c
+++ b/fs/reiserfs/journal.c
@@ -2640,8 +2640,8 @@ static int journal_init_dev(struct super_block *super,
 	if (IS_ERR(journal->j_dev_bd)) {
 		result = PTR_ERR(journal->j_dev_bd);
 		journal->j_dev_bd = NULL;
-		reiserfs_warning(super,
-				 "journal_init_dev: Cannot open '%s': %i",
+		reiserfs_warning(super, NULL,
+				 "Cannot open '%s': %i",
 				 jdev_name, result);
 		return result;
 	}
diff --git a/fs/reiserfs/procfs.c b/fs/reiserfs/procfs.c
index fe999157dd97..46a16cc49b0b 100644
--- a/fs/reiserfs/procfs.c
+++ b/fs/reiserfs/procfs.c
@@ -435,7 +435,7 @@ int reiserfs_proc_info_init(struct super_block *sb)
 		add_file(sb, "journal", show_journal);
 		return 0;
 	}
-	reiserfs_warning(sb, "cannot create /proc/%s/%s",
+	reiserfs_warning(sb, NULL, "cannot create /proc/%s/%s",
 			 proc_info_root_name, b);
 	return 1;
 }
@@ -464,7 +464,7 @@ int reiserfs_proc_info_global_init(void)
 	if (proc_info_root == NULL) {
 		proc_info_root = proc_mkdir(proc_info_root_name, NULL);
 		if (!proc_info_root) {
-			reiserfs_warning(NULL, "cannot create /proc/%s",
+			reiserfs_warning(NULL, NULL, "cannot create /proc/%s",
 					 proc_info_root_name);
 			return 1;
 		}
-- 
