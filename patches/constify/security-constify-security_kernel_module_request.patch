From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: Nicolas Iooss <nicolas.iooss_linux@m4x.org>
Date: Sat, 22 Oct 2016 11:42:20 +0200
Subject: [PATCH] {CONSTIFY} security: constify security_kernel_module_request
 argument

---
 include/linux/lsm_audit.h | 2 +-
 include/linux/lsm_hooks.h | 2 +-
 include/linux/security.h  | 4 ++--
 security/security.c       | 2 +-
 security/selinux/hooks.c  | 2 +-
 5 files changed, 6 insertions(+), 6 deletions(-)

diff --git a/include/linux/lsm_audit.h b/include/linux/lsm_audit.h
index 915330abf6e5..747eafda8a6b 100644
--- a/include/linux/lsm_audit.h
+++ b/include/linux/lsm_audit.h
@@ -88,7 +88,7 @@ struct common_audit_data {
 			char *key_desc;
 		} key_struct;
 #endif
-		char *kmod_name;
+		const char *kmod_name;
 		struct lsm_ioctlop_audit *op;
 		struct file *file;
 		struct lsm_ibpkey_audit *ibpkey;
diff --git a/include/linux/lsm_hooks.h b/include/linux/lsm_hooks.h
index c9258124e417..6ee72ad1304c 100644
--- a/include/linux/lsm_hooks.h
+++ b/include/linux/lsm_hooks.h
@@ -1509,7 +1509,7 @@ union security_list_options {
 	void (*cred_transfer)(struct cred *new, const struct cred *old);
 	int (*kernel_act_as)(struct cred *new, u32 secid);
 	int (*kernel_create_files_as)(struct cred *new, struct inode *inode);
-	int (*kernel_module_request)(char *kmod_name);
+	int (*kernel_module_request)(const char *kmod_name);
 	int (*kernel_read_file)(struct file *file, enum kernel_read_file_id id);
 	int (*kernel_post_read_file)(struct file *file, char *buf, loff_t size,
 				     enum kernel_read_file_id id);
diff --git a/include/linux/security.h b/include/linux/security.h
index ce6265960d6c..b5b695b2a204 100644
--- a/include/linux/security.h
+++ b/include/linux/security.h
@@ -326,7 +326,7 @@ int security_prepare_creds(struct cred *new, const struct cred *old, gfp_t gfp);
 void security_transfer_creds(struct cred *new, const struct cred *old);
 int security_kernel_act_as(struct cred *new, u32 secid);
 int security_kernel_create_files_as(struct cred *new, struct inode *inode);
-int security_kernel_module_request(char *kmod_name);
+int security_kernel_module_request(const char *kmod_name);
 int security_kernel_read_file(struct file *file, enum kernel_read_file_id id);
 int security_kernel_post_read_file(struct file *file, char *buf, loff_t size,
 				   enum kernel_read_file_id id);
@@ -919,7 +919,7 @@ static inline int security_kernel_create_files_as(struct cred *cred,
 	return 0;
 }
 
-static inline int security_kernel_module_request(char *kmod_name)
+static inline int security_kernel_module_request(const char *kmod_name)
 {
 	return 0;
 }
diff --git a/security/security.c b/security/security.c
index 4bf0f571b4ef..d43ddd4cc031 100644
--- a/security/security.c
+++ b/security/security.c
@@ -1014,7 +1014,7 @@ int security_kernel_create_files_as(struct cred *new, struct inode *inode)
 	return call_int_hook(kernel_create_files_as, 0, new, inode);
 }
 
-int security_kernel_module_request(char *kmod_name)
+int security_kernel_module_request(const char *kmod_name)
 {
 	return call_int_hook(kernel_module_request, 0, kmod_name);
 }
diff --git a/security/selinux/hooks.c b/security/selinux/hooks.c
index 11c3a45dda56..c6abf36c9ba6 100644
--- a/security/selinux/hooks.c
+++ b/security/selinux/hooks.c
@@ -3880,7 +3880,7 @@ static int selinux_kernel_create_files_as(struct cred *new, struct inode *inode)
 	return ret;
 }
 
-static int selinux_kernel_module_request(char *kmod_name)
+static int selinux_kernel_module_request(const char *kmod_name)
 {
 	struct common_audit_data ad;
 
-- 
