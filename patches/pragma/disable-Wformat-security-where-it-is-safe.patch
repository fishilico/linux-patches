From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: Nicolas Iooss <nicolas.iooss_linux@m4x.org>
Date: Wed, 18 Mar 2015 23:20:16 +0800
Subject: [PATCH] {PRAGMA} disable -Wformat-security where it is safe

---
 arch/arm/kernel/traps.c                       |  7 ++-
 arch/arm/mach-omap2/clkt2xxx_virt_prcm_set.c  |  3 ++
 arch/x86/kernel/cpu/mce/amd.c                 | 17 +++++-
 arch/x86/kernel/cpu/mce/core.c                |  3 ++
 arch/x86/kernel/cpu/resctrl/ctrlmondata.c     |  3 ++
 arch/x86/kernel/cpu/resctrl/rdtgroup.c        |  6 +++
 arch/x86/kernel/e820.c                        |  4 ++
 arch/x86/xen/smp_pv.c                         |  6 ++-
 drivers/accel/habanalabs/gaudi2/gaudi2.c      |  3 ++
 drivers/accel/habanalabs/goya/goya.c          |  3 ++
 drivers/accessibility/speakup/keyhelp.c       |  6 +++
 drivers/accessibility/speakup/main.c          | 21 ++++++++
 drivers/accessibility/speakup/speakup_soft.c  |  3 ++
 drivers/accessibility/speakup/synth.c         |  3 ++
 drivers/accessibility/speakup/varhandlers.c   |  3 ++
 drivers/acpi/acpi_apd.c                       |  3 ++
 drivers/acpi/acpi_lpss.c                      |  3 ++
 drivers/ata/sata_mv.c                         |  3 ++
 drivers/atm/eni.c                             |  3 ++
 drivers/bcma/scan.c                           |  3 ++
 drivers/block/aoe/aoechr.c                    |  6 ++-
 drivers/cdrom/cdrom.c                         |  3 ++
 drivers/char/mem.c                            |  3 ++
 drivers/clk/clk-qoriq.c                       |  3 ++
 drivers/clk/clkdev.c                          |  3 ++
 drivers/clk/ti/adpll.c                        |  3 ++
 .../intel/qat/qat_common/adf_transport.c      |  3 ++
 drivers/gpio/gpiolib-sysfs.c                  |  3 ++
 drivers/gpu/drm/amd/amdkfd/kfd_chardev.c      |  3 ++
 drivers/gpu/drm/drm_sysfs.c                   |  7 +++
 drivers/hid/hid-sony.c                        |  6 +++
 drivers/hwmon/abituguru.c                     |  9 ++++
 drivers/hwmon/abituguru3.c                    |  3 ++
 drivers/hwmon/applesmc.c                      | 10 ++++
 drivers/hwmon/hwmon.c                         |  6 +++
 drivers/hwmon/lm63.c                          |  3 ++
 drivers/hwmon/lm95234.c                       |  3 ++
 drivers/hwmon/nct6683.c                       |  3 ++
 drivers/hwmon/nct6775-core.c                  |  3 ++
 drivers/iio/accel/bma180.c                    |  3 ++
 drivers/iio/accel/bmc150-accel-core.c         |  4 ++
 drivers/infiniband/core/device.c              |  7 +++
 drivers/infiniband/hw/hfi1/debugfs.c          |  4 ++
 drivers/infiniband/hw/qib/qib_file_ops.c      |  4 ++
 drivers/input/joystick/adi.c                  |  3 ++
 drivers/input/joystick/tmdc.c                 |  3 ++
 drivers/iommu/irq_remapping.c                 |  3 ++
 drivers/media/dvb-frontends/tda10021.c        |  3 ++
 drivers/media/dvb-frontends/tda10023.c        |  3 ++
 drivers/media/dvb-frontends/ves1820.c         |  3 ++
 drivers/media/pci/cx23885/cx23885-dvb.c       |  3 ++
 drivers/media/radio/radio-shark.c             |  3 ++
 drivers/media/radio/radio-shark2.c            |  3 ++
 drivers/media/usb/pvrusb2/pvrusb2-std.c       |  4 ++
 drivers/memory/tegra/tegra20.c                |  4 ++
 drivers/mfd/mc13xxx-core.c                    |  3 ++
 drivers/misc/altera-stapl/altera.c            |  4 ++
 drivers/misc/cb710/debug.c                    |  3 ++
 drivers/mmc/core/mmc.c                        |  4 ++
 drivers/net/ethernet/8390/smc-ultra.c         |  3 ++
 drivers/net/ethernet/8390/wd.c                |  3 ++
 drivers/net/ethernet/amd/lance.c              |  3 ++
 .../ethernet/aquantia/atlantic/aq_ethtool.c   | 21 ++++++++
 .../ethernet/broadcom/bnx2x/bnx2x_ethtool.c   |  3 ++
 .../ethernet/chelsio/cxgb4/cxgb4_debugfs.c    |  3 ++
 drivers/net/ethernet/chelsio/cxgb4/l2t.c      |  6 ++-
 drivers/net/ethernet/engleder/tsnep_ethtool.c |  3 ++
 .../ethernet/freescale/enetc/enetc_ethtool.c  |  6 +++
 drivers/net/ethernet/google/gve/gve_ethtool.c |  6 +++
 .../ethernet/hisilicon/hns/hns_dsaf_xgmac.c   |  8 ++-
 .../net/ethernet/huawei/hinic/hinic_ethtool.c |  3 ++
 .../net/ethernet/intel/fm10k/fm10k_debugfs.c  |  6 +++
 .../net/ethernet/marvell/mvpp2/mvpp2_main.c   |  3 ++
 .../marvell/octeon_ep/octep_ethtool.c         |  6 +++
 .../ethernet/marvell/prestera/prestera_pci.c  |  3 ++
 .../mellanox/mlx5/core/diag/fw_tracer.c       |  3 ++
 .../ethernet/mellanox/mlx5/core/en_stats.c    | 54 ++++++++++++++++---
 drivers/net/ethernet/natsemi/natsemi.c        |  3 ++
 drivers/net/ethernet/netronome/nfp/abm/ctrl.c |  3 ++
 drivers/net/ethernet/netronome/nfp/nfp_main.c |  6 +++
 .../ethernet/netronome/nfp/nfp_net_common.c   |  3 ++
 drivers/net/ethernet/packetengines/hamachi.c  |  3 ++
 .../net/ethernet/packetengines/yellowfin.c    |  6 +++
 drivers/net/ethernet/qlogic/qed/qed_debug.c   |  7 +++
 drivers/net/ethernet/qlogic/qed/qed_int.c     |  7 ++-
 .../net/ethernet/qlogic/qlcnic/qlcnic_ctx.c   |  3 ++
 drivers/net/ethernet/qualcomm/emac/emac-mac.c |  3 ++
 drivers/net/ethernet/sfc/ethtool_common.c     | 10 +++-
 drivers/net/ethernet/sfc/falcon/ethtool.c     |  3 ++
 .../net/ethernet/sfc/siena/ethtool_common.c   | 10 +++-
 drivers/net/ethernet/sis/sis900.c             |  3 ++
 drivers/net/ethernet/sun/niu.c                |  6 +++
 drivers/net/fddi/defxx.c                      |  3 ++
 drivers/net/hamradio/baycom_epp.c             |  3 ++
 drivers/net/hamradio/baycom_par.c             |  3 ++
 drivers/net/hamradio/baycom_ser_fdx.c         |  3 ++
 drivers/net/hamradio/baycom_ser_hdx.c         |  3 ++
 drivers/net/hamradio/bpqether.c               |  3 ++
 drivers/net/hamradio/scc.c                    |  3 ++
 drivers/net/hamradio/yam.c                    |  3 ++
 drivers/net/hippi/rrunner.c                   |  3 ++
 drivers/net/hyperv/netvsc_drv.c               |  6 ++-
 drivers/net/phy/phy_device.c                  |  3 ++
 drivers/net/wan/lapbether.c                   |  3 ++
 drivers/net/wireless/broadcom/b43/main.c      |  6 +++
 .../broadcom/brcm80211/brcmfmac/chip.c        |  3 ++
 .../net/wireless/intel/iwlegacy/4965-debug.c  |  9 ++++
 .../net/wireless/intel/iwlwifi/dvm/debugfs.c  |  9 ++++
 drivers/net/wireless/intel/iwlwifi/fw/dbg.h   |  3 ++
 .../net/wireless/intel/iwlwifi/mvm/debugfs.c  |  3 ++
 .../net/wireless/intel/iwlwifi/mvm/mac-ctxt.c |  3 ++
 drivers/net/wireless/intel/iwlwifi/mvm/rx.c   |  3 ++
 .../net/wireless/marvell/mwifiex/sta_ioctl.c  |  3 ++
 drivers/net/wwan/wwan_core.c                  |  4 ++
 drivers/parport/share.c                       |  3 ++
 drivers/pci/probe.c                           |  6 +++
 drivers/pnp/interface.c                       |  4 ++
 drivers/regulator/of_regulator.c              |  4 ++
 drivers/regulator/qcom-rpmh-regulator.c       |  4 ++
 drivers/scsi/aacraid/linit.c                  |  3 ++
 drivers/scsi/aic7xxx/aic79xx_pci.c            |  7 ++-
 drivers/scsi/iscsi_boot_sysfs.c               |  3 ++
 drivers/scsi/lpfc/lpfc_debugfs.c              | 18 +++++++
 drivers/scsi/myrs.c                           |  4 ++
 drivers/scsi/qla2xxx/qla_init.c               |  4 +-
 drivers/scsi/scsi_logging.c                   |  3 ++
 drivers/scsi/smartpqi/smartpqi_init.c         |  3 ++
 drivers/scsi/st.c                             |  3 ++
 drivers/soundwire/sysfs_slave_dpn.c           |  9 +++-
 drivers/staging/most/dim2/dim2.c              |  3 ++
 drivers/staging/vme_user/vme_user.c           |  3 ++
 drivers/tty/serial/pch_uart.c                 |  3 ++
 drivers/usb/core/devices.c                    | 24 +++++++++
 drivers/usb/core/file.c                       |  3 ++
 drivers/usb/fotg210/fotg210-hcd.c             |  9 ++++
 drivers/usb/host/ehci-dbg.c                   | 12 +++++
 drivers/video/fbdev/matrox/i2c-matroxfb.c     |  4 ++
 fs/btrfs/check-integrity.c                    |  6 +++
 fs/btrfs/ctree.c                              | 12 +++++
 fs/btrfs/inode-item.c                         |  3 ++
 fs/btrfs/relocation.c                         |  4 ++
 fs/btrfs/sysfs.c                              |  3 ++
 fs/btrfs/volumes.c                            |  3 ++
 fs/libfs.c                                    |  4 ++
 fs/ocfs2/ocfs2_fs.h                           |  7 ++-
 fs/proc/version.c                             |  3 ++
 fs/reiserfs/prints.c                          |  4 +-
 include/linux/kernel.h                        | 16 +++++-
 include/rdma/rdma_vt.h                        |  3 ++
 kernel/bpf/helpers.c                          |  3 ++
 kernel/bpf/verifier.c                         |  3 ++
 kernel/debug/kdb/kdb_io.c                     | 18 +++++++
 kernel/debug/kdb/kdb_main.c                   |  7 +++
 kernel/kthread.c                              |  4 ++
 kernel/trace/trace.c                          |  6 +++
 kernel/trace/trace_events_synth.c             |  9 ++++
 kernel/trace/trace_probe.c                    |  3 ++
 lib/globtest.c                                |  4 ++
 lib/test_printf.c                             | 10 ++++
 mm/kasan/report.c                             |  3 ++
 mm/shmem.c                                    |  3 ++
 mm/slub.c                                     |  3 ++
 net/8021q/vlanproc.c                          |  3 ++
 net/can/proc.c                                |  3 ++
 net/core/dev.c                                | 15 ++++++
 net/netfilter/ipvs/ip_vs_sync.c               |  4 ++
 net/netfilter/nf_tables_api.c                 |  4 ++
 net/netfilter/nft_compat.c                    |  3 ++
 net/tipc/netlink_compat.c                     |  3 ++
 security/integrity/ima/ima_policy.c           |  3 ++
 sound/core/ctljack.c                          |  3 ++
 sound/core/misc.c                             |  3 ++
 sound/core/seq/seq_clientmgr.c                |  3 ++
 sound/drivers/dummy.c                         |  3 ++
 sound/drivers/opl3/opl3_seq.c                 |  3 ++
 sound/firewire/digi00x/digi00x-midi.c         |  3 ++
 sound/pci/korg1212/korg1212.c                 |  3 ++
 sound/pci/rme32.c                             |  3 ++
 sound/pci/rme96.c                             |  3 ++
 sound/soc/intel/avs/topology.c                |  9 ++++
 sound/soc/intel/boards/sof_sdw.c              |  3 ++
 sound/usb/midi.c                              |  3 ++
 sound/usb/mixer_quirks.c                      |  3 ++
 sound/usb/mixer_scarlett_gen2.c               |  8 ++-
 184 files changed, 906 insertions(+), 32 deletions(-)

diff --git a/arch/arm/kernel/traps.c b/arch/arm/kernel/traps.c
index 40c7c807d67f..1c4bdeb7e4bb 100644
--- a/arch/arm/kernel/traps.c
+++ b/arch/arm/kernel/traps.c
@@ -196,10 +196,13 @@ static void dump_instr(const char *lvl, struct pt_regs *regs)
 			val = __mem_to_opcode_arm(val);
 		}
 
-		if (!bad)
+		if (!bad) {
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 			p += sprintf(p, i == 0 ? "(%0*x) " : "%0*x ",
 					width, val);
-		else {
+#pragma GCC diagnostic pop
+		} else {
 			p += sprintf(p, "bad PC value");
 			break;
 		}
diff --git a/arch/arm/mach-omap2/clkt2xxx_virt_prcm_set.c b/arch/arm/mach-omap2/clkt2xxx_virt_prcm_set.c
index be4557d1fdac..9b2f52d46dd6 100644
--- a/arch/arm/mach-omap2/clkt2xxx_virt_prcm_set.c
+++ b/arch/arm/mach-omap2/clkt2xxx_virt_prcm_set.c
@@ -252,6 +252,9 @@ void omap2xxx_clkt_vps_init(void)
 		return;
 	}
 
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	clkdev_create(clk, "cpufreq_ck", NULL);
+#pragma GCC diagnostic pop
 }
 #endif
diff --git a/arch/x86/kernel/cpu/mce/amd.c b/arch/x86/kernel/cpu/mce/amd.c
index 0b971f974096..24bb6aa61e3a 100644
--- a/arch/x86/kernel/cpu/mce/amd.c
+++ b/arch/x86/kernel/cpu/mce/amd.c
@@ -1117,7 +1117,10 @@ static int allocate_threshold_blocks(unsigned int cpu, struct threshold_bank *tb
 	else
 		tb->blocks = b;
 
-	err = kobject_init_and_add(&b->kobj, &threshold_ktype, tb->kobj, get_name(cpu, bank, b));
+	__diag_push()
+	__diag_ignore(GCC, 4, "-Wformat-security", "bank4_names(b) and th_names[bank] are well-defined constant string");
+	err = kobject_init_and_add(&b->kobj, &threshold_ktype, tb->kobj, "%s", get_name(cpu, bank, b));
+	__diag_pop()
 	if (err)
 		goto out_free;
 recurse:
@@ -1149,13 +1152,21 @@ static int __threshold_add_blocks(struct threshold_bank *b)
 	struct threshold_block *tmp = NULL;
 	int err = 0;
 
+/* b->blocks->kobj.name comes from allocate_threshold_blocks */
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	err = kobject_add(&b->blocks->kobj, b->kobj, b->blocks->kobj.name);
+#pragma GCC diagnostic pop
 	if (err)
 		return err;
 
 	list_for_each_entry_safe(pos, tmp, head, miscj) {
 
+/* pos->kobj.name comes from allocate_threshold_blocks */
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 		err = kobject_add(&pos->kobj, b->kobj, pos->kobj.name);
+#pragma GCC diagnostic pop
 		if (err) {
 			list_for_each_entry_safe_reverse(pos, tmp, head, miscj)
 				kobject_del(&pos->kobj);
@@ -1185,7 +1196,11 @@ static int threshold_create_bank(struct threshold_bank **bp, unsigned int cpu,
 		if (nb && nb->bank4) {
 			/* yes, use it */
 			b = nb->bank4;
+/* name is a constant string */
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 			err = kobject_add(b->kobj, &dev->kobj, name);
+#pragma GCC diagnostic pop
 			if (err)
 				goto out;
 
diff --git a/arch/x86/kernel/cpu/mce/core.c b/arch/x86/kernel/cpu/mce/core.c
index 2eec60f50057..8f714e9dbcc8 100644
--- a/arch/x86/kernel/cpu/mce/core.c
+++ b/arch/x86/kernel/cpu/mce/core.c
@@ -286,7 +286,10 @@ static noinstr void mce_panic(const char *msg, struct mce *final, char *exp)
 	if (!fake_panic) {
 		if (panic_timeout == 0)
 			panic_timeout = mca_cfg.panic_timeout;
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 		panic(msg);
+#pragma GCC diagnostic pop
 	} else
 		pr_emerg(HW_ERR "Fake kernel panic: %s\n", msg);
 
diff --git a/arch/x86/kernel/cpu/resctrl/ctrlmondata.c b/arch/x86/kernel/cpu/resctrl/ctrlmondata.c
index b44c487727d4..a47204c803e1 100644
--- a/arch/x86/kernel/cpu/resctrl/ctrlmondata.c
+++ b/arch/x86/kernel/cpu/resctrl/ctrlmondata.c
@@ -474,8 +474,11 @@ static void show_doms(struct seq_file *s, struct resctrl_schema *schema, int clo
 			ctrl_val = resctrl_arch_get_config(r, dom, closid,
 							   schema->conf_type);
 
+		__diag_push()
+		__diag_ignore(GCC, 4, "-Wformat-security", "r->format_str is '%d=%0*x' or '%d=%*d'")
 		seq_printf(s, r->format_str, dom->id, max_data_width,
 			   ctrl_val);
+		__diag_pop()
 		sep = true;
 	}
 	seq_puts(s, "\n");
diff --git a/arch/x86/kernel/cpu/resctrl/rdtgroup.c b/arch/x86/kernel/cpu/resctrl/rdtgroup.c
index 6ad33f355861..54d15cde63e4 100644
--- a/arch/x86/kernel/cpu/resctrl/rdtgroup.c
+++ b/arch/x86/kernel/cpu/resctrl/rdtgroup.c
@@ -291,13 +291,19 @@ static int rdtgroup_cpus_show(struct kernfs_open_file *of,
 				ret = -ENODEV;
 			} else {
 				mask = &rdtgrp->plr->d->cpu_mask;
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 				seq_printf(s, is_cpu_list(of) ?
 					   "%*pbl\n" : "%*pb\n",
 					   cpumask_pr_args(mask));
+#pragma GCC diagnostic pop
 			}
 		} else {
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 			seq_printf(s, is_cpu_list(of) ? "%*pbl\n" : "%*pb\n",
 				   cpumask_pr_args(&rdtgrp->cpu_mask));
+#pragma GCC diagnostic pop
 		}
 	} else {
 		ret = -ENOENT;
diff --git a/arch/x86/kernel/e820.c b/arch/x86/kernel/e820.c
index fb8cf953380d..890807176d4d 100644
--- a/arch/x86/kernel/e820.c
+++ b/arch/x86/kernel/e820.c
@@ -874,8 +874,12 @@ unsigned long __init e820__end_of_low_ram_pfn(void)
 
 static void __init early_panic(char *msg)
 {
+/* format is safe here */
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	early_printk(msg);
 	panic(msg);
+#pragma GCC diagnostic pop
 }
 
 static int userdef __initdata;
diff --git a/arch/x86/xen/smp_pv.c b/arch/x86/xen/smp_pv.c
index a9cf8c8fa074..b4f0f0a4b99c 100644
--- a/arch/x86/xen/smp_pv.c
+++ b/arch/x86/xen/smp_pv.c
@@ -210,13 +210,15 @@ static void __init xen_pv_smp_prepare_cpus(unsigned int max_cpus)
 	unsigned cpu;
 
 	if (skip_ioapic_setup) {
-		char *m = (max_cpus == 0) ?
+		const char *m = (max_cpus == 0) ?
 			"The nosmp parameter is incompatible with Xen; " \
 			"use Xen dom0_max_vcpus=1 parameter" :
 			"The noapic parameter is incompatible with Xen";
-
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 		xen_raw_printk(m);
 		panic(m);
+#pragma GCC diagnostic pop
 	}
 	xen_init_lock_cpu(0);
 
diff --git a/drivers/accel/habanalabs/gaudi2/gaudi2.c b/drivers/accel/habanalabs/gaudi2/gaudi2.c
index b778cf764a68..9126c802934b 100644
--- a/drivers/accel/habanalabs/gaudi2/gaudi2.c
+++ b/drivers/accel/habanalabs/gaudi2/gaudi2.c
@@ -7199,11 +7199,14 @@ static void gaudi2_is_tpc_engine_idle(struct hl_device *hdev, int dcore, int ins
 	if (idle_data->mask && !is_eng_idle)
 		set_bit(engine_idx, idle_data->mask);
 
+	__diag_push()
+	__diag_ignore(GCC, 4, "-Wformat-security", "The format is defined elsewhere in this file")
 	if (idle_data->e)
 		hl_engine_data_sprintf(idle_data->e,
 					idle_data->tpc_fmt, dcore, inst,
 					is_eng_idle ? "Y" : "N",
 					qm_glbl_sts0, qm_cgm_sts, tpc_cfg_sts);
+	__diag_pop()
 }
 
 static bool gaudi2_get_tpc_idle_status(struct hl_device *hdev, u64 *mask_arr, u8 mask_len,
diff --git a/drivers/accel/habanalabs/goya/goya.c b/drivers/accel/habanalabs/goya/goya.c
index fb0ac9df841a..703bfa22aec1 100644
--- a/drivers/accel/habanalabs/goya/goya.c
+++ b/drivers/accel/habanalabs/goya/goya.c
@@ -4351,6 +4351,8 @@ static void goya_get_event_desc(u16 event_type, char *desc, size_t size)
 {
 	u8 index;
 
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	switch (event_type) {
 	case GOYA_ASYNC_EVENT_ID_TPC0_ECC:
 	case GOYA_ASYNC_EVENT_ID_TPC1_ECC:
@@ -4431,6 +4433,7 @@ static void goya_get_event_desc(u16 event_type, char *desc, size_t size)
 		snprintf(desc, size, _goya_get_event_desc(event_type));
 		break;
 	}
+#pragma GCC diagnostic pop
 }
 
 static void goya_print_razwi_info(struct hl_device *hdev)
diff --git a/drivers/accessibility/speakup/keyhelp.c b/drivers/accessibility/speakup/keyhelp.c
index 822ceac83068..aa9a6023398a 100644
--- a/drivers/accessibility/speakup/keyhelp.c
+++ b/drivers/accessibility/speakup/keyhelp.c
@@ -148,7 +148,10 @@ int spk_handle_help(struct vc_data *vc, u_char type, u_char ch, u_short key)
 		if (ch < 'a' || ch > 'z')
 			return -1;
 		if (letter_offsets[ch - 'a'] == -1) {
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 			synth_printf(spk_msg_get(MSG_NO_COMMAND), ch);
+#pragma GCC diagnostic pop
 			synth_printf("\n");
 			return 1;
 		}
@@ -187,7 +190,10 @@ int spk_handle_help(struct vc_data *vc, u_char type, u_char ch, u_short key)
 		}
 		key += (state_tbl[i] << 8);
 		say_key(key);
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 		synth_printf(spk_msg_get(MSG_KEYDESC), name);
+#pragma GCC diagnostic pop
 		synth_printf("\n");
 		return 1;
 	}
diff --git a/drivers/accessibility/speakup/main.c b/drivers/accessibility/speakup/main.c
index 56c073103cbb..b30dab0e55bc 100644
--- a/drivers/accessibility/speakup/main.c
+++ b/drivers/accessibility/speakup/main.c
@@ -1038,8 +1038,11 @@ static void say_last_char(struct vc_data *vc)
 
 static void say_position(struct vc_data *vc)
 {
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	synth_printf(spk_msg_get(MSG_POS_INFO), spk_y + 1, spk_x + 1,
 		     vc->vc_num + 1);
+#pragma GCC diagnostic pop
 	synth_printf("\n");
 }
 
@@ -1049,7 +1052,10 @@ static void say_char_num(struct vc_data *vc)
 	u_char tmp;
 	u16 ch = get_char(vc, (u_short *)spk_pos, &tmp);
 
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	synth_printf(spk_msg_get(MSG_CHAR_INFO), ch, ch);
+#pragma GCC diagnostic pop
 }
 
 /* these are stub functions to keep keyboard.c happy. */
@@ -1102,8 +1108,11 @@ static void spkup_write(const u16 *in_buf, int count)
 		} else {
 			if ((last_type & CH_RPT) && rep_count > 2) {
 				synth_printf(" ");
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 				synth_printf(spk_msg_get(MSG_REPEAT_DESC),
 					     ++rep_count);
+#pragma GCC diagnostic pop
 				synth_printf(" ");
 			}
 			rep_count = 0;
@@ -1148,8 +1157,11 @@ static void spkup_write(const u16 *in_buf, int count)
 	if (in_count > 2 && rep_count > 2) {
 		if (last_type & CH_RPT) {
 			synth_printf(" ");
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 			synth_printf(spk_msg_get(MSG_REPEAT_DESC2),
 				     ++rep_count);
+#pragma GCC diagnostic pop
 			synth_printf(" ");
 		}
 		rep_count = 0;
@@ -1892,8 +1904,11 @@ static void speakup_win_set(struct vc_data *vc)
 		win_left = 0;
 		win_right = vc->vc_cols - 1;
 		win_bottom = spk_y;
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 		snprintf(info, sizeof(info), spk_msg_get(MSG_WINDOW_LINE),
 			 (int)win_top + 1);
+#pragma GCC diagnostic pop
 	} else {
 		if (!win_start) {
 			win_top = spk_y;
@@ -1902,10 +1917,13 @@ static void speakup_win_set(struct vc_data *vc)
 			win_bottom = spk_y;
 			win_right = spk_x;
 		}
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 		snprintf(info, sizeof(info), spk_msg_get(MSG_WINDOW_BOUNDARY),
 			 (win_start) ?
 				spk_msg_get(MSG_END) : spk_msg_get(MSG_START),
 			 (int)spk_y + 1, (int)spk_x + 1);
+#pragma GCC diagnostic pop
 	}
 	synth_printf("%s\n", info);
 	win_start++;
@@ -1943,7 +1961,10 @@ static void speakup_bits(struct vc_data *vc)
 		return;
 	}
 	pb_edit = &spk_punc_info[val];
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	synth_printf(spk_msg_get(MSG_EDIT_PROMPT), pb_edit->name);
+#pragma GCC diagnostic pop
 	spk_special_handler = edit_bits;
 }
 
diff --git a/drivers/accessibility/speakup/speakup_soft.c b/drivers/accessibility/speakup/speakup_soft.c
index 6d446824677b..9037d1c3f6d7 100644
--- a/drivers/accessibility/speakup/speakup_soft.c
+++ b/drivers/accessibility/speakup/speakup_soft.c
@@ -176,8 +176,11 @@ static char *get_initstring(void)
 	while (var->var_id != MAXVARS) {
 		if (var->var_id != CAPS_START && var->var_id != CAPS_STOP &&
 		    var->var_id != PAUSE && var->var_id != DIRECT) {
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 			n = scnprintf(cp, len, var->u.n.synth_fmt,
 				      var->u.n.value);
+#pragma GCC diagnostic pop
 			cp = cp + n;
 			len = len - n;
 		}
diff --git a/drivers/accessibility/speakup/synth.c b/drivers/accessibility/speakup/synth.c
index eea2a2fa4f01..afc0b27ac77d 100644
--- a/drivers/accessibility/speakup/synth.c
+++ b/drivers/accessibility/speakup/synth.c
@@ -300,7 +300,10 @@ void synth_insert_next_index(int sent_num)
 		}
 
 		out = synth->indexing.currindex * 10 + sent_num;
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 		synth_printf(synth->indexing.command, out, out);
+#pragma GCC diagnostic pop
 	}
 }
 
diff --git a/drivers/accessibility/speakup/varhandlers.c b/drivers/accessibility/speakup/varhandlers.c
index 462f8d879053..062fc71478f1 100644
--- a/drivers/accessibility/speakup/varhandlers.c
+++ b/drivers/accessibility/speakup/varhandlers.c
@@ -241,11 +241,14 @@ int spk_set_num_var(int input, struct st_var_header *var, int how)
 		cp = spk_pitch_buff;
 	else
 		cp = buf;
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	if (!var_data->u.n.out_str)
 		sprintf(cp, var_data->u.n.synth_fmt, (int)val);
 	else
 		sprintf(cp, var_data->u.n.synth_fmt,
 			var_data->u.n.out_str[val]);
+#pragma GCC diagnostic pop
 	synth_printf("%s", cp);
 	return 0;
 }
diff --git a/drivers/acpi/acpi_apd.c b/drivers/acpi/acpi_apd.c
index 80f945cbec8a..e26f2d0b86e7 100644
--- a/drivers/acpi/acpi_apd.c
+++ b/drivers/acpi/acpi_apd.c
@@ -52,7 +52,10 @@ static int acpi_apd_setup(struct apd_private_data *pdata)
 		clk = clk_register_fixed_rate(&pdata->adev->dev,
 					dev_name(&pdata->adev->dev),
 					NULL, 0, dev_desc->fixed_clk_rate);
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 		clk_register_clkdev(clk, NULL, dev_name(&pdata->adev->dev));
+#pragma GCC diagnostic pop
 		pdata->clk = clk;
 	}
 
diff --git a/drivers/acpi/acpi_lpss.c b/drivers/acpi/acpi_lpss.c
index 77186f084d3a..0105ba0f3d00 100644
--- a/drivers/acpi/acpi_lpss.c
+++ b/drivers/acpi/acpi_lpss.c
@@ -477,7 +477,10 @@ static int register_device_clock(struct acpi_device *adev,
 		return PTR_ERR(clk);
 
 	pdata->clk = clk;
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	clk_register_clkdev(clk, dev_desc->clk_con_id, devname);
+#pragma GCC diagnostic pop
 	return 0;
 }
 
diff --git a/drivers/ata/sata_mv.c b/drivers/ata/sata_mv.c
index d404e631d152..9993285c04a5 100644
--- a/drivers/ata/sata_mv.c
+++ b/drivers/ata/sata_mv.c
@@ -2699,8 +2699,11 @@ static void mv_err_intr(struct ata_port *ap)
 	}
 	if (edma_err_cause & (EDMA_ERR_DEV_DCON | EDMA_ERR_DEV_CON)) {
 		ata_ehi_hotplugged(ehi);
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 		ata_ehi_push_desc(ehi, edma_err_cause & EDMA_ERR_DEV_DCON ?
 			"dev disconnect" : "dev connect");
+#pragma GCC diagnostic pop
 		action |= ATA_EH_RESET;
 	}
 
diff --git a/drivers/atm/eni.c b/drivers/atm/eni.c
index a31ffe16e626..79098c9fa022 100644
--- a/drivers/atm/eni.c
+++ b/drivers/atm/eni.c
@@ -121,7 +121,10 @@ static void event_dump(void)
 	for (n = 0; n < EV; n++) {
 		i = (ec+n) % EV;
 		printk(KERN_NOTICE);
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 		printk(ev[i] ? ev[i] : "(null)",ev_a[i],ev_b[i]);
+#pragma GCC diagnostic pop
 	}
 }
 
diff --git a/drivers/bcma/scan.c b/drivers/bcma/scan.c
index 26d12a7e6ca0..cdb905dc38ea 100644
--- a/drivers/bcma/scan.c
+++ b/drivers/bcma/scan.c
@@ -447,8 +447,11 @@ void bcma_detect_chip(struct bcma_bus *bus)
 	chipinfo->rev = (tmp & BCMA_CC_ID_REV) >> BCMA_CC_ID_REV_SHIFT;
 	chipinfo->pkg = (tmp & BCMA_CC_ID_PKG) >> BCMA_CC_ID_PKG_SHIFT;
 
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	snprintf(chip_id, ARRAY_SIZE(chip_id),
 		 (chipinfo->id > 0x9999) ? "%d" : "0x%04X", chipinfo->id);
+#pragma GCC diagnostic pop
 	bcma_info(bus, "Found chip with id %s, rev 0x%02X and package 0x%02X\n",
 		  chip_id, chipinfo->rev, chipinfo->pkg);
 }
diff --git a/drivers/block/aoe/aoechr.c b/drivers/block/aoe/aoechr.c
index 4c666f72203f..35728f453433 100644
--- a/drivers/block/aoe/aoechr.c
+++ b/drivers/block/aoe/aoechr.c
@@ -297,10 +297,14 @@ aoechr_init(void)
 	}
 	aoe_class->devnode = aoe_devnode;
 
-	for (i = 0; i < ARRAY_SIZE(chardevs); ++i)
+	for (i = 0; i < ARRAY_SIZE(chardevs); ++i) {
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 		device_create(aoe_class, NULL,
 			      MKDEV(AOE_MAJOR, chardevs[i].minor), NULL,
 			      chardevs[i].name);
+#pragma GCC diagnostic pop
+	}
 
 	return 0;
 }
diff --git a/drivers/cdrom/cdrom.c b/drivers/cdrom/cdrom.c
index 416f723a2dbb..bb34f4b8c40c 100644
--- a/drivers/cdrom/cdrom.c
+++ b/drivers/cdrom/cdrom.c
@@ -3451,7 +3451,10 @@ static int cdrom_print_info(const char *header, int val, char *info,
 	struct cdrom_device_info *cdi;
 	int ret;
 
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	ret = scnprintf(info + *pos, max_size - *pos, header);
+#pragma GCC diagnostic pop
 	if (!ret)
 		return 1;
 
diff --git a/drivers/char/mem.c b/drivers/char/mem.c
index f494d31f2b98..937b352e535c 100644
--- a/drivers/char/mem.c
+++ b/drivers/char/mem.c
@@ -777,8 +777,11 @@ static int __init chr_dev_init(void)
 		if ((minor == DEVPORT_MINOR) && !arch_has_dev_port())
 			continue;
 
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 		device_create(mem_class, NULL, MKDEV(MEM_MAJOR, minor),
 			      NULL, devlist[minor].name);
+#pragma GCC diagnostic pop
 	}
 
 	return tty_init();
diff --git a/drivers/clk/clk-qoriq.c b/drivers/clk/clk-qoriq.c
index 5eddb9f0d6bd..e9edfe6fb501 100644
--- a/drivers/clk/clk-qoriq.c
+++ b/drivers/clk/clk-qoriq.c
@@ -920,7 +920,10 @@ static struct clk * __init create_mux_common(struct clockgen *cg,
 	char name[32];
 	int i, j;
 
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	snprintf(name, sizeof(name), fmt, idx);
+#pragma GCC diagnostic pop
 
 	for (i = 0, j = 0; i < NUM_MUX_PARENTS; i++) {
 		unsigned long rate;
diff --git a/drivers/clk/clkdev.c b/drivers/clk/clkdev.c
index cdf25d7196d7..4e6f72a0c8bb 100644
--- a/drivers/clk/clkdev.c
+++ b/drivers/clk/clkdev.c
@@ -245,8 +245,11 @@ int clk_add_alias(const char *alias, const char *alias_dev_name,
 	if (IS_ERR(r))
 		return PTR_ERR(r);
 
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	l = clkdev_create(r, alias, alias_dev_name ? "%s" : NULL,
 			  alias_dev_name);
+#pragma GCC diagnostic pop
 	clk_put(r);
 
 	return l ? 0 : -ENODEV;
diff --git a/drivers/clk/ti/adpll.c b/drivers/clk/ti/adpll.c
index 6ecbba4342c5..6a3542cf910b 100644
--- a/drivers/clk/ti/adpll.c
+++ b/drivers/clk/ti/adpll.c
@@ -212,7 +212,10 @@ static int ti_adpll_setup_clock(struct ti_adpll_data *d, struct clk *clock,
 			dev_warn(d->dev, "clock %s con_id lookup may fail\n",
 				 name);
 		snprintf(con_id, 16, "pll%03lx%s", d->pa & 0xfff, postfix + 1);
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 		cl = clkdev_create(clock, con_id, NULL);
+#pragma GCC diagnostic pop
 		if (!cl)
 			return -ENOMEM;
 		d->clocks[index].cl = cl;
diff --git a/drivers/crypto/intel/qat/qat_common/adf_transport.c b/drivers/crypto/intel/qat/qat_common/adf_transport.c
index 630d0483c4e0..9f8937350d6b 100644
--- a/drivers/crypto/intel/qat/qat_common/adf_transport.c
+++ b/drivers/crypto/intel/qat/qat_common/adf_transport.c
@@ -357,7 +357,10 @@ static inline int adf_get_cfg_int(struct adf_accel_dev *accel_dev,
 	char key_buf[ADF_CFG_MAX_KEY_LEN_IN_BYTES];
 	char val_buf[ADF_CFG_MAX_VAL_LEN_IN_BYTES];
 
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	snprintf(key_buf, ADF_CFG_MAX_KEY_LEN_IN_BYTES, format, key);
+#pragma GCC diagnostic pop
 
 	if (adf_cfg_get_param_value(accel_dev, section, key_buf, val_buf))
 		return -EFAULT;
diff --git a/drivers/gpio/gpiolib-sysfs.c b/drivers/gpio/gpiolib-sysfs.c
index 530dfd19d7b5..f02af7d864df 100644
--- a/drivers/gpio/gpiolib-sysfs.c
+++ b/drivers/gpio/gpiolib-sysfs.c
@@ -616,10 +616,13 @@ int gpiod_export(struct gpio_desc *desc, bool direction_may_change)
 	if (chip->names && chip->names[offset])
 		ioname = chip->names[offset];
 
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	dev = device_create_with_groups(&gpio_class, &gdev->dev,
 					MKDEV(0, 0), data, gpio_groups,
 					ioname ? ioname : "gpio%u",
 					desc_to_gpio(desc));
+#pragma GCC diagnostic pop
 	if (IS_ERR(dev)) {
 		status = PTR_ERR(dev);
 		goto err_free_data;
diff --git a/drivers/gpu/drm/amd/amdkfd/kfd_chardev.c b/drivers/gpu/drm/amd/amdkfd/kfd_chardev.c
index 1b54a9aaae70..6f73667b80e7 100644
--- a/drivers/gpu/drm/amd/amdkfd/kfd_chardev.c
+++ b/drivers/gpu/drm/amd/amdkfd/kfd_chardev.c
@@ -98,9 +98,12 @@ int kfd_chardev_init(void)
 	if (IS_ERR(kfd_class))
 		goto err_class_create;
 
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	kfd_device = device_create(kfd_class, NULL,
 					MKDEV(kfd_char_dev_major, 0),
 					NULL, kfd_dev_name);
+#pragma GCC diagnostic pop
 	err = PTR_ERR(kfd_device);
 	if (IS_ERR(kfd_device))
 		goto err_device_create;
diff --git a/drivers/gpu/drm/drm_sysfs.c b/drivers/gpu/drm/drm_sysfs.c
index 3c22a803201d..297ea414428e 100644
--- a/drivers/gpu/drm/drm_sysfs.c
+++ b/drivers/gpu/drm/drm_sysfs.c
@@ -228,7 +228,10 @@ static ssize_t enabled_show(struct device *device,
 
 	enabled = READ_ONCE(connector->encoder);
 
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	return sysfs_emit(buf, enabled ? "enabled\n" : "disabled\n");
+#pragma GCC diagnostic pop
 }
 
 static ssize_t edid_show(struct file *filp, struct kobject *kobj,
@@ -496,7 +499,11 @@ struct device *drm_sysfs_minor_alloc(struct drm_minor *minor)
 	kdev->release = drm_sysfs_release;
 	dev_set_drvdata(kdev, minor);
 
+/* minor_str is a constant string defined above */
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	r = dev_set_name(kdev, minor_str, minor->index);
+#pragma GCC diagnostic pop
 	if (r < 0)
 		goto err_free;
 
diff --git a/drivers/hid/hid-sony.c b/drivers/hid/hid-sony.c
index dd942061fd77..3fe9915013da 100644
--- a/drivers/hid/hid-sony.c
+++ b/drivers/hid/hid-sony.c
@@ -1434,11 +1434,14 @@ static int sony_leds_init(struct sony_sc *sc)
 		}
 
 		name = (void *)(&led[1]);
+		__diag_push()
+		__diag_ignore(GCC, 4, "-Wformat-security", "name_fmt is under control")
 		if (use_color_names)
 			snprintf(name, name_sz, name_fmt, dev_name(&hdev->dev),
 			color_name_str[n]);
 		else
 			snprintf(name, name_sz, name_fmt, dev_name(&hdev->dev), n + 1);
+		__diag_pop()
 		led->name = name;
 		led->brightness = sc->led_state[n];
 		led->max_brightness = max_brightness[n];
@@ -1674,8 +1677,11 @@ static int sony_battery_probe(struct sony_sc *sc, int append_dev_id)
 	sc->battery_desc.get_property = sony_battery_get_property;
 	sc->battery_desc.type = POWER_SUPPLY_TYPE_BATTERY;
 	sc->battery_desc.use_for_apm = 0;
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	sc->battery_desc.name = devm_kasprintf(&hdev->dev, GFP_KERNEL,
 					  battery_str_fmt, sc->mac_address, sc->device_id);
+#pragma GCC diagnostic pop
 	if (!sc->battery_desc.name)
 		return -ENOMEM;
 
diff --git a/drivers/hwmon/abituguru.c b/drivers/hwmon/abituguru.c
index a7cae6568155..6b280ca7f1a8 100644
--- a/drivers/hwmon/abituguru.c
+++ b/drivers/hwmon/abituguru.c
@@ -1338,10 +1338,13 @@ static int abituguru_probe(struct platform_device *pdev)
 
 		/* res 1 (temp) sensors have 7 sysfs entries, 0 (in) 9 */
 		for (j = 0; j < (res ? 7 : 9); j++) {
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 			used = snprintf(sysfs_filename, sysfs_names_free,
 				abituguru_sysfs_bank1_templ[res][j].dev_attr.
 				attr.name, data->bank1_sensors[res] + res)
 				+ 1;
+#pragma GCC diagnostic pop
 			data->sysfs_attr[sysfs_attr_i] =
 				abituguru_sysfs_bank1_templ[res][j];
 			data->sysfs_attr[sysfs_attr_i].dev_attr.attr.name =
@@ -1361,9 +1364,12 @@ static int abituguru_probe(struct platform_device *pdev)
 	abituguru_detect_no_bank2_sensors(data);
 	for (i = 0; i < data->bank2_sensors; i++) {
 		for (j = 0; j < ARRAY_SIZE(abituguru_sysfs_fan_templ); j++) {
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 			used = snprintf(sysfs_filename, sysfs_names_free,
 				abituguru_sysfs_fan_templ[j].dev_attr.attr.name,
 				i + 1) + 1;
+#pragma GCC diagnostic pop
 			data->sysfs_attr[sysfs_attr_i] =
 				abituguru_sysfs_fan_templ[j];
 			data->sysfs_attr[sysfs_attr_i].dev_attr.attr.name =
@@ -1378,9 +1384,12 @@ static int abituguru_probe(struct platform_device *pdev)
 	abituguru_detect_no_pwms(data);
 	for (i = 0; i < data->pwms; i++) {
 		for (j = 0; j < ARRAY_SIZE(abituguru_sysfs_pwm_templ); j++) {
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 			used = snprintf(sysfs_filename, sysfs_names_free,
 				abituguru_sysfs_pwm_templ[j].dev_attr.attr.name,
 				i + 1) + 1;
+#pragma GCC diagnostic pop
 			data->sysfs_attr[sysfs_attr_i] =
 				abituguru_sysfs_pwm_templ[j];
 			data->sysfs_attr[sysfs_attr_i].dev_attr.attr.name =
diff --git a/drivers/hwmon/abituguru3.c b/drivers/hwmon/abituguru3.c
index afb21f73032d..05c34e944d8d 100644
--- a/drivers/hwmon/abituguru3.c
+++ b/drivers/hwmon/abituguru3.c
@@ -1012,9 +1012,12 @@ static int abituguru3_probe(struct platform_device *pdev)
 		}
 		type = data->sensors[i].type;
 		for (j = 0; j < no_sysfs_attr[type]; j++) {
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 			used = snprintf(sysfs_filename, sysfs_names_free,
 				abituguru3_sysfs_templ[type][j].dev_attr.attr.
 				name, sensor_index[type]) + 1;
+#pragma GCC diagnostic pop
 			data->sysfs_attr[sysfs_attr_i] =
 				abituguru3_sysfs_templ[type][j];
 			data->sysfs_attr[sysfs_attr_i].dev_attr.attr.name =
diff --git a/drivers/hwmon/applesmc.c b/drivers/hwmon/applesmc.c
index fc6d6a9053ce..692033c28fee 100644
--- a/drivers/hwmon/applesmc.c
+++ b/drivers/hwmon/applesmc.c
@@ -843,8 +843,11 @@ static ssize_t applesmc_show_fan_speed(struct device *dev,
 	char newkey[5];
 	u8 buffer[2];
 
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	scnprintf(newkey, sizeof(newkey), fan_speed_fmt[to_option(attr)],
 		  to_index(attr));
+#pragma GCC diagnostic pop
 
 	ret = applesmc_read_key(newkey, buffer, 2);
 	if (ret)
@@ -866,8 +869,11 @@ static ssize_t applesmc_store_fan_speed(struct device *dev,
 	if (kstrtoul(sysfsbuf, 10, &speed) < 0 || speed >= 0x4000)
 		return -EINVAL;		/* Bigger than a 14-bit value */
 
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	scnprintf(newkey, sizeof(newkey), fan_speed_fmt[to_option(attr)],
 		  to_index(attr));
+#pragma GCC diagnostic pop
 
 	buffer[0] = (speed >> 6) & 0xff;
 	buffer[1] = (speed << 2) & 0xff;
@@ -1148,8 +1154,12 @@ static int applesmc_create_nodes(struct applesmc_node_group *groups, int num)
 		}
 		for (i = 0; i < num; i++) {
 			node = &grp->nodes[i];
+/* Possible values for format in struct applesmc_node_group are defined above */
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 			scnprintf(node->name, sizeof(node->name), grp->format,
 				  i + 1);
+#pragma GCC diagnostic pop
 			node->sda.index = (grp->option << 16) | (i & 0xffff);
 			node->sda.dev_attr.show = grp->show;
 			node->sda.dev_attr.store = grp->store;
diff --git a/drivers/hwmon/hwmon.c b/drivers/hwmon/hwmon.c
index 573b83b6c08c..05f4c84a3c39 100644
--- a/drivers/hwmon/hwmon.c
+++ b/drivers/hwmon/hwmon.c
@@ -418,8 +418,11 @@ static struct attribute *hwmon_genattr(const void *drvdata,
 	if (type == hwmon_chip) {
 		name = template;
 	} else {
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 		scnprintf(hattr->name, sizeof(hattr->name), template,
 			  index + hwmon_attr_base(type));
+#pragma GCC diagnostic pop
 		name = hattr->name;
 	}
 
@@ -658,7 +661,10 @@ int hwmon_notify_event(struct device *dev, enum hwmon_sensor_types type,
 
 	base = hwmon_attr_base(type);
 
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	scnprintf(sattr, MAX_SYSFS_ATTR_NAME_LENGTH, template, base + channel);
+#pragma GCC diagnostic pop
 	scnprintf(event, sizeof(event), "NAME=%s", sattr);
 	sysfs_notify(&dev->kobj, NULL, sattr);
 	kobject_uevent_env(&dev->kobj, KOBJ_CHANGE, envp);
diff --git a/drivers/hwmon/lm63.c b/drivers/hwmon/lm63.c
index 9ab2cab4c710..6b9a0909311f 100644
--- a/drivers/hwmon/lm63.c
+++ b/drivers/hwmon/lm63.c
@@ -690,7 +690,10 @@ static ssize_t temp2_type_show(struct device *dev,
 {
 	struct lm63_data *data = dev_get_drvdata(dev);
 
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	return sprintf(buf, data->trutherm ? "1\n" : "2\n");
+#pragma GCC diagnostic pop
 }
 
 static ssize_t temp2_type_store(struct device *dev,
diff --git a/drivers/hwmon/lm95234.c b/drivers/hwmon/lm95234.c
index b4a9d0c223c4..748429202ad5 100644
--- a/drivers/hwmon/lm95234.c
+++ b/drivers/hwmon/lm95234.c
@@ -239,7 +239,10 @@ static ssize_t type_show(struct device *dev, struct device_attribute *attr,
 	if (ret)
 		return ret;
 
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	return sprintf(buf, data->sensor_type & mask ? "1\n" : "2\n");
+#pragma GCC diagnostic pop
 }
 
 static ssize_t type_store(struct device *dev, struct device_attribute *attr,
diff --git a/drivers/hwmon/nct6683.c b/drivers/hwmon/nct6683.c
index a872f783e9cc..adbf5cc88f91 100644
--- a/drivers/hwmon/nct6683.c
+++ b/drivers/hwmon/nct6683.c
@@ -444,8 +444,11 @@ nct6683_create_attr_group(struct device *dev,
 	for (i = 0; i < repeat; i++) {
 		t = tg->templates;
 		while (*t) {
+			__diag_push()
+			__diag_ignore(GCC, 4, "-Wformat-security", "dev_attr.attr.name is controlled by the Kernel")
 			snprintf(su->name, sizeof(su->name),
 				 (*t)->dev_attr.attr.name, tg->base + i);
+			__diag_pop()
 			if ((*t)->s2) {
 				a2 = &su->u.a2;
 				sysfs_attr_init(&a2->dev_attr.attr);
diff --git a/drivers/hwmon/nct6775-core.c b/drivers/hwmon/nct6775-core.c
index c54233f0369b..a0f439c7fafd 100644
--- a/drivers/hwmon/nct6775-core.c
+++ b/drivers/hwmon/nct6775-core.c
@@ -1031,8 +1031,11 @@ static int nct6775_add_template_attr_group(struct device *dev, struct nct6775_da
 	for (i = 0; i < repeat; i++) {
 		t = tg->templates;
 		while (*t != NULL) {
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 			snprintf(su->name, sizeof(su->name),
 				 (*t)->dev_attr.attr.name, tg->base + i);
+#pragma GCC diagnostic pop
 			if ((*t)->s2) {
 				a2 = &su->u.a2;
 				sysfs_attr_init(&a2->dev_attr.attr);
diff --git a/drivers/iio/accel/bma180.c b/drivers/iio/accel/bma180.c
index eb697eeb4301..881b4f0cf9ad 100644
--- a/drivers/iio/accel/bma180.c
+++ b/drivers/iio/accel/bma180.c
@@ -488,8 +488,11 @@ static ssize_t bma180_show_avail(char *buf, const int *vals, unsigned int n,
 	for (i = 0; i < n; i++) {
 		if (!vals[i])
 			continue;
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 		len += scnprintf(buf + len, PAGE_SIZE - len,
 			micros ? "0.%06d " : "%d ", vals[i]);
+#pragma GCC diagnostic pop
 	}
 	buf[len - 1] = '\n';
 
diff --git a/drivers/iio/accel/bmc150-accel-core.c b/drivers/iio/accel/bmc150-accel-core.c
index 110591804b4c..a201dc4c0e0c 100644
--- a/drivers/iio/accel/bmc150-accel-core.c
+++ b/drivers/iio/accel/bmc150-accel-core.c
@@ -1460,10 +1460,14 @@ static int bmc150_accel_triggers_setup(struct iio_dev *indio_dev,
 	for (i = 0; i < BMC150_ACCEL_TRIGGERS; i++) {
 		struct bmc150_accel_trigger *t = &data->triggers[i];
 
+/* TODO verify the name is under kernel control */
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 		t->indio_trig = devm_iio_trigger_alloc(dev,
 						       bmc150_accel_triggers[i].name,
 						       indio_dev->name,
 						       iio_device_id(indio_dev));
+#pragma GCC diagnostic pop
 		if (!t->indio_trig) {
 			ret = -ENOMEM;
 			break;
diff --git a/drivers/infiniband/core/device.c b/drivers/infiniband/core/device.c
index a666847bd714..6ae9473cf35d 100644
--- a/drivers/infiniband/core/device.c
+++ b/drivers/infiniband/core/device.c
@@ -467,7 +467,11 @@ static int alloc_name(struct ib_device *ibdev, const char *name)
 			continue;
 		if (i < 0 || i >= INT_MAX)
 			continue;
+/* TODO check that name is under kernel control */
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 		snprintf(buf, sizeof buf, name, i);
+#pragma GCC diagnostic pop
 		if (strcmp(buf, dev_name(&device->dev)) != 0)
 			continue;
 
@@ -480,7 +484,10 @@ static int alloc_name(struct ib_device *ibdev, const char *name)
 	if (rc < 0)
 		goto out;
 
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	rc = dev_set_name(&ibdev->dev, name, rc);
+#pragma GCC diagnostic pop
 out:
 	ida_destroy(&inuse);
 	return rc;
diff --git a/drivers/infiniband/hw/hfi1/debugfs.c b/drivers/infiniband/hw/hfi1/debugfs.c
index 80ba1e53c068..fb2f6f42e8df 100644
--- a/drivers/infiniband/hw/hfi1/debugfs.c
+++ b/drivers/infiniband/hw/hfi1/debugfs.c
@@ -1217,10 +1217,14 @@ void hfi1_dbg_ibdev_init(struct hfi1_ibdev *ibd)
 	/* per port files */
 	for (ppd = dd->pport, j = 0; j < dd->num_pports; j++, ppd++)
 		for (i = 0; i < ARRAY_SIZE(port_cntr_ops); i++) {
+/* port_cntr_ops[i].name is defined by the kernel */
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 			snprintf(name,
 				 sizeof(name),
 				 port_cntr_ops[i].name,
 				 j + 1);
+#pragma GCC diagnostic pop
 			debugfs_create_file(name,
 					    !port_cntr_ops[i].ops.write ?
 						    S_IRUGO :
diff --git a/drivers/infiniband/hw/qib/qib_file_ops.c b/drivers/infiniband/hw/qib/qib_file_ops.c
index ef85bc8d9384..a9b86b5fb0d2 100644
--- a/drivers/infiniband/hw/qib/qib_file_ops.c
+++ b/drivers/infiniband/hw/qib/qib_file_ops.c
@@ -2272,7 +2272,11 @@ int qib_cdev_init(int minor, const char *name,
 
 	cdev->owner = THIS_MODULE;
 	cdev->ops = fops;
+/* All callers use semi-constants strings for name */
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	kobject_set_name(&cdev->kobj, name);
+#pragma GCC diagnostic pop
 
 	ret = cdev_add(cdev, dev, 1);
 	if (ret < 0) {
diff --git a/drivers/input/joystick/adi.c b/drivers/input/joystick/adi.c
index f1a720be458b..08fef6039589 100644
--- a/drivers/input/joystick/adi.c
+++ b/drivers/input/joystick/adi.c
@@ -391,7 +391,10 @@ static int adi_init_input(struct adi *adi, struct adi_port *port, int half)
 
 	t = adi->id < ADI_ID_MAX ? adi->id : ADI_ID_MAX;
 
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	snprintf(buf, ADI_MAX_PHYS_LENGTH, adi_names[t], adi->id);
+#pragma GCC diagnostic pop
 	snprintf(adi->name, ADI_MAX_NAME_LENGTH, "Logitech %s [%s]", buf, adi->cname);
 	snprintf(adi->phys, ADI_MAX_PHYS_LENGTH, "%s/input%d", port->gameport->phys, half);
 
diff --git a/drivers/input/joystick/tmdc.c b/drivers/input/joystick/tmdc.c
index 93562ecc0ca1..ea2881bd2339 100644
--- a/drivers/input/joystick/tmdc.c
+++ b/drivers/input/joystick/tmdc.c
@@ -292,8 +292,11 @@ static int tmdc_setup_port(struct tmdc *tmdc, int idx, unsigned char *data)
 	for (i = 0; i < 4; i++)
 		port->btno[i] = model->btno[i];
 
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	snprintf(port->name, sizeof(port->name), model->name,
 		 port->absc, (data[TMDC_BYTE_DEF] & 0xf) << 3, port->mode);
+#pragma GCC diagnostic pop
 	snprintf(port->phys, sizeof(port->phys), "%s/input%d", tmdc->gameport->phys, i);
 
 	port->dev = input_dev;
diff --git a/drivers/iommu/irq_remapping.c b/drivers/iommu/irq_remapping.c
index 83314b9d8f38..fdb9113885d5 100644
--- a/drivers/iommu/irq_remapping.c
+++ b/drivers/iommu/irq_remapping.c
@@ -156,5 +156,8 @@ int __init irq_remap_enable_fault_handling(void)
 void panic_if_irq_remap(const char *msg)
 {
 	if (irq_remapping_enabled)
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 		panic(msg);
+#pragma GCC diagnostic pop
 }
diff --git a/drivers/media/dvb-frontends/tda10021.c b/drivers/media/dvb-frontends/tda10021.c
index faa6e54b3372..16ab9d5b4259 100644
--- a/drivers/media/dvb-frontends/tda10021.c
+++ b/drivers/media/dvb-frontends/tda10021.c
@@ -395,10 +395,13 @@ static int tda10021_get_frontend(struct dvb_frontend *fe,
 	afc = tda10021_readreg(state, 0x19);
 	if (verbose) {
 		/* AFC only valid when carrier has been recovered */
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 		printk(sync & 2 ? "DVB: TDA10021(%d): AFC (%d) %dHz\n" :
 				  "DVB: TDA10021(%d): [AFC (%d) %dHz]\n",
 			state->frontend.dvb->num, afc,
 		       -((s32)p->symbol_rate * afc) >> 10);
+#pragma GCC diagnostic pop
 	}
 
 	p->inversion = ((state->reg0 & 0x20) == 0x20) ^ (state->config->invert != 0) ? INVERSION_ON : INVERSION_OFF;
diff --git a/drivers/media/dvb-frontends/tda10023.c b/drivers/media/dvb-frontends/tda10023.c
index 8f32edf6b700..0b60ade68502 100644
--- a/drivers/media/dvb-frontends/tda10023.c
+++ b/drivers/media/dvb-frontends/tda10023.c
@@ -456,10 +456,13 @@ static int tda10023_get_frontend(struct dvb_frontend *fe,
 
 	if (verbose) {
 		/* AFC only valid when carrier has been recovered */
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 		printk(sync & 2 ? "DVB: TDA10023(%d): AFC (%d) %dHz\n" :
 				  "DVB: TDA10023(%d): [AFC (%d) %dHz]\n",
 			state->frontend.dvb->num, afc,
 		       -((s32)p->symbol_rate * afc) >> 10);
+#pragma GCC diagnostic pop
 	}
 
 	p->inversion = (inv&0x20?0:1);
diff --git a/drivers/media/dvb-frontends/ves1820.c b/drivers/media/dvb-frontends/ves1820.c
index 9df14d0be1c1..07d122dee955 100644
--- a/drivers/media/dvb-frontends/ves1820.c
+++ b/drivers/media/dvb-frontends/ves1820.c
@@ -311,8 +311,11 @@ static int ves1820_get_frontend(struct dvb_frontend *fe,
 	afc = ves1820_readreg(state, 0x19);
 	if (verbose) {
 		/* AFC only valid when carrier has been recovered */
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 		printk(sync & 2 ? "ves1820: AFC (%d) %dHz\n" :
 			"ves1820: [AFC (%d) %dHz]\n", afc, -((s32) p->symbol_rate * afc) >> 10);
+#pragma GCC diagnostic pop
 	}
 
 	if (!state->config->invert) {
diff --git a/drivers/media/pci/cx23885/cx23885-dvb.c b/drivers/media/pci/cx23885/cx23885-dvb.c
index 8fd5b6ef2428..618344b627bb 100644
--- a/drivers/media/pci/cx23885/cx23885-dvb.c
+++ b/drivers/media/pci/cx23885/cx23885-dvb.c
@@ -1863,7 +1863,10 @@ static int dvb_register(struct cx23885_tsport *port)
 			strscpy(info.type, "si2165", I2C_NAME_SIZE);
 			info.addr = 0x64;
 			info.platform_data = &si2165_pdata;
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 			request_module(info.type);
+#pragma GCC diagnostic pop
 			client_demod = i2c_new_client_device(&i2c_bus->i2c_adap, &info);
 			if (!i2c_client_has_driver(client_demod))
 				goto frontend_detach;
diff --git a/drivers/media/radio/radio-shark.c b/drivers/media/radio/radio-shark.c
index 127a3be0e0f0..42e39ced4f18 100644
--- a/drivers/media/radio/radio-shark.c
+++ b/drivers/media/radio/radio-shark.c
@@ -243,8 +243,11 @@ static int shark_register_leds(struct shark_device *shark, struct device *dev)
 	INIT_WORK(&shark->led_work, shark_led_work);
 	for (i = 0; i < NO_LEDS; i++) {
 		shark->leds[i] = shark_led_templates[i];
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 		snprintf(shark->led_names[i], sizeof(shark->led_names[0]),
 			 shark->leds[i].name, shark->v4l2_dev.name);
+#pragma GCC diagnostic pop
 		shark->leds[i].name = shark->led_names[i];
 		retval = led_classdev_register(dev, &shark->leds[i]);
 		if (retval) {
diff --git a/drivers/media/radio/radio-shark2.c b/drivers/media/radio/radio-shark2.c
index f1c5c0a6a335..4adf9f32e409 100644
--- a/drivers/media/radio/radio-shark2.c
+++ b/drivers/media/radio/radio-shark2.c
@@ -209,8 +209,11 @@ static int shark_register_leds(struct shark_device *shark, struct device *dev)
 	INIT_WORK(&shark->led_work, shark_led_work);
 	for (i = 0; i < NO_LEDS; i++) {
 		shark->leds[i] = shark_led_templates[i];
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 		snprintf(shark->led_names[i], sizeof(shark->led_names[0]),
 			 shark->leds[i].name, shark->v4l2_dev.name);
+#pragma GCC diagnostic pop
 		shark->leds[i].name = shark->led_names[i];
 		retval = led_classdev_register(dev, &shark->leds[i]);
 		if (retval) {
diff --git a/drivers/media/usb/pvrusb2/pvrusb2-std.c b/drivers/media/usb/pvrusb2/pvrusb2-std.c
index e7ab41401577..0812504f4539 100644
--- a/drivers/media/usb/pvrusb2/pvrusb2-std.c
+++ b/drivers/media/usb/pvrusb2/pvrusb2-std.c
@@ -201,8 +201,12 @@ unsigned int pvr2_std_id_to_str(char *bufPtr, unsigned int bufSize,
 			c1 += c2;
 			bufSize -= c2;
 			bufPtr += c2;
+/* ip->name are constants strings from the top of this file */
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 			c2 = scnprintf(bufPtr,bufSize,
 				       ip->name);
+#pragma GCC diagnostic pop
 			c1 += c2;
 			bufSize -= c2;
 			bufPtr += c2;
diff --git a/drivers/memory/tegra/tegra20.c b/drivers/memory/tegra/tegra20.c
index fcd7738fcb53..05f45a2d2cbb 100644
--- a/drivers/memory/tegra/tegra20.c
+++ b/drivers/memory/tegra/tegra20.c
@@ -605,7 +605,11 @@ static void tegra20_mc_printf_percents(struct seq_file *s,
 	snprintf(percents_str, ARRAY_SIZE(percents_str), "%3u.%02u%%",
 		 percents_fx / MC_FX_FRAC_SCALE, percents_fx % MC_FX_FRAC_SCALE);
 
+	__diag_push()
+	__diag_ignore(GCC, 4, "-Wformat-security",
+	      "tegra20_mc_printf_percents is always called with %s");
 	seq_printf(s, fmt, percents_str);
+	__diag_pop()
 }
 
 static int tegra20_mc_stats_show(struct seq_file *s, void *unused)
diff --git a/drivers/mfd/mc13xxx-core.c b/drivers/mfd/mc13xxx-core.c
index 1000572761a8..406f0d71eefb 100644
--- a/drivers/mfd/mc13xxx-core.c
+++ b/drivers/mfd/mc13xxx-core.c
@@ -373,9 +373,12 @@ static int mc13xxx_add_subdevice_pdata(struct mc13xxx *mc13xxx,
 		.pdata_size = pdata_size,
 	};
 
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	/* there is no asnprintf in the kernel :-( */
 	if (snprintf(buf, sizeof(buf), format, name) > sizeof(buf))
 		return -E2BIG;
+#pragma GCC diagnostic pop
 
 	cell.name = kmemdup(buf, strlen(buf) + 1, GFP_KERNEL);
 	if (!cell.name)
diff --git a/drivers/misc/altera-stapl/altera.c b/drivers/misc/altera-stapl/altera.c
index a58b7cb81d98..750aefdf3605 100644
--- a/drivers/misc/altera-stapl/altera.c
+++ b/drivers/misc/altera-stapl/altera.c
@@ -699,8 +699,12 @@ static int altera_execute(struct altera_state *astate,
 			break;
 		case OP_PRNT:
 			/* PRINT finish */
+/* BUG? I did not understand this printk statement */
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 			if (debug)
 				printk(msg_buff, "\n");
+#pragma GCC diagnostic pop
 
 			msg_buff[0] = '\0';
 			break;
diff --git a/drivers/misc/cb710/debug.c b/drivers/misc/cb710/debug.c
index 20d672edf7cd..3f6a5fd6f2ab 100644
--- a/drivers/misc/cb710/debug.c
+++ b/drivers/misc/cb710/debug.c
@@ -93,9 +93,12 @@ static void cb710_read_and_dump_regs_##t(struct cb710_chip *chip,	\
   CB710_DUMP_REGS_TEMPLATE(t)			\
   CB710_READ_AND_DUMP_REGS_TEMPLATE(t)
 
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 CB710_REG_ACCESS_TEMPLATES(8)
 CB710_REG_ACCESS_TEMPLATES(16)
 CB710_REG_ACCESS_TEMPLATES(32)
+#pragma GCC diagnostic pop
 
 void cb710_dump_regs(struct cb710_chip *chip, unsigned select)
 {
diff --git a/drivers/mmc/core/mmc.c b/drivers/mmc/core/mmc.c
index 89cd48fcec79..a991fcc2a8bb 100644
--- a/drivers/mmc/core/mmc.c
+++ b/drivers/mmc/core/mmc.c
@@ -312,7 +312,11 @@ static void mmc_part_add(struct mmc_card *card, u64 size,
 {
 	card->part[card->nr_parts].size = size;
 	card->part[card->nr_parts].part_cfg = part_cfg;
+/* name is almost always "...%d" */
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	sprintf(card->part[card->nr_parts].name, name, idx);
+#pragma GCC diagnostic pop
 	card->part[card->nr_parts].force_ro = ro;
 	card->part[card->nr_parts].area_type = area_type;
 	card->nr_parts++;
diff --git a/drivers/net/ethernet/8390/smc-ultra.c b/drivers/net/ethernet/8390/smc-ultra.c
index 7465650c8078..641c113b4374 100644
--- a/drivers/net/ethernet/8390/smc-ultra.c
+++ b/drivers/net/ethernet/8390/smc-ultra.c
@@ -235,8 +235,11 @@ static int __init ultra_probe1(struct net_device *dev, int ioaddr)
 		goto out;
 	}
 
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	if ((ultra_msg_enable & NETIF_MSG_DRV) && (version_printed++ == 0))
 		netdev_info(dev, version);
+#pragma GCC diagnostic pop
 
 	model_name = (idreg & 0xF0) == 0x20 ? "SMC Ultra" : "SMC EtherEZ";
 
diff --git a/drivers/net/ethernet/8390/wd.c b/drivers/net/ethernet/8390/wd.c
index 119021d41451..c94fdb386333 100644
--- a/drivers/net/ethernet/8390/wd.c
+++ b/drivers/net/ethernet/8390/wd.c
@@ -189,8 +189,11 @@ static int __init wd_probe1(struct net_device *dev, int ioaddr)
 		dev->mem_end = 0;
 	}
 
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	if ((wd_msg_enable & NETIF_MSG_DRV) && (version_printed++ == 0))
 		netdev_info(dev, version);
+#pragma GCC diagnostic pop
 
 	for (i = 0; i < 6; i++)
 		addr[i] = inb(ioaddr + 8 + i);
diff --git a/drivers/net/ethernet/amd/lance.c b/drivers/net/ethernet/amd/lance.c
index 6cf38180cc01..b873aad58b19 100644
--- a/drivers/net/ethernet/amd/lance.c
+++ b/drivers/net/ethernet/amd/lance.c
@@ -726,8 +726,11 @@ static int __init lance_probe1(struct net_device *dev, int ioaddr, int irq, int
 		outw(inw(ioaddr+LANCE_BUS_IF) | 0x0002, ioaddr+LANCE_BUS_IF);
 	}
 
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	if (lance_debug > 0  &&  did_version++ == 0)
 		printk(version);
+#pragma GCC diagnostic pop
 
 	/* The LANCE-specific entries in the device structure. */
 	dev->netdev_ops = &lance_netdev_ops;
diff --git a/drivers/net/ethernet/aquantia/atlantic/aq_ethtool.c b/drivers/net/ethernet/aquantia/atlantic/aq_ethtool.c
index ac4ea93bd8dd..3cb2149fdb99 100644
--- a/drivers/net/ethernet/aquantia/atlantic/aq_ethtool.c
+++ b/drivers/net/ethernet/aquantia/atlantic/aq_ethtool.c
@@ -278,17 +278,23 @@ static void aq_ethtool_get_strings(struct net_device *ndev,
 
 			for (i = 0; i < cfg->vecs; i++) {
 				for (si = 0; si < rx_stat_cnt; si++) {
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 					snprintf(p, ETH_GSTRING_LEN,
 					     aq_ethtool_queue_rx_stat_names[si],
 					     tc_string,
 					     AQ_NIC_CFG_TCVEC2RING(cfg, tc, i));
+#pragma GCC diagnostic pop
 					p += ETH_GSTRING_LEN;
 				}
 				for (si = 0; si < tx_stat_cnt; si++) {
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 					snprintf(p, ETH_GSTRING_LEN,
 					     aq_ethtool_queue_tx_stat_names[si],
 					     tc_string,
 					     AQ_NIC_CFG_TCVEC2RING(cfg, tc, i));
+#pragma GCC diagnostic pop
 					p += ETH_GSTRING_LEN;
 				}
 			}
@@ -304,19 +310,25 @@ static void aq_ethtool_get_strings(struct net_device *ndev,
 
 			for (i = 0; i < max(rx_ring_cnt, tx_ring_cnt); i++) {
 				for (si = 0; si < rx_stat_cnt; si++) {
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 					snprintf(p, ETH_GSTRING_LEN,
 						 aq_ethtool_queue_rx_stat_names[si],
 						 tc_string,
 						 i ? PTP_HWST_RING_IDX : ptp_ring_idx);
+#pragma GCC diagnostic pop
 					p += ETH_GSTRING_LEN;
 				}
 				if (i >= tx_ring_cnt)
 					continue;
 				for (si = 0; si < tx_stat_cnt; si++) {
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 					snprintf(p, ETH_GSTRING_LEN,
 						 aq_ethtool_queue_tx_stat_names[si],
 						 tc_string,
 						 i ? PTP_HWST_RING_IDX : ptp_ring_idx);
+#pragma GCC diagnostic pop
 					p += ETH_GSTRING_LEN;
 				}
 			}
@@ -337,8 +349,11 @@ static void aq_ethtool_get_strings(struct net_device *ndev,
 			for (si = 0;
 				si < ARRAY_SIZE(aq_macsec_txsc_stat_names);
 				si++) {
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 				snprintf(p, ETH_GSTRING_LEN,
 					 aq_macsec_txsc_stat_names[si], i);
+#pragma GCC diagnostic pop
 				p += ETH_GSTRING_LEN;
 			}
 			aq_txsc = &nic->macsec_cfg->aq_txsc[i];
@@ -348,9 +363,12 @@ static void aq_ethtool_get_strings(struct net_device *ndev,
 				for (si = 0;
 				     si < ARRAY_SIZE(aq_macsec_txsa_stat_names);
 				     si++) {
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 					snprintf(p, ETH_GSTRING_LEN,
 						 aq_macsec_txsa_stat_names[si],
 						 i, sa);
+#pragma GCC diagnostic pop
 					p += ETH_GSTRING_LEN;
 				}
 			}
@@ -368,9 +386,12 @@ static void aq_ethtool_get_strings(struct net_device *ndev,
 				for (si = 0;
 				     si < ARRAY_SIZE(aq_macsec_rxsa_stat_names);
 				     si++) {
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 					snprintf(p, ETH_GSTRING_LEN,
 						 aq_macsec_rxsa_stat_names[si],
 						 i, sa);
+#pragma GCC diagnostic pop
 					p += ETH_GSTRING_LEN;
 				}
 			}
diff --git a/drivers/net/ethernet/broadcom/bnx2x/bnx2x_ethtool.c b/drivers/net/ethernet/broadcom/bnx2x/bnx2x_ethtool.c
index bda3ccc28eca..5814c36c5373 100644
--- a/drivers/net/ethernet/broadcom/bnx2x/bnx2x_ethtool.c
+++ b/drivers/net/ethernet/broadcom/bnx2x/bnx2x_ethtool.c
@@ -3197,11 +3197,14 @@ static void bnx2x_get_strings(struct net_device *dev, u32 stringset, u8 *buf)
 				memset(queue_name, 0, sizeof(queue_name));
 				snprintf(queue_name, sizeof(queue_name),
 					 "%d", i);
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 				for (j = 0; j < BNX2X_NUM_Q_STATS; j++)
 					snprintf(buf + (k + j)*ETH_GSTRING_LEN,
 						ETH_GSTRING_LEN,
 						bnx2x_q_stats_arr[j].string,
 						queue_name);
+#pragma GCC diagnostic pop
 				k += BNX2X_NUM_Q_STATS;
 			}
 		}
diff --git a/drivers/net/ethernet/chelsio/cxgb4/cxgb4_debugfs.c b/drivers/net/ethernet/chelsio/cxgb4/cxgb4_debugfs.c
index 14e0d989c3ba..57e225a96671 100644
--- a/drivers/net/ethernet/chelsio/cxgb4/cxgb4_debugfs.c
+++ b/drivers/net/ethernet/chelsio/cxgb4/cxgb4_debugfs.c
@@ -1024,6 +1024,8 @@ static int devlog_show(struct seq_file *seq, void *v)
 			   (e->facility < ARRAY_SIZE(devlog_facility_strings)
 			    ? devlog_facility_strings[e->facility]
 			    : "UNKNOWN"));
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 		seq_printf(seq, e->fmt,
 			   be32_to_cpu(e->params[0]),
 			   be32_to_cpu(e->params[1]),
@@ -1033,6 +1035,7 @@ static int devlog_show(struct seq_file *seq, void *v)
 			   be32_to_cpu(e->params[5]),
 			   be32_to_cpu(e->params[6]),
 			   be32_to_cpu(e->params[7]));
+#pragma GCC diagnostic pop
 	}
 	return 0;
 }
diff --git a/drivers/net/ethernet/chelsio/cxgb4/l2t.c b/drivers/net/ethernet/chelsio/cxgb4/l2t.c
index a10a6862a9a4..e87ee1cf5cce 100644
--- a/drivers/net/ethernet/chelsio/cxgb4/l2t.c
+++ b/drivers/net/ethernet/chelsio/cxgb4/l2t.c
@@ -721,8 +721,12 @@ static int l2t_seq_show(struct seq_file *seq, void *v)
 		spin_lock_bh(&e->lock);
 		if (e->state == L2T_STATE_SWITCHING)
 			ip[0] = '\0';
-		else
+		else {
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 			sprintf(ip, e->v6 ? "%pI6c" : "%pI4", e->addr);
+#pragma GCC diagnostic pop
+		}
 		seq_printf(seq, "%4u %-25s %17pM %4d %u %2u   %c   %5u %s\n",
 			   e->idx + d->l2t_start, ip, e->dmac,
 			   e->vlan & VLAN_VID_MASK, vlan_prio(e), e->lport,
diff --git a/drivers/net/ethernet/engleder/tsnep_ethtool.c b/drivers/net/ethernet/engleder/tsnep_ethtool.c
index 716815dad7d2..becc089e33ec 100644
--- a/drivers/net/ethernet/engleder/tsnep_ethtool.c
+++ b/drivers/net/ethernet/engleder/tsnep_ethtool.c
@@ -141,6 +141,8 @@ static void tsnep_ethtool_get_strings(struct net_device *netdev, u32 stringset,
 		memcpy(data, tsnep_stats_strings, sizeof(tsnep_stats_strings));
 		data += sizeof(tsnep_stats_strings);
 
+		__diag_push()
+		__diag_ignore(GCC, 4, "-Wformat-security", "formats use %d")
 		for (i = 0; i < rx_count; i++) {
 			for (j = 0; j < TSNEP_RX_QUEUE_STATS_COUNT; j++) {
 				snprintf(data, ETH_GSTRING_LEN,
@@ -156,6 +158,7 @@ static void tsnep_ethtool_get_strings(struct net_device *netdev, u32 stringset,
 				data += ETH_GSTRING_LEN;
 			}
 		}
+		__diag_pop()
 		break;
 	case ETH_SS_TEST:
 		tsnep_ethtool_get_test_strings(data);
diff --git a/drivers/net/ethernet/freescale/enetc/enetc_ethtool.c b/drivers/net/ethernet/freescale/enetc/enetc_ethtool.c
index e993ed04ab57..b1f8ce74ebe5 100644
--- a/drivers/net/ethernet/freescale/enetc/enetc_ethtool.c
+++ b/drivers/net/ethernet/freescale/enetc/enetc_ethtool.c
@@ -258,15 +258,21 @@ static void enetc_get_strings(struct net_device *ndev, u32 stringset, u8 *data)
 		}
 		for (i = 0; i < priv->num_tx_rings; i++) {
 			for (j = 0; j < ARRAY_SIZE(tx_ring_stats); j++) {
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 				snprintf(p, ETH_GSTRING_LEN, tx_ring_stats[j],
 					 i);
+#pragma GCC diagnostic pop
 				p += ETH_GSTRING_LEN;
 			}
 		}
 		for (i = 0; i < priv->num_rx_rings; i++) {
 			for (j = 0; j < ARRAY_SIZE(rx_ring_stats); j++) {
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 				snprintf(p, ETH_GSTRING_LEN, rx_ring_stats[j],
 					 i);
+#pragma GCC diagnostic pop
 				p += ETH_GSTRING_LEN;
 			}
 		}
diff --git a/drivers/net/ethernet/google/gve/gve_ethtool.c b/drivers/net/ethernet/google/gve/gve_ethtool.c
index cfd4b8d284d1..bb3561435e23 100644
--- a/drivers/net/ethernet/google/gve/gve_ethtool.c
+++ b/drivers/net/ethernet/google/gve/gve_ethtool.c
@@ -102,16 +102,22 @@ static void gve_get_strings(struct net_device *netdev, u32 stringset, u8 *data)
 
 		for (i = 0; i < priv->rx_cfg.num_queues; i++) {
 			for (j = 0; j < NUM_GVE_RX_CNTS; j++) {
+__diag_push()
+__diag(ignored "-Wformat-security")
 				snprintf(s, ETH_GSTRING_LEN,
 					 gve_gstrings_rx_stats[j], i);
+__diag_pop()
 				s += ETH_GSTRING_LEN;
 			}
 		}
 
 		for (i = 0; i < num_tx_queues; i++) {
 			for (j = 0; j < NUM_GVE_TX_CNTS; j++) {
+__diag_push()
+__diag(ignored "-Wformat-security")
 				snprintf(s, ETH_GSTRING_LEN,
 					 gve_gstrings_tx_stats[j], i);
+__diag_pop()
 				s += ETH_GSTRING_LEN;
 			}
 		}
diff --git a/drivers/net/ethernet/hisilicon/hns/hns_dsaf_xgmac.c b/drivers/net/ethernet/hisilicon/hns/hns_dsaf_xgmac.c
index fc26ffaae620..831a0fbdc805 100644
--- a/drivers/net/ethernet/hisilicon/hns/hns_dsaf_xgmac.c
+++ b/drivers/net/ethernet/hisilicon/hns/hns_dsaf_xgmac.c
@@ -751,8 +751,14 @@ static void hns_xgmac_get_strings(u32 stringset, u8 *data)
 	if (stringset != ETH_SS_STATS)
 		return;
 
-	for (i = 0; i < ARRAY_SIZE(g_xgmac_stats_string); i++)
+	for (i = 0; i < ARRAY_SIZE(g_xgmac_stats_string); i++) {
+/* g_xgmac_stats_string is a constant array */
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 		ethtool_sprintf(&buff, g_xgmac_stats_string[i].desc);
+#pragma GCC diagnostic pop
+		buff = buff + ETH_GSTRING_LEN;
+	}
 }
 
 /**
diff --git a/drivers/net/ethernet/huawei/hinic/hinic_ethtool.c b/drivers/net/ethernet/huawei/hinic/hinic_ethtool.c
index f4b680286911..1e1e1c36dfcb 100644
--- a/drivers/net/ethernet/huawei/hinic/hinic_ethtool.c
+++ b/drivers/net/ethernet/huawei/hinic/hinic_ethtool.c
@@ -1489,6 +1489,8 @@ static void hinic_get_strings(struct net_device *netdev,
 			p += ETH_GSTRING_LEN;
 		}
 
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 		for (i = 0; i < nic_dev->num_qps; i++) {
 			for (j = 0; j < ARRAY_SIZE(hinic_tx_queue_stats); j++) {
 				sprintf(p, hinic_tx_queue_stats[j].name, i);
@@ -1502,6 +1504,7 @@ static void hinic_get_strings(struct net_device *netdev,
 				p += ETH_GSTRING_LEN;
 			}
 		}
+#pragma GCC diagnostic pop
 
 		return;
 	default:
diff --git a/drivers/net/ethernet/intel/fm10k/fm10k_debugfs.c b/drivers/net/ethernet/intel/fm10k/fm10k_debugfs.c
index 5c77054d67c6..f3b68338e622 100644
--- a/drivers/net/ethernet/intel/fm10k/fm10k_debugfs.c
+++ b/drivers/net/ethernet/intel/fm10k/fm10k_debugfs.c
@@ -49,7 +49,10 @@ static int fm10k_dbg_tx_desc_seq_show(struct seq_file *s, void *v)
 
 	/* Generate header */
 	if (!i) {
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 		seq_printf(s, tx_desc_hdr);
+#pragma GCC diagnostic pop
 		fm10k_dbg_desc_break(s, sizeof(tx_desc_hdr) - 1);
 	}
 
@@ -76,7 +79,10 @@ static int fm10k_dbg_rx_desc_seq_show(struct seq_file *s, void *v)
 
 	/* Generate header */
 	if (!i) {
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 		seq_printf(s, rx_desc_hdr);
+#pragma GCC diagnostic pop
 		fm10k_dbg_desc_break(s, sizeof(rx_desc_hdr) - 1);
 	}
 
diff --git a/drivers/net/ethernet/marvell/mvpp2/mvpp2_main.c b/drivers/net/ethernet/marvell/mvpp2/mvpp2_main.c
index adc953611913..ce6153983b34 100644
--- a/drivers/net/ethernet/marvell/mvpp2/mvpp2_main.c
+++ b/drivers/net/ethernet/marvell/mvpp2/mvpp2_main.c
@@ -1965,6 +1965,8 @@ static void mvpp2_ethtool_get_strings(struct net_device *netdev, u32 sset,
 		data += ETH_GSTRING_LEN;
 	}
 
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	for (q = 0; q < port->ntxqs; q++) {
 		for (i = 0; i < ARRAY_SIZE(mvpp2_ethtool_txq_regs); i++) {
 			snprintf(data, ETH_GSTRING_LEN,
@@ -1981,6 +1983,7 @@ static void mvpp2_ethtool_get_strings(struct net_device *netdev, u32 sset,
 			data += ETH_GSTRING_LEN;
 		}
 	}
+#pragma GCC diagnostic pop
 
 	for (i = 0; i < ARRAY_SIZE(mvpp2_ethtool_xdp); i++) {
 		strscpy(data, mvpp2_ethtool_xdp[i].string,
diff --git a/drivers/net/ethernet/marvell/octeon_ep/octep_ethtool.c b/drivers/net/ethernet/marvell/octeon_ep/octep_ethtool.c
index 7d0124b283da..039e7d5e35f5 100644
--- a/drivers/net/ethernet/marvell/octeon_ep/octep_ethtool.c
+++ b/drivers/net/ethernet/marvell/octeon_ep/octep_ethtool.c
@@ -93,16 +93,22 @@ static void octep_get_strings(struct net_device *netdev,
 
 		for (i = 0; i < num_queues; i++) {
 			for (j = 0; j < OCTEP_TX_Q_STATS_CNT; j++) {
+				__diag_push()
+				__diag_ignore(GCC, 4, "-Wformat-security", "octep_gstrings_tx_q_stats contains a format")
 				snprintf(strings, ETH_GSTRING_LEN,
 					 octep_gstrings_tx_q_stats[j], i);
+				__diag_pop()
 				strings += ETH_GSTRING_LEN;
 			}
 		}
 
 		for (i = 0; i < num_queues; i++) {
 			for (j = 0; j < OCTEP_RX_Q_STATS_CNT; j++) {
+				__diag_push()
+				__diag_ignore(GCC, 4, "-Wformat-security", "octep_gstrings_rx_q_stats contains a format")
 				snprintf(strings, ETH_GSTRING_LEN,
 					 octep_gstrings_rx_q_stats[j], i);
+				__diag_pop()
 				strings += ETH_GSTRING_LEN;
 			}
 		}
diff --git a/drivers/net/ethernet/marvell/prestera/prestera_pci.c b/drivers/net/ethernet/marvell/prestera/prestera_pci.c
index f328d957b2db..c3b1fa1eee73 100644
--- a/drivers/net/ethernet/marvell/prestera/prestera_pci.c
+++ b/drivers/net/ethernet/marvell/prestera/prestera_pci.c
@@ -722,8 +722,11 @@ static int prestera_fw_get(struct prestera_fw *fw)
 	int err;
 
 pick_fw_ver:
+	__diag_push()
+	__diag_ignore(GCC, 4, "-Wformat-security", "prestera_fw_path_fmt_get returns a constant string")
 	snprintf(fw_path, sizeof(fw_path), prestera_fw_path_fmt_get(fw),
 		 ver_maj, ver_min);
+	__diag_pop()
 
 	err = request_firmware_direct(&fw->bin, fw_path, fw->dev.dev);
 	if (err) {
diff --git a/drivers/net/ethernet/mellanox/mlx5/core/diag/fw_tracer.c b/drivers/net/ethernet/mellanox/mlx5/core/diag/fw_tracer.c
index 7c0f2adbea00..0b43d0041119 100644
--- a/drivers/net/ethernet/mellanox/mlx5/core/diag/fw_tracer.c
+++ b/drivers/net/ethernet/mellanox/mlx5/core/diag/fw_tracer.c
@@ -570,6 +570,8 @@ void mlx5_tracer_print_trace(struct tracer_string_format *str_frmt,
 {
 	char	tmp[512];
 
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	snprintf(tmp, sizeof(tmp), str_frmt->string,
 		 str_frmt->params[0],
 		 str_frmt->params[1],
@@ -578,6 +580,7 @@ void mlx5_tracer_print_trace(struct tracer_string_format *str_frmt,
 		 str_frmt->params[4],
 		 str_frmt->params[5],
 		 str_frmt->params[6]);
+#pragma GCC diagnostic pop
 
 	trace_mlx5_fw(dev->tracer, trace_timestamp, str_frmt->lost,
 		      str_frmt->event_id, tmp);
diff --git a/drivers/net/ethernet/mellanox/mlx5/core/en_stats.c b/drivers/net/ethernet/mellanox/mlx5/core/en_stats.c
index f1d9596905c6..99a449c2e927 100644
--- a/drivers/net/ethernet/mellanox/mlx5/core/en_stats.c
+++ b/drivers/net/ethernet/mellanox/mlx5/core/en_stats.c
@@ -1564,12 +1564,15 @@ static MLX5E_DECLARE_STATS_GRP_OP_FILL_STRS(per_port_buff_congest)
 		return idx;
 
 	for (prio = 0; prio < NUM_PPORT_PRIO; prio++) {
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 		for (i = 0; i < NUM_PPORT_PER_TC_PRIO_COUNTERS; i++)
 			sprintf(data + (idx++) * ETH_GSTRING_LEN,
 				pport_per_tc_prio_stats_desc[i].format, prio);
 		for (i = 0; i < NUM_PPORT_PER_TC_CONGEST_PRIO_COUNTERS; i++)
 			sprintf(data + (idx++) * ETH_GSTRING_LEN,
 				pport_per_tc_congest_prio_stats_desc[i].format, prio);
+#pragma GCC diagnostic pop
 	}
 
 	return idx;
@@ -1687,9 +1690,13 @@ static int mlx5e_grp_per_prio_traffic_fill_strings(struct mlx5e_priv *priv,
 	int i, prio;
 
 	for (prio = 0; prio < NUM_PPORT_PRIO; prio++) {
-		for (i = 0; i < NUM_PPORT_PER_PRIO_TRAFFIC_COUNTERS; i++)
+		for (i = 0; i < NUM_PPORT_PER_PRIO_TRAFFIC_COUNTERS; i++) {
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 			sprintf(data + (idx++) * ETH_GSTRING_LEN,
 				pport_per_prio_traffic_stats_desc[i].format, prio);
+#pragma GCC diagnostic pop
+		}
 	}
 
 	return idx;
@@ -1781,15 +1788,21 @@ static int mlx5e_grp_per_prio_pfc_fill_strings(struct mlx5e_priv *priv,
 			char pfc_string[ETH_GSTRING_LEN];
 
 			snprintf(pfc_string, sizeof(pfc_string), "prio%d", prio);
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 			sprintf(data + (idx++) * ETH_GSTRING_LEN,
 				pport_per_prio_pfc_stats_desc[i].format, pfc_string);
+#pragma GCC diagnostic pop
 		}
 	}
 
 	if (mlx5e_query_global_pause_combined(priv)) {
 		for (i = 0; i < NUM_PPORT_PER_PRIO_PFC_COUNTERS; i++) {
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 			sprintf(data + (idx++) * ETH_GSTRING_LEN,
 				pport_per_prio_pfc_stats_desc[i].format, "global");
+#pragma GCC diagnostic pop
 		}
 	}
 
@@ -2212,10 +2225,15 @@ static MLX5E_DECLARE_STATS_GRP_OP_FILL_STRS(qos)
 	u16 max_qos_sqs = smp_load_acquire(&priv->htb_max_qos_sqs);
 	int i, qid;
 
-	for (qid = 0; qid < max_qos_sqs; qid++)
-		for (i = 0; i < NUM_QOS_SQ_STATS; i++)
+	for (qid = 0; qid < max_qos_sqs; qid++) {
+		for (i = 0; i < NUM_QOS_SQ_STATS; i++) {
+__diag_push()
+__diag(ignored "-Wformat-security")
 			sprintf(data + (idx++) * ETH_GSTRING_LEN,
 				qos_sq_stats_desc[i].format, qid);
+__diag_pop()
+		}
+	}
 
 	return idx;
 }
@@ -2264,6 +2282,8 @@ static MLX5E_DECLARE_STATS_GRP_OP_FILL_STRS(ptp)
 	if (!priv->tx_ptp_opened && !priv->rx_ptp_opened)
 		return idx;
 
+__diag_push()
+__diag(ignored "-Wformat-security")
 	for (i = 0; i < NUM_PTP_CH_STATS; i++)
 		sprintf(data + (idx++) * ETH_GSTRING_LEN,
 			"%s", ptp_ch_stats_desc[i].format);
@@ -2284,6 +2304,7 @@ static MLX5E_DECLARE_STATS_GRP_OP_FILL_STRS(ptp)
 			sprintf(data + (idx++) * ETH_GSTRING_LEN,
 				ptp_rq_stats_desc[i].format, MLX5E_PTP_CHANNEL_IX);
 	}
+__diag_pop()
 	return idx;
 }
 
@@ -2343,11 +2364,17 @@ static MLX5E_DECLARE_STATS_GRP_OP_FILL_STRS(channels)
 	int i, j, tc;
 
 	for (i = 0; i < max_nch; i++)
-		for (j = 0; j < NUM_CH_STATS; j++)
+		for (j = 0; j < NUM_CH_STATS; j++) {
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 			sprintf(data + (idx++) * ETH_GSTRING_LEN,
 				ch_stats_desc[j].format, i);
+#pragma GCC diagnostic pop
+		}
 
 	for (i = 0; i < max_nch; i++) {
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 		for (j = 0; j < NUM_RQ_STATS; j++)
 			sprintf(data + (idx++) * ETH_GSTRING_LEN,
 				rq_stats_desc[j].format, i);
@@ -2357,22 +2384,35 @@ static MLX5E_DECLARE_STATS_GRP_OP_FILL_STRS(channels)
 		for (j = 0; j < NUM_RQ_XDPSQ_STATS; j++)
 			sprintf(data + (idx++) * ETH_GSTRING_LEN,
 				rq_xdpsq_stats_desc[j].format, i);
+#pragma GCC diagnostic pop
 	}
 
 	for (tc = 0; tc < priv->max_opened_tc; tc++)
 		for (i = 0; i < max_nch; i++)
-			for (j = 0; j < NUM_SQ_STATS; j++)
+			for (j = 0; j < NUM_SQ_STATS; j++) {
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 				sprintf(data + (idx++) * ETH_GSTRING_LEN,
 					sq_stats_desc[j].format,
 					i + tc * max_nch);
+#pragma GCC diagnostic pop
+			}
 
 	for (i = 0; i < max_nch; i++) {
-		for (j = 0; j < NUM_XSKSQ_STATS * is_xsk; j++)
+		for (j = 0; j < NUM_XSKSQ_STATS * is_xsk; j++) {
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 			sprintf(data + (idx++) * ETH_GSTRING_LEN,
 				xsksq_stats_desc[j].format, i);
-		for (j = 0; j < NUM_XDPSQ_STATS; j++)
+#pragma GCC diagnostic pop
+		}
+		for (j = 0; j < NUM_XDPSQ_STATS; j++) {
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 			sprintf(data + (idx++) * ETH_GSTRING_LEN,
 				xdpsq_stats_desc[j].format, i);
+#pragma GCC diagnostic pop
+		}
 	}
 
 	return idx;
diff --git a/drivers/net/ethernet/natsemi/natsemi.c b/drivers/net/ethernet/natsemi/natsemi.c
index 650a5a166070..dd441bd84124 100644
--- a/drivers/net/ethernet/natsemi/natsemi.c
+++ b/drivers/net/ethernet/natsemi/natsemi.c
@@ -3367,7 +3367,10 @@ static int __init natsemi_init_mod (void)
 {
 /* when a module, this is printed whether or not devices are found in probe */
 #ifdef MODULE
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	printk(version);
+#pragma GCC diagnostic pop
 #endif
 
 	return pci_register_driver(&natsemi_driver);
diff --git a/drivers/net/ethernet/netronome/nfp/abm/ctrl.c b/drivers/net/ethernet/netronome/nfp/abm/ctrl.c
index 69e84ff7f2e5..3869489cb032 100644
--- a/drivers/net/ethernet/netronome/nfp/abm/ctrl.c
+++ b/drivers/net/ethernet/netronome/nfp/abm/ctrl.c
@@ -350,8 +350,11 @@ nfp_abm_ctrl_find_q_rtsym(struct nfp_abm *abm, const char *name_fmt,
 	char pf_symbol[64];
 
 	size = array3_size(size, abm->num_bands, NFP_NET_MAX_RX_RINGS);
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	snprintf(pf_symbol, sizeof(pf_symbol), name_fmt,
 		 abm->pf_id, nfp_abm_has_prio(abm) ? "_per_band" : "");
+#pragma GCC diagnostic pop
 
 	return nfp_abm_ctrl_find_rtsym(abm->app->pf, pf_symbol, size);
 }
diff --git a/drivers/net/ethernet/netronome/nfp/nfp_main.c b/drivers/net/ethernet/netronome/nfp/nfp_main.c
index 71301dbd8fb5..b388f818e1f8 100644
--- a/drivers/net/ethernet/netronome/nfp/nfp_main.c
+++ b/drivers/net/ethernet/netronome/nfp/nfp_main.c
@@ -76,7 +76,10 @@ int nfp_pf_rtsym_read_optional(struct nfp_pf *pf, const char *format,
 	int err = 0;
 	u64 val;
 
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	snprintf(name, sizeof(name), format, nfp_cppcore_pcie_unit(pf->cpp));
+#pragma GCC diagnostic pop
 
 	val = nfp_rtsym_read_le(pf->rtbl, name, &err);
 	if (err) {
@@ -95,8 +98,11 @@ nfp_pf_map_rtsym(struct nfp_pf *pf, const char *name, const char *sym_fmt,
 {
 	char pf_symbol[256];
 
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	snprintf(pf_symbol, sizeof(pf_symbol), sym_fmt,
 		 nfp_cppcore_pcie_unit(pf->cpp));
+#pragma GCC diagnostic pop
 
 	return nfp_rtsym_map(pf->rtbl, pf_symbol, name, min_size, area);
 }
diff --git a/drivers/net/ethernet/netronome/nfp/nfp_net_common.c b/drivers/net/ethernet/netronome/nfp/nfp_net_common.c
index 62f0bf91d1e1..d0cb44d21c22 100644
--- a/drivers/net/ethernet/netronome/nfp/nfp_net_common.c
+++ b/drivers/net/ethernet/netronome/nfp/nfp_net_common.c
@@ -559,7 +559,10 @@ nfp_net_aux_irq_request(struct nfp_net *nn, u32 ctrl_offset,
 
 	entry = &nn->irq_entries[vector_idx];
 
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	snprintf(name, name_sz, format, nfp_net_name(nn));
+#pragma GCC diagnostic pop
 	err = request_irq(entry->vector, handler, 0, name, nn);
 	if (err) {
 		nn_err(nn, "Failed to request IRQ %d (err=%d).\n",
diff --git a/drivers/net/ethernet/packetengines/hamachi.c b/drivers/net/ethernet/packetengines/hamachi.c
index 1cc001087193..3a182069e1b6 100644
--- a/drivers/net/ethernet/packetengines/hamachi.c
+++ b/drivers/net/ethernet/packetengines/hamachi.c
@@ -1952,7 +1952,10 @@ static int __init hamachi_init (void)
 {
 /* when a module, this is printed whether or not devices are found in probe */
 #ifdef MODULE
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	printk(version);
+#pragma GCC diagnostic pop
 #endif
 	return pci_register_driver(&hamachi_driver);
 }
diff --git a/drivers/net/ethernet/packetengines/yellowfin.c b/drivers/net/ethernet/packetengines/yellowfin.c
index 640ac01689fb..b265597e5660 100644
--- a/drivers/net/ethernet/packetengines/yellowfin.c
+++ b/drivers/net/ethernet/packetengines/yellowfin.c
@@ -389,8 +389,11 @@ static int yellowfin_init_one(struct pci_dev *pdev,
 /* when built into the kernel, we only print version if device is found */
 #ifndef MODULE
 	static int printed_version;
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	if (!printed_version++)
 		printk(version);
+#pragma GCC diagnostic pop
 #endif
 
 	i = pci_enable_device(pdev);
@@ -1422,7 +1425,10 @@ static int __init yellowfin_init (void)
 {
 /* when a module, this is printed whether or not devices are found in probe */
 #ifdef MODULE
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	printk(version);
+#pragma GCC diagnostic pop
 #endif
 	return pci_register_driver(&yellowfin_driver);
 }
diff --git a/drivers/net/ethernet/qlogic/qed/qed_debug.c b/drivers/net/ethernet/qlogic/qed/qed_debug.c
index cdcead614e9f..3f0d96234136 100644
--- a/drivers/net/ethernet/qlogic/qed/qed_debug.c
+++ b/drivers/net/ethernet/qlogic/qed/qed_debug.c
@@ -6963,10 +6963,17 @@ static enum dbg_status qed_parse_mcp_trace_buf(struct qed_hwfn *p_hwfn,
 				"%s %-8s: ",
 				s_mcp_trace_level_str[format_level],
 				meta->modules[format_module]);
+/* It may NOT be safe, as format_ptr->format_str comes from an external source
+ * and qed_get_buf_ptr() might return a buffer not large enough for the format,
+ * but assume the driver author knows what is going on...
+ */
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 		*parsed_results_bytes +=
 		    sprintf(qed_get_buf_ptr(parsed_buf, *parsed_results_bytes),
 			    format_ptr->format_str,
 			    params[0], params[1], params[2]);
+#pragma GCC diagnostic pop
 	}
 
 	/* Add string NULL terminator */
diff --git a/drivers/net/ethernet/qlogic/qed/qed_int.c b/drivers/net/ethernet/qlogic/qed/qed_int.c
index 2661c483c67e..dbe5cfefa28c 100644
--- a/drivers/net/ethernet/qlogic/qed/qed_int.c
+++ b/drivers/net/ethernet/qlogic/qed/qed_int.c
@@ -1115,10 +1115,13 @@ static int qed_int_deassertion(struct qed_hwfn  *p_hwfn,
 					 */
 					if (ATTENTION_LENGTH(flags) > 2 ||
 					    ((flags & ATTENTION_PAR_INT) &&
-					     ATTENTION_LENGTH(flags) > 1))
+					     ATTENTION_LENGTH(flags) > 1)) {
+						__diag_push()
+						__diag_ignore(GCC, 4, "-Wformat-security", "p_aeu->bit_name is defined by the Kernel")
 						snprintf(bit_name, 30,
 							 p_aeu->bit_name, num);
-					else
+						__diag_pop()
+					} else
 						strscpy(bit_name,
 							p_aeu->bit_name, 30);
 
diff --git a/drivers/net/ethernet/qlogic/qlcnic/qlcnic_ctx.c b/drivers/net/ethernet/qlogic/qlcnic/qlcnic_ctx.c
index eb827b86ecae..6ff14dd3d56d 100644
--- a/drivers/net/ethernet/qlogic/qlcnic/qlcnic_ctx.c
+++ b/drivers/net/ethernet/qlogic/qlcnic/qlcnic_ctx.c
@@ -158,7 +158,10 @@ int qlcnic_82xx_issue_cmd(struct qlcnic_adapter *adapter,
 			fmt = "CDRP command failed: [%d]\n";
 			break;
 		}
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 		dev_err(&pdev->dev, fmt, cmd->rsp.arg[0]);
+#pragma GCC diagnostic pop
 		qlcnic_dump_mbx(adapter, cmd);
 	} else if (rsp == QLCNIC_CDRP_RSP_OK)
 		cmd->rsp.arg[0] = QLCNIC_RCODE_SUCCESS;
diff --git a/drivers/net/ethernet/qualcomm/emac/emac-mac.c b/drivers/net/ethernet/qualcomm/emac/emac-mac.c
index 0d80447d4d3b..9baec78bdcf7 100644
--- a/drivers/net/ethernet/qualcomm/emac/emac-mac.c
+++ b/drivers/net/ethernet/qualcomm/emac/emac-mac.c
@@ -945,7 +945,10 @@ int emac_mac_up(struct emac_adapter *adpt)
 		return ret;
 	}
 
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	phy_attached_print(adpt->phydev, NULL);
+#pragma GCC diagnostic pop
 
 	/* enable mac irq */
 	writel((u32)~DIS_INT, adpt->base + EMAC_INT_STATUS);
diff --git a/drivers/net/ethernet/sfc/ethtool_common.c b/drivers/net/ethernet/sfc/ethtool_common.c
index a8cbceeb301b..05c29c00349b 100644
--- a/drivers/net/ethernet/sfc/ethtool_common.c
+++ b/drivers/net/ethernet/sfc/ethtool_common.c
@@ -267,12 +267,18 @@ static void efx_fill_test(unsigned int test_index, u8 *strings, u64 *data,
 
 	/* Fill string, if applicable */
 	if (strings) {
-		if (strchr(unit_format, '%'))
+		if (strchr(unit_format, '%')) {
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 			snprintf(unit_str, sizeof(unit_str),
 				 unit_format, unit_id);
-		else
+#pragma GCC diagnostic pop
+		} else
 			strcpy(unit_str, unit_format);
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 		snprintf(test_str, sizeof(test_str), test_format, test_id);
+#pragma GCC diagnostic pop
 		snprintf(strings + test_index * ETH_GSTRING_LEN,
 			 ETH_GSTRING_LEN,
 			 "%-6s %-24s", unit_str, test_str);
diff --git a/drivers/net/ethernet/sfc/falcon/ethtool.c b/drivers/net/ethernet/sfc/falcon/ethtool.c
index 3976a333f7e3..e9b46f965850 100644
--- a/drivers/net/ethernet/sfc/falcon/ethtool.c
+++ b/drivers/net/ethernet/sfc/falcon/ethtool.c
@@ -218,12 +218,15 @@ static void ef4_fill_test(unsigned int test_index, u8 *strings, u64 *data,
 
 	/* Fill string, if applicable */
 	if (strings) {
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 		if (strchr(unit_format, '%'))
 			snprintf(unit_str, sizeof(unit_str),
 				 unit_format, unit_id);
 		else
 			strcpy(unit_str, unit_format);
 		snprintf(test_str, sizeof(test_str), test_format, test_id);
+#pragma GCC diagnostic pop
 		snprintf(strings + test_index * ETH_GSTRING_LEN,
 			 ETH_GSTRING_LEN,
 			 "%-6s %-24s", unit_str, test_str);
diff --git a/drivers/net/ethernet/sfc/siena/ethtool_common.c b/drivers/net/ethernet/sfc/siena/ethtool_common.c
index f590e87e5a23..85c7d74c2226 100644
--- a/drivers/net/ethernet/sfc/siena/ethtool_common.c
+++ b/drivers/net/ethernet/sfc/siena/ethtool_common.c
@@ -218,12 +218,18 @@ static void efx_fill_test(unsigned int test_index, u8 *strings, u64 *data,
 
 	/* Fill string, if applicable */
 	if (strings) {
-		if (strchr(unit_format, '%'))
+		if (strchr(unit_format, '%')) {
+			__diag_push()
+			__diag_ignore(GCC, 4, "-Wformat-security", "unit_format contains a format")
 			snprintf(unit_str, sizeof(unit_str),
 				 unit_format, unit_id);
-		else
+			__diag_pop()
+		} else
 			strcpy(unit_str, unit_format);
+		__diag_push()
+		__diag_ignore(GCC, 4, "-Wformat-security", "test_format contains a format")
 		snprintf(test_str, sizeof(test_str), test_format, test_id);
+		__diag_pop()
 		snprintf(strings + test_index * ETH_GSTRING_LEN,
 			 ETH_GSTRING_LEN,
 			 "%-6s %-24s", unit_str, test_str);
diff --git a/drivers/net/ethernet/sis/sis900.c b/drivers/net/ethernet/sis/sis900.c
index cb7fec226cab..4b8ee16aecd4 100644
--- a/drivers/net/ethernet/sis/sis900.c
+++ b/drivers/net/ethernet/sis/sis900.c
@@ -2570,7 +2570,10 @@ static int __init sis900_init_module(void)
 {
 /* when a module, this is printed whether or not devices are found in probe */
 #ifdef MODULE
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	printk(version);
+#pragma GCC diagnostic pop
 #endif
 
 	return pci_register_driver(&sis900_pci_driver);
diff --git a/drivers/net/ethernet/sun/niu.c b/drivers/net/ethernet/sun/niu.c
index 7a2e76776297..f99e53c217d5 100644
--- a/drivers/net/ethernet/sun/niu.c
+++ b/drivers/net/ethernet/sun/niu.c
@@ -9376,9 +9376,12 @@ static ssize_t show_port_phy(struct device *dev,
 			type_str = "10G";
 		else
 			type_str = "1G";
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 		buf += sprintf(buf,
 			       (i == 0) ? "%s" : " %s",
 			       type_str);
+#pragma GCC diagnostic pop
 	}
 	buf += sprintf(buf, "\n");
 	return buf - orig_buf;
@@ -9425,9 +9428,12 @@ static ssize_t __show_chan_per_port(struct device *dev,
 	arr = (rx ? p->rxchan_per_port : p->txchan_per_port);
 
 	for (i = 0; i < p->num_ports; i++) {
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 		buf += sprintf(buf,
 			       (i == 0) ? "%d" : " %d",
 			       arr[i]);
+#pragma GCC diagnostic pop
 	}
 	buf += sprintf(buf, "\n");
 
diff --git a/drivers/net/fddi/defxx.c b/drivers/net/fddi/defxx.c
index 1fef8a9b1a0f..2b87940df008 100644
--- a/drivers/net/fddi/defxx.c
+++ b/drivers/net/fddi/defxx.c
@@ -543,7 +543,10 @@ static int dfx_register(struct device *bdev)
 
 	if (!version_disp) {	/* display version info if adapter is found */
 		version_disp = 1;	/* set display flag to TRUE so that */
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 		printk(version);	/* we only display this string ONCE */
+#pragma GCC diagnostic pop
 	}
 
 	dev = alloc_fddidev(sizeof(*bp));
diff --git a/drivers/net/hamradio/baycom_epp.c b/drivers/net/hamradio/baycom_epp.c
index 83ff882f5d97..494f524b9a0e 100644
--- a/drivers/net/hamradio/baycom_epp.c
+++ b/drivers/net/hamradio/baycom_epp.c
@@ -1218,7 +1218,10 @@ static int __init init_baycomepp(void)
 	int i, found = 0, ret;
 	char set_hw = 1;
 
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	printk(bc_drvinfo);
+#pragma GCC diagnostic pop
 
 	ret = parport_register_driver(&baycom_epp_par_driver);
 	if (ret)
diff --git a/drivers/net/hamradio/baycom_par.c b/drivers/net/hamradio/baycom_par.c
index fd7da5bb1fa5..a9a9dde3c954 100644
--- a/drivers/net/hamradio/baycom_par.c
+++ b/drivers/net/hamradio/baycom_par.c
@@ -511,7 +511,10 @@ static int __init init_baycompar(void)
 	int i, found = 0, ret;
 	char set_hw = 1;
 
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	printk(bc_drvinfo);
+#pragma GCC diagnostic pop
 
 	ret = parport_register_driver(&baycom_par_driver);
 	if (ret)
diff --git a/drivers/net/hamradio/baycom_ser_fdx.c b/drivers/net/hamradio/baycom_ser_fdx.c
index 646f605e358f..a43ee196a5b5 100644
--- a/drivers/net/hamradio/baycom_ser_fdx.c
+++ b/drivers/net/hamradio/baycom_ser_fdx.c
@@ -591,7 +591,10 @@ static int __init init_baycomserfdx(void)
 	int i, found = 0;
 	char set_hw = 1;
 
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	printk(bc_drvinfo);
+#pragma GCC diagnostic pop
 	/*
 	 * register net devices
 	 */
diff --git a/drivers/net/hamradio/baycom_ser_hdx.c b/drivers/net/hamradio/baycom_ser_hdx.c
index 5d1ab4840753..c7ce95713b3f 100644
--- a/drivers/net/hamradio/baycom_ser_hdx.c
+++ b/drivers/net/hamradio/baycom_ser_hdx.c
@@ -642,7 +642,10 @@ static int __init init_baycomserhdx(void)
 	int i, found = 0;
 	char set_hw = 1;
 
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	printk(bc_drvinfo);
+#pragma GCC diagnostic pop
 	/*
 	 * register net devices
 	 */
diff --git a/drivers/net/hamradio/bpqether.c b/drivers/net/hamradio/bpqether.c
index 83a16d10eedb..1a7276dad8cd 100644
--- a/drivers/net/hamradio/bpqether.c
+++ b/drivers/net/hamradio/bpqether.c
@@ -579,7 +579,10 @@ static int __init bpq_init_driver(void)
 
 	register_netdevice_notifier(&bpq_dev_notifier);
 
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	printk(banner);
+#pragma GCC diagnostic pop
 
 	return 0;
 }
diff --git a/drivers/net/hamradio/scc.c b/drivers/net/hamradio/scc.c
index a9184a78650b..5f593f339dc0 100644
--- a/drivers/net/hamradio/scc.c
+++ b/drivers/net/hamradio/scc.c
@@ -2098,7 +2098,10 @@ static int __init scc_init_driver (void)
 {
 	char devname[IFNAMSIZ];
 	
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	printk(banner);
+#pragma GCC diagnostic pop
 	
 	sprintf(devname,"%s0", SCC_DriverName);
 	
diff --git a/drivers/net/hamradio/yam.c b/drivers/net/hamradio/yam.c
index 2ed2f836f09a..d9503cfa62df 100644
--- a/drivers/net/hamradio/yam.c
+++ b/drivers/net/hamradio/yam.c
@@ -1114,7 +1114,10 @@ static int __init yam_init_driver(void)
 	int i, err;
 	char name[IFNAMSIZ];
 
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	printk(yam_drvinfo);
+#pragma GCC diagnostic pop
 
 	for (i = 0; i < NR_PORTS; i++) {
 		sprintf(name, "yam%d", i);
diff --git a/drivers/net/hippi/rrunner.c b/drivers/net/hippi/rrunner.c
index aa8f828a0ae7..f28de71e828f 100644
--- a/drivers/net/hippi/rrunner.c
+++ b/drivers/net/hippi/rrunner.c
@@ -124,7 +124,10 @@ static int rr_init_one(struct pci_dev *pdev, const struct pci_device_id *ent)
 		/* set display flag to TRUE so that */
 		/* we only display this string ONCE */
 		version_disp = 1;
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 		printk(version);
+#pragma GCC diagnostic pop
 	}
 
 	pci_read_config_byte(pdev, PCI_LATENCY_TIMER, &pci_latency);
diff --git a/drivers/net/hyperv/netvsc_drv.c b/drivers/net/hyperv/netvsc_drv.c
index 0103ff914024..4629139a099d 100644
--- a/drivers/net/hyperv/netvsc_drv.c
+++ b/drivers/net/hyperv/netvsc_drv.c
@@ -1599,8 +1599,12 @@ static void netvsc_get_strings(struct net_device *dev, u32 stringset, u8 *data)
 		}
 
 		for_each_present_cpu(cpu) {
-			for (i = 0; i < ARRAY_SIZE(pcpu_stats); i++)
+			for (i = 0; i < ARRAY_SIZE(pcpu_stats); i++) {
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 				ethtool_sprintf(&p, pcpu_stats[i].name, cpu);
+#pragma GCC diagnostic pop
+			}
 		}
 
 		break;
diff --git a/drivers/net/phy/phy_device.c b/drivers/net/phy/phy_device.c
index 17d0d0555a79..95ff4ff41a3a 100644
--- a/drivers/net/phy/phy_device.c
+++ b/drivers/net/phy/phy_device.c
@@ -1265,7 +1265,10 @@ EXPORT_SYMBOL(phy_init_hw);
 
 void phy_attached_info(struct phy_device *phydev)
 {
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	phy_attached_print(phydev, NULL);
+#pragma GCC diagnostic pop
 }
 EXPORT_SYMBOL(phy_attached_info);
 
diff --git a/drivers/net/wan/lapbether.c b/drivers/net/wan/lapbether.c
index d62a904d2e42..637a24a928c6 100644
--- a/drivers/net/wan/lapbether.c
+++ b/drivers/net/wan/lapbether.c
@@ -493,7 +493,10 @@ static int __init lapbeth_init_driver(void)
 
 	register_netdevice_notifier(&lapbeth_dev_notifier);
 
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	printk(banner);
+#pragma GCC diagnostic pop
 
 	return 0;
 }
diff --git a/drivers/net/wireless/broadcom/b43/main.c b/drivers/net/wireless/broadcom/b43/main.c
index 92ca0b2ca286..1bbce821762e 100644
--- a/drivers/net/wireless/broadcom/b43/main.c
+++ b/drivers/net/wireless/broadcom/b43/main.c
@@ -2170,10 +2170,13 @@ static void b43_print_fw_helptext(struct b43_wl *wl, bool error)
 		"and download the correct firmware for this driver version. " \
 		"Please carefully read all instructions on this website.\n";
 
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	if (error)
 		b43err(wl, text);
 	else
 		b43warn(wl, text);
+#pragma GCC diagnostic pop
 }
 
 static void b43_fw_cb(const struct firmware *firmware, void *context)
@@ -5606,8 +5609,11 @@ static struct b43_wl *b43_wireless_init(struct b43_bus_dev *dev)
 		wl->tx_queue_stopped[queue_num] = false;
 	}
 
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	snprintf(chip_name, ARRAY_SIZE(chip_name),
 		 (dev->chip_id > 0x9999) ? "%d" : "%04X", dev->chip_id);
+#pragma GCC diagnostic pop
 	b43info(wl, "Broadcom %s WLAN found (core revision %u)\n", chip_name,
 		dev->core_rev);
 	return wl;
diff --git a/drivers/net/wireless/broadcom/brcm80211/brcmfmac/chip.c b/drivers/net/wireless/broadcom/brcm80211/brcmfmac/chip.c
index 9f9bf08a70bb..0b3f275bd5bc 100644
--- a/drivers/net/wireless/broadcom/brcm80211/brcmfmac/chip.c
+++ b/drivers/net/wireless/broadcom/brcm80211/brcmfmac/chip.c
@@ -497,7 +497,10 @@ char *brcmf_chip_name(u32 id, u32 rev, char *buf, uint len)
 	const char *fmt;
 
 	fmt = ((id > 0xa000) || (id < 0x4000)) ? "BCM%d/%u" : "BCM%x/%u";
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	snprintf(buf, len, fmt, id, rev);
+#pragma GCC diagnostic pop
 	return buf;
 }
 
diff --git a/drivers/net/wireless/intel/iwlegacy/4965-debug.c b/drivers/net/wireless/intel/iwlegacy/4965-debug.c
index c1f8c6bf8d6e..5e518d3f8d16 100644
--- a/drivers/net/wireless/intel/iwlegacy/4965-debug.c
+++ b/drivers/net/wireless/intel/iwlegacy/4965-debug.c
@@ -87,6 +87,8 @@ il4965_ucode_rx_stats_read(struct file *file, char __user *user_buf,
 	max_ht = &il->_4965.max_delta.rx.ofdm_ht;
 
 	pos += il4965_stats_flag(il, buf, bufsz);
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	pos +=
 	    scnprintf(buf + pos, bufsz - pos, fmt_header,
 		      "Statistics_Rx - OFDM:");
@@ -443,6 +445,7 @@ il4965_ucode_rx_stats_read(struct file *file, char __user *user_buf,
 	    scnprintf(buf + pos, bufsz - pos, fmt_table, "unsupport_mcs:",
 		      le32_to_cpu(ht->unsupport_mcs), accum_ht->unsupport_mcs,
 		      delta_ht->unsupport_mcs, max_ht->unsupport_mcs);
+#pragma GCC diagnostic pop
 
 	ret = simple_read_from_buffer(user_buf, count, ppos, buf, pos);
 	kfree(buf);
@@ -479,6 +482,8 @@ il4965_ucode_tx_stats_read(struct file *file, char __user *user_buf,
 	max_tx = &il->_4965.max_delta.tx;
 
 	pos += il4965_stats_flag(il, buf, bufsz);
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	pos += scnprintf(buf + pos, bufsz - pos, fmt_header, "Statistics_Tx:");
 	pos +=
 	    scnprintf(buf + pos, bufsz - pos, fmt_table, "preamble:",
@@ -609,6 +614,7 @@ il4965_ucode_tx_stats_read(struct file *file, char __user *user_buf,
 		      le32_to_cpu(tx->agg.rx_ba_rsp_cnt),
 		      accum_tx->agg.rx_ba_rsp_cnt, delta_tx->agg.rx_ba_rsp_cnt,
 		      max_tx->agg.rx_ba_rsp_cnt);
+#pragma GCC diagnostic pop
 
 	ret = simple_read_from_buffer(user_buf, count, ppos, buf, pos);
 	kfree(buf);
@@ -656,6 +662,8 @@ il4965_ucode_general_stats_read(struct file *file, char __user *user_buf,
 	max_div = &il->_4965.max_delta.general.common.div;
 
 	pos += il4965_stats_flag(il, buf, bufsz);
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	pos +=
 	    scnprintf(buf + pos, bufsz - pos, fmt_header,
 		      "Statistics_General:");
@@ -722,6 +730,7 @@ il4965_ucode_general_stats_read(struct file *file, char __user *user_buf,
 		      accum_general->num_of_sos_states,
 		      delta_general->num_of_sos_states,
 		      max_general->num_of_sos_states);
+#pragma GCC diagnostic pop
 	ret = simple_read_from_buffer(user_buf, count, ppos, buf, pos);
 	kfree(buf);
 	return ret;
diff --git a/drivers/net/wireless/intel/iwlwifi/dvm/debugfs.c b/drivers/net/wireless/intel/iwlwifi/dvm/debugfs.c
index b246dbd371b3..2edfa5fe274f 100644
--- a/drivers/net/wireless/intel/iwlwifi/dvm/debugfs.c
+++ b/drivers/net/wireless/intel/iwlwifi/dvm/debugfs.c
@@ -711,6 +711,8 @@ static ssize_t iwl_dbgfs_ucode_rx_stats_read(struct file *file,
 	max_ht = &priv->max_delta_stats.rx_ofdm_ht;
 
 	pos += iwl_statistics_flag(priv, buf, bufsz);
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	pos += scnprintf(buf + pos, bufsz - pos,
 			 fmt_header, "Statistics_Rx - OFDM:");
 	pos += scnprintf(buf + pos, bufsz - pos,
@@ -1088,6 +1090,7 @@ static ssize_t iwl_dbgfs_ucode_rx_stats_read(struct file *file,
 			 le32_to_cpu(ht->unsupport_mcs),
 			 accum_ht->unsupport_mcs,
 			 delta_ht->unsupport_mcs, max_ht->unsupport_mcs);
+#pragma GCC diagnostic pop
 
 	spin_unlock_bh(&priv->statistics.lock);
 
@@ -1126,6 +1129,8 @@ static ssize_t iwl_dbgfs_ucode_tx_stats_read(struct file *file,
 	max_tx = &priv->max_delta_stats.tx;
 
 	pos += iwl_statistics_flag(priv, buf, bufsz);
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	pos += scnprintf(buf + pos, bufsz - pos,
 			 fmt_header, "Statistics_Tx:");
 	pos += scnprintf(buf + pos, bufsz - pos,
@@ -1285,6 +1290,7 @@ static ssize_t iwl_dbgfs_ucode_tx_stats_read(struct file *file,
 					fmt_hex, "antenna C:",
 					tx->tx_power.ant_c);
 	}
+#pragma GCC diagnostic pop
 
 	spin_unlock_bh(&priv->statistics.lock);
 
@@ -1335,6 +1341,8 @@ static ssize_t iwl_dbgfs_ucode_general_stats_read(struct file *file,
 	max_div = &priv->max_delta_stats.common.div;
 
 	pos += iwl_statistics_flag(priv, buf, bufsz);
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	pos += scnprintf(buf + pos, bufsz - pos,
 			 fmt_header, "Statistics_General:");
 	pos += scnprintf(buf + pos, bufsz - pos,
@@ -1405,6 +1413,7 @@ static ssize_t iwl_dbgfs_ucode_general_stats_read(struct file *file,
 			 accum_general->num_of_sos_states,
 			 delta_general->num_of_sos_states,
 			 max_general->num_of_sos_states);
+#pragma GCC diagnostic pop
 
 	spin_unlock_bh(&priv->statistics.lock);
 
diff --git a/drivers/net/wireless/intel/iwlwifi/fw/dbg.h b/drivers/net/wireless/intel/iwlwifi/fw/dbg.h
index be7806407de8..c55e6fa8e777 100644
--- a/drivers/net/wireless/intel/iwlwifi/fw/dbg.h
+++ b/drivers/net/wireless/intel/iwlwifi/fw/dbg.h
@@ -164,7 +164,10 @@ _iwl_fw_dbg_trigger_simple_stop(struct iwl_fw_runtime *fwrt,
 	if (!iwl_fw_dbg_trigger_check_stop(fwrt, wdev, trigger))
 		return;
 
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	iwl_fw_dbg_collect_trig(fwrt, trigger, NULL);
+#pragma GCC diagnostic pop
 }
 
 #define iwl_fw_dbg_trigger_simple_stop(fwrt, wdev, trig)	\
diff --git a/drivers/net/wireless/intel/iwlwifi/mvm/debugfs.c b/drivers/net/wireless/intel/iwlwifi/mvm/debugfs.c
index 84a488538427..4b4f9082312a 100644
--- a/drivers/net/wireless/intel/iwlwifi/mvm/debugfs.c
+++ b/drivers/net/wireless/intel/iwlwifi/mvm/debugfs.c
@@ -978,6 +978,8 @@ static ssize_t iwl_dbgfs_fw_rx_stats_read(struct file *file,
 	if (iwl_mvm_firmware_running(mvm))
 		iwl_mvm_request_statistics(mvm, false);
 
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	pos += scnprintf(buf + pos, bufsz - pos, fmt_header,
 			 "Statistics_Rx - OFDM");
 	if (!iwl_mvm_has_new_rx_stats_api(mvm)) {
@@ -1129,6 +1131,7 @@ static ssize_t iwl_dbgfs_fw_rx_stats_read(struct file *file,
 		PRINT_STATS_LE32(ht, agg_cnt);
 		PRINT_STATS_LE32(ht, unsupport_mcs);
 	}
+#pragma GCC diagnostic pop
 
 	mutex_unlock(&mvm->mutex);
 
diff --git a/drivers/net/wireless/intel/iwlwifi/mvm/mac-ctxt.c b/drivers/net/wireless/intel/iwlwifi/mvm/mac-ctxt.c
index cc90f2884cff..0c0ff8c0af9a 100644
--- a/drivers/net/wireless/intel/iwlwifi/mvm/mac-ctxt.c
+++ b/drivers/net/wireless/intel/iwlwifi/mvm/mac-ctxt.c
@@ -1608,9 +1608,12 @@ void iwl_mvm_rx_missed_beacons_notif(struct iwl_mvm *mvm,
 
 	/* TODO: implement start trigger */
 
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	if (rx_missed_bcon_since_rx >= stop_trig_missed_bcon_since_rx ||
 	    rx_missed_bcon >= stop_trig_missed_bcon)
 		iwl_fw_dbg_collect_trig(&mvm->fwrt, trigger, NULL);
+#pragma GCC diagnostic pop
 
 out:
 	rcu_read_unlock();
diff --git a/drivers/net/wireless/intel/iwlwifi/mvm/rx.c b/drivers/net/wireless/intel/iwlwifi/mvm/rx.c
index b38b24246675..286f22cb1b3e 100644
--- a/drivers/net/wireless/intel/iwlwifi/mvm/rx.c
+++ b/drivers/net/wireless/intel/iwlwifi/mvm/rx.c
@@ -439,9 +439,12 @@ void iwl_mvm_rx_rx_mpdu(struct iwl_mvm *mvm, struct napi_struct *napi,
 			rssi_trig = (void *)trig->data;
 			rssi = le32_to_cpu(rssi_trig->rssi);
 
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 			if (rx_status->signal < rssi)
 				iwl_fw_dbg_collect_trig(&mvm->fwrt, trig,
 							NULL);
+#pragma GCC diagnostic pop
 		}
 
 		if (!mvm->tcm.paused && len >= sizeof(*hdr) &&
diff --git a/drivers/net/wireless/marvell/mwifiex/sta_ioctl.c b/drivers/net/wireless/marvell/mwifiex/sta_ioctl.c
index a2ad2b53f016..fb4e25c5437a 100644
--- a/drivers/net/wireless/marvell/mwifiex/sta_ioctl.c
+++ b/drivers/net/wireless/marvell/mwifiex/sta_ioctl.c
@@ -1080,7 +1080,10 @@ mwifiex_drv_get_driver_version(struct mwifiex_adapter *adapter, char *version,
 	ver.l = cpu_to_le32(adapter->fw_release_number);
 	sprintf(fw_ver, "%u.%u.%u.p%u", ver.c[2], ver.c[1], ver.c[0], ver.c[3]);
 
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	snprintf(version, max_len, driver_version, fw_ver);
+#pragma GCC diagnostic pop
 
 	mwifiex_dbg(adapter, MSG, "info: MWIFIEX VERSION: %s\n", version);
 
diff --git a/drivers/net/wwan/wwan_core.c b/drivers/net/wwan/wwan_core.c
index 284ab1f56391..74106086b82a 100644
--- a/drivers/net/wwan/wwan_core.c
+++ b/drivers/net/wwan/wwan_core.c
@@ -416,7 +416,11 @@ static int __wwan_port_dev_assign_name(struct wwan_port *port, const char *fmt)
 	id = find_first_zero_bit(idmap, max_ports);
 	free_page((unsigned long)idmap);
 
+	__diag_push()
+	__diag_ignore(GCC, 4, "-Wformat-security",
+	      "fmt is known at compile time to contain a %d");
 	snprintf(buf, sizeof(buf), fmt, id);	/* Name generation */
+	__diag_pop()
 
 	dev = device_find_child_by_name(&wwandev->dev, buf);
 	if (dev) {
diff --git a/drivers/parport/share.c b/drivers/parport/share.c
index 62f8407923d4..4ec72fd8b406 100644
--- a/drivers/parport/share.c
+++ b/drivers/parport/share.c
@@ -491,7 +491,10 @@ struct parport *parport_register_port(unsigned long base, int irq, int dma,
 	tmp->name = name;
 	tmp->bus_dev.bus = &parport_bus_type;
 	tmp->bus_dev.release = free_port;
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	dev_set_name(&tmp->bus_dev, name);
+#pragma GCC diagnostic pop
 	tmp->bus_dev.type = &parport_device_type;
 
 	for (device = 0; device < 5; device++)
diff --git a/drivers/pci/probe.c b/drivers/pci/probe.c
index 0b2826c4a832..2fe168bd5a7b 100644
--- a/drivers/pci/probe.c
+++ b/drivers/pci/probe.c
@@ -1013,9 +1013,12 @@ static int pci_register_host_bridge(struct pci_host_bridge *bridge)
 			else
 				fmt = " (bus address [%#010llx-%#010llx])";
 
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 			snprintf(addr, sizeof(addr), fmt,
 				 (unsigned long long)(res->start - offset),
 				 (unsigned long long)(res->end - offset));
+#pragma GCC diagnostic pop
 		} else
 			addr[0] = '\0';
 
@@ -1451,9 +1454,12 @@ static int pci_scan_bridge_extend(struct pci_bus *bus, struct pci_dev *dev,
 		pci_write_config_byte(dev, PCI_SUBORDINATE_BUS, max);
 	}
 
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	sprintf(child->name,
 		(is_cardbus ? "PCI CardBus %04x:%02x" : "PCI Bus %04x:%02x"),
 		pci_domain_nr(bus), child->number);
+#pragma GCC diagnostic pop
 
 	/* Check that all devices are accessible */
 	while (bus->parent) {
diff --git a/drivers/pnp/interface.c b/drivers/pnp/interface.c
index 44efcdb87e6f..6271e68f27eb 100644
--- a/drivers/pnp/interface.c
+++ b/drivers/pnp/interface.c
@@ -270,7 +270,11 @@ static ssize_t resources_show(struct device *dmdev,
 	list_for_each_entry(pnp_res, &dev->resources, list) {
 		res = &pnp_res->res;
 
+/* pnp_resource_type_name returns constant strings */
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 		pnp_printf(buffer, pnp_resource_type_name(res));
+#pragma GCC diagnostic pop
 
 		if (res->flags & IORESOURCE_DISABLED) {
 			pnp_printf(buffer, " disabled\n");
diff --git a/drivers/regulator/of_regulator.c b/drivers/regulator/of_regulator.c
index 1b65e5e4e40f..b2f479e3c7b7 100644
--- a/drivers/regulator/of_regulator.c
+++ b/drivers/regulator/of_regulator.c
@@ -64,7 +64,11 @@ static void of_get_regulator_prot_limits(struct device_node *np,
 		};
 
 		for (j = 0; j < ARRAY_SIZE(lvl); j++) {
+			__diag_push()
+			__diag_ignore(GCC, 4, "-Wformat-security",
+			      "props is a constant array, known at compile time");
 			snprintf(prop, 255, props[i], lvl[j]);
+			__diag_pop()
 			found = !of_property_read_u32(np, prop, &pval);
 			if (found)
 				fill_limit(l[j], pval);
diff --git a/drivers/regulator/qcom-rpmh-regulator.c b/drivers/regulator/qcom-rpmh-regulator.c
index b0a58c62b1e2..2faf08e660f5 100644
--- a/drivers/regulator/qcom-rpmh-regulator.c
+++ b/drivers/regulator/qcom-rpmh-regulator.c
@@ -431,8 +431,12 @@ static int rpmh_regulator_init_vreg(struct rpmh_vreg *vreg, struct device *dev,
 		return -EINVAL;
 	}
 
+/* rpmh_data->resource_name is constant with %s */
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	scnprintf(rpmh_resource_name, sizeof(rpmh_resource_name),
 		rpmh_data->resource_name, pmic_id);
+#pragma GCC diagnostic pop
 
 	vreg->addr = cmd_db_read_addr(rpmh_resource_name);
 	if (!vreg->addr) {
diff --git a/drivers/scsi/aacraid/linit.c b/drivers/scsi/aacraid/linit.c
index 68f4dbcfff49..59bdc4d1a51e 100644
--- a/drivers/scsi/aacraid/linit.c
+++ b/drivers/scsi/aacraid/linit.c
@@ -557,10 +557,13 @@ static ssize_t aac_show_raid_level(struct device *dev, struct device_attribute *
 {
 	struct scsi_device *sdev = to_scsi_device(dev);
 	struct aac_dev *aac = (struct aac_dev *)(sdev->host->hostdata);
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	if (sdev_channel(sdev) != CONTAINER_CHANNEL)
 		return snprintf(buf, PAGE_SIZE, sdev->no_uld_attach
 		  ? "Hidden\n" :
 		  ((aac->jbod && (sdev->type == TYPE_DISK)) ? "JBOD\n" : ""));
+#pragma GCC diagnostic pop
 	return snprintf(buf, PAGE_SIZE, "%s\n",
 	  get_container_type(aac->fsa_dev[sdev_id(sdev)].type));
 }
diff --git a/drivers/scsi/aic7xxx/aic79xx_pci.c b/drivers/scsi/aic7xxx/aic79xx_pci.c
index 5fad41b1ab58..39f4893b2dcf 100644
--- a/drivers/scsi/aic7xxx/aic79xx_pci.c
+++ b/drivers/scsi/aic7xxx/aic79xx_pci.c
@@ -822,7 +822,10 @@ ahd_pci_intr(struct ahd_softc *ahd)
 				s = pci_status_strings[bit];
 				if (i == 7/*TARG*/ && bit == 3)
 					s = "%s: Signaled Target Abort\n";
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 				printk(s, ahd_name(ahd), pci_status_source[i]);
+#pragma GCC diagnostic pop
 			}
 		}	
 	}
@@ -876,7 +879,8 @@ ahd_pci_split_intr(struct ahd_softc *ahd, u_int intstat)
 		u_int bit;
 
 		for (bit = 0; bit < 8; bit++) {
-
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 			if ((split_status[i] & (0x1 << bit)) != 0)
 				printk(split_status_strings[bit], ahd_name(ahd),
 				       split_status_source[i]);
@@ -886,6 +890,7 @@ ahd_pci_split_intr(struct ahd_softc *ahd, u_int intstat)
 
 			if ((sg_split_status[i] & (0x1 << bit)) != 0)
 				printk(split_status_strings[bit], ahd_name(ahd), "SG");
+#pragma GCC diagnostic pop
 		}
 	}
 	/*
diff --git a/drivers/scsi/iscsi_boot_sysfs.c b/drivers/scsi/iscsi_boot_sysfs.c
index a64abe38db2d..1a73765f666b 100644
--- a/drivers/scsi/iscsi_boot_sysfs.c
+++ b/drivers/scsi/iscsi_boot_sysfs.c
@@ -350,11 +350,14 @@ iscsi_boot_create_kobj(struct iscsi_boot_kset *boot_kset,
 	INIT_LIST_HEAD(&boot_kobj->list);
 
 	boot_kobj->kobj.kset = boot_kset->kset;
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	if (kobject_init_and_add(&boot_kobj->kobj, &iscsi_boot_ktype,
 				 NULL, name, index)) {
 		kobject_put(&boot_kobj->kobj);
 		return NULL;
 	}
+#pragma GCC diagnostic pop
 	boot_kobj->data = data;
 	boot_kobj->show = show;
 	boot_kobj->is_visible = is_visible;
diff --git a/drivers/scsi/lpfc/lpfc_debugfs.c b/drivers/scsi/lpfc/lpfc_debugfs.c
index bdf34af4ef36..6369adbfdc4c 100644
--- a/drivers/scsi/lpfc/lpfc_debugfs.c
+++ b/drivers/scsi/lpfc/lpfc_debugfs.c
@@ -168,8 +168,11 @@ lpfc_debugfs_disc_trc_data(struct lpfc_vport *vport, char *buf, int size)
 		snprintf(buffer,
 			LPFC_DEBUG_TRC_ENTRY_SIZE, "%010d:%010d ms:%s\n",
 			dtp->seq_cnt, ms, dtp->fmt);
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 		len +=  scnprintf(buf+len, size-len, buffer,
 			dtp->data1, dtp->data2, dtp->data3);
+#pragma GCC diagnostic pop
 	}
 	for (i = 0; i < index; i++) {
 		dtp = vport->disc_trc + i;
@@ -179,8 +182,11 @@ lpfc_debugfs_disc_trc_data(struct lpfc_vport *vport, char *buf, int size)
 		snprintf(buffer,
 			LPFC_DEBUG_TRC_ENTRY_SIZE, "%010d:%010d ms:%s\n",
 			dtp->seq_cnt, ms, dtp->fmt);
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 		len +=  scnprintf(buf+len, size-len, buffer,
 			dtp->data1, dtp->data2, dtp->data3);
+#pragma GCC diagnostic pop
 	}
 
 	lpfc_debugfs_enable = enable;
@@ -234,8 +240,11 @@ lpfc_debugfs_slow_ring_trc_data(struct lpfc_hba *phba, char *buf, int size)
 		snprintf(buffer,
 			LPFC_DEBUG_TRC_ENTRY_SIZE, "%010d:%010d ms:%s\n",
 			dtp->seq_cnt, ms, dtp->fmt);
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 		len +=  scnprintf(buf+len, size-len, buffer,
 			dtp->data1, dtp->data2, dtp->data3);
+#pragma GCC diagnostic pop
 	}
 	for (i = 0; i < index; i++) {
 		dtp = phba->slow_ring_trc + i;
@@ -245,8 +254,11 @@ lpfc_debugfs_slow_ring_trc_data(struct lpfc_hba *phba, char *buf, int size)
 		snprintf(buffer,
 			LPFC_DEBUG_TRC_ENTRY_SIZE, "%010d:%010d ms:%s\n",
 			dtp->seq_cnt, ms, dtp->fmt);
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 		len +=  scnprintf(buf+len, size-len, buffer,
 			dtp->data1, dtp->data2, dtp->data3);
+#pragma GCC diagnostic pop
 	}
 
 	lpfc_debugfs_enable = enable;
@@ -1623,8 +1635,11 @@ lpfc_debugfs_nvmeio_trc_data(struct lpfc_hba *phba, char *buf, int size)
 		if (!dtp->fmt)
 			continue;
 
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 		len +=  scnprintf(buf + len, size - len, dtp->fmt,
 			dtp->data1, dtp->data2, dtp->data3);
+#pragma GCC diagnostic pop
 
 		if (phba->nvmeio_trc_output_idx >= phba->nvmeio_trc_size) {
 			phba->nvmeio_trc_output_idx = 0;
@@ -1652,8 +1667,11 @@ lpfc_debugfs_nvmeio_trc_data(struct lpfc_hba *phba, char *buf, int size)
 		if (!dtp->fmt)
 			continue;
 
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 		len +=  scnprintf(buf + len, size - len, dtp->fmt,
 			dtp->data1, dtp->data2, dtp->data3);
+#pragma GCC diagnostic pop
 
 		if (phba->nvmeio_trc_output_idx >= phba->nvmeio_trc_size) {
 			phba->nvmeio_trc_output_idx = 0;
diff --git a/drivers/scsi/myrs.c b/drivers/scsi/myrs.c
index a1eec65a9713..ef15dfe0c4f9 100644
--- a/drivers/scsi/myrs.c
+++ b/drivers/scsi/myrs.c
@@ -912,7 +912,11 @@ static void myrs_log_event(struct myrs_hba *cs, struct myrs_event *ev)
 	case 'E':
 		if (cs->disable_enc_msg)
 			break;
+/* The format strings are constants defined above */
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 		sprintf(msg_buf, ev_msg, ev->lun);
+#pragma GCC diagnostic pop
 		shost_printk(KERN_INFO, shost, "event %d: Enclosure %d %s\n",
 			     ev->ev_seq, ev->target, msg_buf);
 		break;
diff --git a/drivers/scsi/qla2xxx/qla_init.c b/drivers/scsi/qla2xxx/qla_init.c
index 1a955c3ff3d6..cf032232b48d 100644
--- a/drivers/scsi/qla2xxx/qla_init.c
+++ b/drivers/scsi/qla2xxx/qla_init.c
@@ -3791,12 +3791,12 @@ static void qla2xxx_print_sfp_info(struct scsi_qla_host *vha)
 	int leftover, len;
 
 	memset(str, 0, STR_LEN);
-	snprintf(str, SFF_VEN_NAME_LEN+1, a0->vendor_name);
+	snprintf(str, SFF_VEN_NAME_LEN+1, "%s", a0->vendor_name);
 	ql_dbg(ql_dbg_init, vha, 0x015a,
 	    "SFP MFG Name: %s\n", str);
 
 	memset(str, 0, STR_LEN);
-	snprintf(str, SFF_PART_NAME_LEN+1, a0->vendor_pn);
+	snprintf(str, SFF_PART_NAME_LEN+1, "%s", a0->vendor_pn);
 	ql_dbg(ql_dbg_init, vha, 0x015c,
 	    "SFP Part Name: %s\n", str);
 
diff --git a/drivers/scsi/scsi_logging.c b/drivers/scsi/scsi_logging.c
index b02af340c2d3..0599935cd78d 100644
--- a/drivers/scsi/scsi_logging.c
+++ b/drivers/scsi/scsi_logging.c
@@ -280,8 +280,11 @@ scsi_format_sense_hdr(char *buffer, size_t buf_len,
 	else
 		off += scnprintf(buffer + off, buf_len - off,
 				 "0x%x ", sshdr->sense_key);
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	off += scnprintf(buffer + off, buf_len - off,
 		scsi_sense_is_deferred(sshdr) ? "[deferred] " : "[current] ");
+#pragma GCC diagnostic pop
 
 	if (sshdr->response_code >= 0x72)
 		off += scnprintf(buffer + off, buf_len - off, "[descriptor] ");
diff --git a/drivers/scsi/smartpqi/smartpqi_init.c b/drivers/scsi/smartpqi/smartpqi_init.c
index 03de97cd72c2..a90a5a31ffa5 100644
--- a/drivers/scsi/smartpqi/smartpqi_init.c
+++ b/drivers/scsi/smartpqi/smartpqi_init.c
@@ -1880,8 +1880,11 @@ static void pqi_show_volume_status(struct pqi_ctrl_info *ctrl_info,
 		status = "Volume status not available";
 		break;
 	default:
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 		snprintf(unknown_state_buffer, sizeof(unknown_state_buffer),
 			unknown_state_str, device->volume_status);
+#pragma GCC diagnostic pop
 		status = unknown_state_buffer;
 		break;
 	}
diff --git a/drivers/scsi/st.c b/drivers/scsi/st.c
index b90a440e135d..76b1f296129a 100644
--- a/drivers/scsi/st.c
+++ b/drivers/scsi/st.c
@@ -4595,7 +4595,10 @@ default_density_show(struct device *dev, struct device_attribute *attr,
 	char *fmt;
 
 	fmt = STm->default_density >= 0 ? "0x%02x\n" : "%d\n";
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	l = snprintf(buf, PAGE_SIZE, fmt, STm->default_density);
+#pragma GCC diagnostic pop
 	return l;
 }
 static DEVICE_ATTR_RO(default_density);
diff --git a/drivers/soundwire/sysfs_slave_dpn.c b/drivers/soundwire/sysfs_slave_dpn.c
index c4b6543c09fd..ff6b3211f287 100644
--- a/drivers/soundwire/sysfs_slave_dpn.c
+++ b/drivers/soundwire/sysfs_slave_dpn.c
@@ -95,6 +95,8 @@ static ssize_t field##_show(struct device *dev,				\
 }									\
 sdw_dpn_attribute_alloc(field)
 
+__diag_push()
+__diag(ignored "-Wformat-security")
 sdw_dpn_attr(imp_def_interrupts);
 sdw_dpn_attr(max_word);
 sdw_dpn_attr(min_word);
@@ -107,6 +109,7 @@ sdw_dpn_attr(min_ch);
 sdw_dpn_attr(max_async_buffer);
 sdw_dpn_attr(block_pack_mode);
 sdw_dpn_attr(port_encoding);
+__diag_pop()
 
 #define sdw_dpn_array_attr(field)					\
 									\
@@ -134,10 +137,11 @@ static ssize_t field##_dpn_show(struct sdw_slave *slave,		\
 	i = 0;								\
 	for_each_set_bit(bit, &mask, 32) {				\
 		if (bit == N) {						\
-			for (j = 0; j < dpn[i].num_##field; j++)	\
+			for (j = 0; j < dpn[i].num_##field; j++) {	\
 				size += sprintf(buf + size,		\
 						format_string,		\
 						dpn[i].field[j]);	\
+			} \
 			size += sprintf(buf + size, "\n");		\
 			return size;					\
 		}							\
@@ -160,9 +164,12 @@ static ssize_t field##_show(struct device *dev,				\
 }									\
 sdw_dpn_attribute_alloc(field)
 
+__diag_push()
+__diag(ignored "-Wformat-security")
 sdw_dpn_array_attr(words);
 sdw_dpn_array_attr(ch_combinations);
 sdw_dpn_array_attr(channels);
+__diag_pop()
 
 static int add_all_attributes(struct device *dev, int N, int dir)
 {
diff --git a/drivers/staging/most/dim2/dim2.c b/drivers/staging/most/dim2/dim2.c
index 44d3252d4612..432dfc41b5e3 100644
--- a/drivers/staging/most/dim2/dim2.c
+++ b/drivers/staging/most/dim2/dim2.c
@@ -870,7 +870,10 @@ static int dim2_probe(struct platform_device *pdev)
 		else
 			fmt = "dim2-%016x";
 
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 		snprintf(dev->name, sizeof(dev->name), fmt, res->start);
+#pragma GCC diagnostic pop
 	}
 
 	dev->most_iface.interface = ITYPE_MEDIALB_DIM2;
diff --git a/drivers/staging/vme_user/vme_user.c b/drivers/staging/vme_user/vme_user.c
index b9367b575d00..a69f09f8226b 100644
--- a/drivers/staging/vme_user/vme_user.c
+++ b/drivers/staging/vme_user/vme_user.c
@@ -641,9 +641,12 @@ static int vme_user_probe(struct vme_dev *vdev)
 		}
 
 		num = (type[i] == SLAVE_MINOR) ? i - (MASTER_MAX + 1) : i;
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 		image[i].device = device_create(vme_user_sysfs_class, NULL,
 						MKDEV(VME_MAJOR, i), NULL,
 						name, num);
+#pragma GCC diagnostic pop
 		if (IS_ERR(image[i].device)) {
 			dev_info(&vdev->dev, "Error creating sysfs device\n");
 			err = PTR_ERR(image[i].device);
diff --git a/drivers/tty/serial/pch_uart.c b/drivers/tty/serial/pch_uart.c
index cc83b772b7ca..337166811608 100644
--- a/drivers/tty/serial/pch_uart.c
+++ b/drivers/tty/serial/pch_uart.c
@@ -1006,7 +1006,10 @@ static void pch_uart_err_ir(struct eg20t_port *priv, unsigned int lsr)
 
 	if (tty == NULL) {
 		for (i = 0; error_msg[i] != NULL; i++)
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 			dev_err(&priv->pdev->dev, error_msg[i]);
+#pragma GCC diagnostic pop
 	} else {
 		tty_kref_put(tty);
 	}
diff --git a/drivers/usb/core/devices.c b/drivers/usb/core/devices.c
index 2c14a9636056..185706078b0a 100644
--- a/drivers/usb/core/devices.c
+++ b/drivers/usb/core/devices.c
@@ -180,11 +180,14 @@ static char *usb_dump_endpoint_descriptor(int speed, char *start, char *end,
 		interval /= 1000;
 	}
 
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	start += sprintf(start, format_endpt, desc->bEndpointAddress, dir,
 			 desc->bmAttributes, type,
 			 usb_endpoint_maxp(desc) *
 			 bandwidth,
 			 interval, unit);
+#pragma GCC diagnostic pop
 	return start;
 }
 
@@ -206,6 +209,8 @@ static char *usb_dump_interface_descriptor(char *start, char *end,
 				: "(none)");
 		active = (desc == &iface->cur_altsetting->desc);
 	}
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	start += sprintf(start, format_iface,
 			 active ? '*' : ' ',	/* mark active altsetting */
 			 desc->bInterfaceNumber,
@@ -216,6 +221,7 @@ static char *usb_dump_interface_descriptor(char *start, char *end,
 			 desc->bInterfaceSubClass,
 			 desc->bInterfaceProtocol,
 			 driver_name);
+#pragma GCC diagnostic pop
 	return start;
 }
 
@@ -239,6 +245,8 @@ static char *usb_dump_iad_descriptor(char *start, char *end,
 {
 	if (start > end)
 		return start;
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	start += sprintf(start, format_iad,
 			 iad->bFirstInterface,
 			 iad->bInterfaceCount,
@@ -246,6 +254,7 @@ static char *usb_dump_iad_descriptor(char *start, char *end,
 			 class_decode(iad->bFunctionClass),
 			 iad->bFunctionSubClass,
 			 iad->bFunctionProtocol);
+#pragma GCC diagnostic pop
 	return start;
 }
 
@@ -266,6 +275,8 @@ static char *usb_dump_config_descriptor(char *start, char *end,
 		mul = 8;
 	else
 		mul = 2;
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	start += sprintf(start, format_config,
 			 /* mark active/actual/current cfg. */
 			 active ? '*' : ' ',
@@ -273,6 +284,7 @@ static char *usb_dump_config_descriptor(char *start, char *end,
 			 desc->bConfigurationValue,
 			 desc->bmAttributes,
 			 desc->bMaxPower * mul);
+#pragma GCC diagnostic pop
 	return start;
 }
 
@@ -318,6 +330,8 @@ static char *usb_dump_device_descriptor(char *start, char *end,
 
 	if (start > end)
 		return start;
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	start += sprintf(start, format_device1,
 			  bcdUSB >> 8, bcdUSB & 0xff,
 			  desc->bDeviceClass,
@@ -332,6 +346,7 @@ static char *usb_dump_device_descriptor(char *start, char *end,
 			 le16_to_cpu(desc->idVendor),
 			 le16_to_cpu(desc->idProduct),
 			 bcdDevice >> 8, bcdDevice & 0xff);
+#pragma GCC diagnostic pop
 	return start;
 }
 
@@ -343,6 +358,8 @@ static char *usb_dump_device_strings(char *start, char *end,
 {
 	if (start > end)
 		return start;
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	if (dev->manufacturer)
 		start += sprintf(start, format_string_manufacturer,
 				 dev->manufacturer);
@@ -357,6 +374,7 @@ static char *usb_dump_device_strings(char *start, char *end,
 		start += sprintf(start, format_string_serialnumber,
 				 dev->serial);
 #endif
+#pragma GCC diagnostic pop
  out:
 	return start;
 }
@@ -434,10 +452,13 @@ static ssize_t usb_device_dump(char __user **buffer, size_t *nbytes,
 	default:
 		speed = "??";
 	}
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	data_end = pages_start + sprintf(pages_start, format_topo,
 			bus->busnum, level, parent_devnum,
 			index, count, usbdev->devnum,
 			speed, usbdev->maxchild);
+#pragma GCC diagnostic pop
 	/*
 	 * level = topology-tier level;
 	 * parent_devnum = parent device number;
@@ -459,12 +480,15 @@ static ssize_t usb_device_dump(char __user **buffer, size_t *nbytes,
 		 * the schedules are actually bursty, HCDs need to deal with
 		 * that and just compute/report this average.
 		 */
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 		data_end += sprintf(data_end, format_bandwidth,
 				bus->bandwidth_allocated, max,
 				(100 * bus->bandwidth_allocated + max / 2)
 					/ max,
 				bus->bandwidth_int_reqs,
 				bus->bandwidth_isoc_reqs);
+#pragma GCC diagnostic pop
 
 	}
 	data_end = usb_dump_desc(data_end, pages_start + (2 * PAGE_SIZE) - 256,
diff --git a/drivers/usb/core/file.c b/drivers/usb/core/file.c
index c4ed3310e069..2fa5d34db431 100644
--- a/drivers/usb/core/file.c
+++ b/drivers/usb/core/file.c
@@ -199,7 +199,10 @@ int usb_register_dev(struct usb_interface *intf,
 	}
 
 	/* create a usb class device for this usb interface */
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	snprintf(name, sizeof(name), class_driver->name, minor - minor_base);
+#pragma GCC diagnostic pop
 	intf->usb_dev = device_create(usb_class->class, &intf->dev,
 				      MKDEV(USB_MAJOR, minor), class_driver,
 				      "%s", kbasename(name));
diff --git a/drivers/usb/fotg210/fotg210-hcd.c b/drivers/usb/fotg210/fotg210-hcd.c
index 929106c16b29..17a54588aeea 100644
--- a/drivers/usb/fotg210/fotg210-hcd.c
+++ b/drivers/usb/fotg210/fotg210-hcd.c
@@ -692,19 +692,28 @@ static ssize_t fill_registers_buffer(struct debug_buffer *buf)
 	/* Operational Registers */
 	temp = dbg_status_buf(scratch, sizeof(scratch), label,
 			fotg210_readl(fotg210, &fotg210->regs->status));
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	temp = scnprintf(next, size, fmt, temp, scratch);
+#pragma GCC diagnostic pop
 	size -= temp;
 	next += temp;
 
 	temp = dbg_command_buf(scratch, sizeof(scratch), label,
 			fotg210_readl(fotg210, &fotg210->regs->command));
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	temp = scnprintf(next, size, fmt, temp, scratch);
+#pragma GCC diagnostic pop
 	size -= temp;
 	next += temp;
 
 	temp = dbg_intr_buf(scratch, sizeof(scratch), label,
 			fotg210_readl(fotg210, &fotg210->regs->intr_enable));
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	temp = scnprintf(next, size, fmt, temp, scratch);
+#pragma GCC diagnostic pop
 	size -= temp;
 	next += temp;
 
diff --git a/drivers/usb/host/ehci-dbg.c b/drivers/usb/host/ehci-dbg.c
index c063fb042926..b9906fdccd41 100644
--- a/drivers/usb/host/ehci-dbg.c
+++ b/drivers/usb/host/ehci-dbg.c
@@ -846,19 +846,28 @@ static ssize_t fill_registers_buffer(struct debug_buffer *buf)
 	/* Operational Registers */
 	temp = dbg_status_buf(scratch, sizeof(scratch), label,
 			ehci_readl(ehci, &ehci->regs->status));
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	temp = scnprintf(next, size, fmt, temp, scratch);
+#pragma GCC diagnostic pop
 	size -= temp;
 	next += temp;
 
 	temp = dbg_command_buf(scratch, sizeof(scratch), label,
 			ehci_readl(ehci, &ehci->regs->command));
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	temp = scnprintf(next, size, fmt, temp, scratch);
+#pragma GCC diagnostic pop
 	size -= temp;
 	next += temp;
 
 	temp = dbg_intr_buf(scratch, sizeof(scratch), label,
 			ehci_readl(ehci, &ehci->regs->intr_enable));
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	temp = scnprintf(next, size, fmt, temp, scratch);
+#pragma GCC diagnostic pop
 	size -= temp;
 	next += temp;
 
@@ -871,7 +880,10 @@ static ssize_t fill_registers_buffer(struct debug_buffer *buf)
 		temp = dbg_port_buf(scratch, sizeof(scratch), label, i,
 				ehci_readl(ehci,
 					&ehci->regs->port_status[i - 1]));
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 		temp = scnprintf(next, size, fmt, temp, scratch);
+#pragma GCC diagnostic pop
 		size -= temp;
 		next += temp;
 		if (i == HCS_DEBUG_PORT(ehci->hcs_params) && ehci->debug) {
diff --git a/drivers/video/fbdev/matrox/i2c-matroxfb.c b/drivers/video/fbdev/matrox/i2c-matroxfb.c
index e2e4705e3fe0..c781db89502f 100644
--- a/drivers/video/fbdev/matrox/i2c-matroxfb.c
+++ b/drivers/video/fbdev/matrox/i2c-matroxfb.c
@@ -109,8 +109,12 @@ static int i2c_bus_reg(struct i2c_bit_adapter* b, struct matrox_fb_info* minfo,
 	b->mask.data = data;
 	b->mask.clock = clock;
 	b->adapter.owner = THIS_MODULE;
+/* TODO check that name is under kernel control */
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	snprintf(b->adapter.name, sizeof(b->adapter.name), name,
 		minfo->fbcon.node);
+#pragma GCC diagnostic pop
 	i2c_set_adapdata(&b->adapter, b);
 	b->adapter.class = class;
 	b->adapter.algo_data = &b->bac;
diff --git a/fs/btrfs/check-integrity.c b/fs/btrfs/check-integrity.c
index 82e49d985019..27365c625b39 100644
--- a/fs/btrfs/check-integrity.c
+++ b/fs/btrfs/check-integrity.c
@@ -2446,7 +2446,10 @@ static void btrfsic_dump_tree_sub(const struct btrfsic_state *state,
 		printk("[...]\n");
 		return;
 	}
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	printk(buf);
+#pragma GCC diagnostic pop
 	indent_level += indent_add;
 	if (list_empty(&block->ref_to_list)) {
 		printk("\n");
@@ -2475,7 +2478,10 @@ static void btrfsic_dump_tree_sub(const struct btrfsic_state *state,
 			continue;
 		}
 
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 		printk(buf);
+#pragma GCC diagnostic pop
 
 		btrfsic_dump_tree_sub(state, l->block_ref_to,
 				      indent_level + indent_add);
diff --git a/fs/btrfs/ctree.c b/fs/btrfs/ctree.c
index 2ff2961b1183..b6d4ac5804aa 100644
--- a/fs/btrfs/ctree.c
+++ b/fs/btrfs/ctree.c
@@ -419,7 +419,11 @@ static noinline int update_ref_for_cow(struct btrfs_trans_handle *trans,
 			return ret;
 		if (refs == 0) {
 			ret = -EROFS;
+/* gcc does not like calling __btrfs_handle_fs_error() with NULL */
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 			btrfs_handle_fs_error(fs_info, ret, NULL);
+#pragma GCC diagnostic pop
 			return ret;
 		}
 	} else {
@@ -1028,7 +1032,11 @@ static noinline int balance_level(struct btrfs_trans_handle *trans,
 		child = btrfs_read_node_slot(mid, 0);
 		if (IS_ERR(child)) {
 			ret = PTR_ERR(child);
+/* gcc does not like calling __btrfs_handle_fs_error() with NULL */
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 			btrfs_handle_fs_error(fs_info, ret, NULL);
+#pragma GCC diagnostic pop
 			goto enospc;
 		}
 
@@ -1147,7 +1155,11 @@ static noinline int balance_level(struct btrfs_trans_handle *trans,
 		 */
 		if (!left) {
 			ret = -EROFS;
+/* gcc does not like calling __btrfs_handle_fs_error() with NULL */
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 			btrfs_handle_fs_error(fs_info, ret, NULL);
+#pragma GCC diagnostic pop
 			goto enospc;
 		}
 		wret = balance_node_right(trans, mid, left);
diff --git a/fs/btrfs/inode-item.c b/fs/btrfs/inode-item.c
index 4c322b720a80..f200a2e075e5 100644
--- a/fs/btrfs/inode-item.c
+++ b/fs/btrfs/inode-item.c
@@ -142,7 +142,10 @@ static int btrfs_del_inode_extref(struct btrfs_trans_handle *trans,
 	extref = btrfs_find_name_in_ext_backref(path->nodes[0], path->slots[0],
 						ref_objectid, name);
 	if (!extref) {
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 		btrfs_handle_fs_error(root->fs_info, -ENOENT, NULL);
+#pragma GCC diagnostic pop
 		ret = -EROFS;
 		goto out;
 	}
diff --git a/fs/btrfs/relocation.c b/fs/btrfs/relocation.c
index 59a06499c647..5aa48bed9641 100644
--- a/fs/btrfs/relocation.c
+++ b/fs/btrfs/relocation.c
@@ -2044,7 +2044,11 @@ void merge_reloc_roots(struct reloc_control *rc)
 	}
 out:
 	if (ret) {
+/* gcc does not like calling __btrfs_handle_fs_error() with NULL */
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 		btrfs_handle_fs_error(fs_info, ret, NULL);
+#pragma GCC diagnostic pop
 		free_reloc_roots(&reloc_roots);
 
 		/* new reloc root may be added */
diff --git a/fs/btrfs/sysfs.c b/fs/btrfs/sysfs.c
index 25294e624851..c94fe6e69c90 100644
--- a/fs/btrfs/sysfs.c
+++ b/fs/btrfs/sysfs.c
@@ -967,7 +967,10 @@ static ssize_t btrfs_label_show(struct kobject *kobj,
 	ssize_t ret;
 
 	spin_lock(&fs_info->super_lock);
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	ret = sysfs_emit(buf, label[0] ? "%s\n" : "%s", label);
+#pragma GCC diagnostic pop
 	spin_unlock(&fs_info->super_lock);
 
 	return ret;
diff --git a/fs/btrfs/volumes.c b/fs/btrfs/volumes.c
index 841e799dece5..e24c9099f021 100644
--- a/fs/btrfs/volumes.c
+++ b/fs/btrfs/volumes.c
@@ -3310,7 +3310,10 @@ int btrfs_relocate_chunk(struct btrfs_fs_info *fs_info, u64 chunk_offset)
 						     chunk_offset);
 	if (IS_ERR(trans)) {
 		ret = PTR_ERR(trans);
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 		btrfs_handle_fs_error(root->fs_info, ret, NULL);
+#pragma GCC diagnostic pop
 		return ret;
 	}
 
diff --git a/fs/libfs.c b/fs/libfs.c
index 89cf614a3271..5ca494b5acab 100644
--- a/fs/libfs.c
+++ b/fs/libfs.c
@@ -978,8 +978,12 @@ ssize_t simple_attr_read(struct file *file, char __user *buf,
 		if (ret)
 			goto out;
 
+/* Checking of attr->fmt is done by using __simple_attr_check_format */
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 		size = scnprintf(attr->get_buf, sizeof(attr->get_buf),
 				 attr->fmt, (unsigned long long)val);
+#pragma GCC diagnostic pop
 	}
 
 	ret = simple_read_from_buffer(buf, len, ppos, attr->get_buf, size);
diff --git a/fs/ocfs2/ocfs2_fs.h b/fs/ocfs2/ocfs2_fs.h
index 7aebdbf5cc0a..962c651bf053 100644
--- a/fs/ocfs2/ocfs2_fs.h
+++ b/fs/ocfs2/ocfs2_fs.h
@@ -1577,10 +1577,15 @@ static inline int ocfs2_sprintf_system_inode_name(char *buf, int len,
 	if (type <= OCFS2_LAST_GLOBAL_SYSTEM_INODE)
 		chars = snprintf(buf, len, "%s",
 				 ocfs2_system_inodes[type].si_name);
-	else
+	else {
+/* why? (BUG?) I did not understand this code */
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 		chars = snprintf(buf, len,
 				 ocfs2_system_inodes[type].si_name,
 				 slot);
+#pragma GCC diagnostic pop
+	}
 
 	return chars;
 }
diff --git a/fs/proc/version.c b/fs/proc/version.c
index 02e3c3cd4a9a..6e2122e9e98f 100644
--- a/fs/proc/version.c
+++ b/fs/proc/version.c
@@ -9,10 +9,13 @@
 
 static int version_proc_show(struct seq_file *m, void *v)
 {
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	seq_printf(m, linux_proc_banner,
 		utsname()->sysname,
 		utsname()->release,
 		utsname()->version);
+#pragma GCC diagnostic pop
 	return 0;
 }
 
diff --git a/fs/reiserfs/prints.c b/fs/reiserfs/prints.c
index 21878bb119c5..5f5d42c2b331 100644
--- a/fs/reiserfs/prints.c
+++ b/fs/reiserfs/prints.c
@@ -310,7 +310,7 @@ void reiserfs_info(struct super_block *sb, const char *fmt, ...)
 static __printf(1, 2) void reiserfs_printk(const char *fmt, ...)
 {
 	do_reiserfs_warning(fmt);
-	printk(error_buf);
+	printk("%s", error_buf);
 }
 
 void reiserfs_debug(struct super_block *s, int level, const char *fmt, ...)
@@ -398,7 +398,7 @@ void __reiserfs_error(struct super_block *sb, const char *id,
 	BUG_ON(sb == NULL);
 
 	if (reiserfs_error_panic(sb))
-		__reiserfs_panic(sb, id, function, error_buf);
+		__reiserfs_panic(sb, id, function, "%s", error_buf);
 
 	if (id && id[0])
 		printk(KERN_CRIT "REISERFS error (device %s): %s %s: %s\n",
diff --git a/include/linux/kernel.h b/include/linux/kernel.h
index 0d91e0af0125..16a80172cafe 100644
--- a/include/linux/kernel.h
+++ b/include/linux/kernel.h
@@ -349,6 +349,7 @@ do {							\
 		trace_puts(fmt);			\
 } while (0)
 
+#if 0
 #define do_trace_printk(fmt, args...)					\
 do {									\
 	static const char *trace_printk_fmt __used			\
@@ -357,11 +358,22 @@ do {									\
 									\
 	__trace_printk_check_format(fmt, ##args);			\
 									\
-	if (__builtin_constant_p(fmt))					\
+	if (__builtin_constant_p(fmt)) {					\
+_Pragma("GCC diagnostic push") \
+_Pragma("GCC diagnostic ignored \"-Wformat-security\"") \
 		__trace_bprintk(_THIS_IP_, trace_printk_fmt, ##args);	\
-	else								\
+_Pragma("GCC diagnostic pop") \
+	} else								\
 		__trace_printk(_THIS_IP_, fmt, ##args);			\
 } while (0)
+#else
+/* Be nice with gcc's -Wformat-security, as the previous tentative did not work */
+#define do_trace_printk(fmt, args...)					\
+do {									\
+	__trace_printk_check_format(fmt, ##args);			\
+	__trace_printk(_THIS_IP_, fmt, ##args);				\
+} while (0)
+#endif
 
 extern __printf(2, 3)
 int __trace_bprintk(unsigned long ip, const char *fmt, ...);
diff --git a/include/rdma/rdma_vt.h b/include/rdma/rdma_vt.h
index c429d6ddb129..650ca4a1d74f 100644
--- a/include/rdma/rdma_vt.h
+++ b/include/rdma/rdma_vt.h
@@ -444,7 +444,10 @@ static inline void rvt_set_ibdev_name(struct rvt_dev_info *rdi,
 	 * infrastructure in the core to support this directly today, hack it
 	 * to work by setting the name manually here.
 	 */
+	__diag_push()
+	__diag_ignore(GCC, 4, "-Wformat-security", "rvt_set_ibdev_name is only called with fmt = '%s_%d' or '%s%d'")
 	dev_set_name(&rdi->ibdev.dev, fmt, name, unit);
+	__diag_pop()
 	strscpy(rdi->ibdev.name, dev_name(&rdi->ibdev.dev), IB_DEVICE_NAME_MAX);
 }
 
diff --git a/kernel/bpf/helpers.c b/kernel/bpf/helpers.c
index b0d2984f434e..96bef3f0ea8c 100644
--- a/kernel/bpf/helpers.c
+++ b/kernel/bpf/helpers.c
@@ -936,8 +936,11 @@ int bpf_bprintf_prepare(char *fmt, u32 fmt_size, const u64 *raw_args,
 			 */
 			ip_spec[2] = fmt[i - 1];
 			ip_spec[3] = fmt[i];
+__diag_push()
+__diag(ignored "-Wformat-security")
 			err = snprintf(tmp_buf, tmp_buf_end - tmp_buf,
 				       ip_spec, &cur_ip);
+__diag_pop()
 
 			tmp_buf += err + 1;
 			num_spec++;
diff --git a/kernel/bpf/verifier.c b/kernel/bpf/verifier.c
index 5871aa78d01a..5b8fa2bd65d9 100644
--- a/kernel/bpf/verifier.c
+++ b/kernel/bpf/verifier.c
@@ -9274,7 +9274,10 @@ static int check_helper_call(struct bpf_verifier_env *env, struct bpf_insn *insn
 		err_str = "func %s#%d not supported without CONFIG_PERF_EVENTS\n";
 #endif
 		if (err) {
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 			verbose(env, err_str, func_id_name(func_id), func_id);
+#pragma GCC diagnostic pop
 			return err;
 		}
 
diff --git a/kernel/debug/kdb/kdb_io.c b/kernel/debug/kdb/kdb_io.c
index 5c7e9ba7cd6b..44d631ecf62e 100644
--- a/kernel/debug/kdb/kdb_io.c
+++ b/kernel/debug/kdb/kdb_io.c
@@ -239,7 +239,10 @@ static char *kdb_read(char *buffer, size_t bufsize)
 			kdb_printf("\b%s \r", cp);
 			tmp = *cp;
 			*cp = '\0';
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 			kdb_printf(kdb_prompt_str);
+#pragma GCC diagnostic pop
 			kdb_printf("%s", buffer);
 			*cp = tmp;
 		}
@@ -261,7 +264,10 @@ static char *kdb_read(char *buffer, size_t bufsize)
 			kdb_printf("%s \r", cp);
 			tmp = *cp;
 			*cp = '\0';
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 			kdb_printf(kdb_prompt_str);
+#pragma GCC diagnostic pop
 			kdb_printf("%s", buffer);
 			*cp = tmp;
 		}
@@ -269,7 +275,10 @@ static char *kdb_read(char *buffer, size_t bufsize)
 	case 1: /* Home */
 		if (cp > buffer) {
 			kdb_printf("\r");
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 			kdb_printf(kdb_prompt_str);
+#pragma GCC diagnostic pop
 			cp = buffer;
 		}
 		break;
@@ -350,7 +359,10 @@ static char *kdb_read(char *buffer, size_t bufsize)
 			if (i >= dtab_count)
 				kdb_printf("...");
 			kdb_printf("\n");
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 			kdb_printf(kdb_prompt_str);
+#pragma GCC diagnostic pop
 			kdb_printf("%s", buffer);
 		} else if (tab != 2 && count > 0) {
 			len_tmp = strlen(p_tmp);
@@ -375,7 +387,10 @@ static char *kdb_read(char *buffer, size_t bufsize)
 				++cp;
 				tmp = *cp;
 				*cp = '\0';
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 				kdb_printf(kdb_prompt_str);
+#pragma GCC diagnostic pop
 				kdb_printf("%s", buffer);
 				*cp = tmp;
 			} else {
@@ -436,7 +451,10 @@ char *kdb_getstr(char *buffer, size_t bufsize, const char *prompt)
 {
 	if (prompt && kdb_prompt_str != prompt)
 		strscpy(kdb_prompt_str, prompt, CMD_BUFLEN);
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	kdb_printf(kdb_prompt_str);
+#pragma GCC diagnostic pop
 	kdb_nextline = 1;	/* Prompt and input resets line number */
 	return kdb_read(buffer, bufsize);
 }
diff --git a/kernel/debug/kdb/kdb_main.c b/kernel/debug/kdb/kdb_main.c
index 438b868cbfa9..350566f00273 100644
--- a/kernel/debug/kdb/kdb_main.c
+++ b/kernel/debug/kdb/kdb_main.c
@@ -1347,8 +1347,12 @@ static int kdb_local(kdb_reason_t reason, int error, struct pt_regs *regs,
 
 do_full_getstr:
 		/* PROMPT can only be set if we have MEM_READ permission. */
+/* Bindly trust kdbgetenv("PROMPT") */
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 		snprintf(kdb_prompt_str, CMD_BUFLEN, kdbgetenv("PROMPT"),
 			 raw_smp_processor_id());
+#pragma GCC diagnostic pop
 		if (defcmd_in_progress)
 			strncat(kdb_prompt_str, "[defcmd]", CMD_BUFLEN);
 
@@ -1552,7 +1556,10 @@ static void kdb_md_line(const char *fmtstr, unsigned long addr,
 				break;
 		} else if (kdb_getword(&word, addr, bytesperword))
 			break;
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 		kdb_printf(fmtstr, word);
+#pragma GCC diagnostic pop
 		if (symbolic)
 			kdbnearsym(word, &symtab);
 		else
diff --git a/kernel/kthread.c b/kernel/kthread.c
index 490792b1066e..973fc7331acb 100644
--- a/kernel/kthread.c
+++ b/kernel/kthread.c
@@ -564,8 +564,12 @@ struct task_struct *kthread_create_on_cpu(int (*threadfn)(void *data),
 {
 	struct task_struct *p;
 
+/* namefmt is either constant or uses %u */
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	p = kthread_create_on_node(threadfn, data, cpu_to_node(cpu), namefmt,
 				   cpu);
+#pragma GCC diagnostic pop
 	if (IS_ERR(p))
 		return p;
 	kthread_bind(p, cpu);
diff --git a/kernel/trace/trace.c b/kernel/trace/trace.c
index f4cb8d8c1003..f8e3bf919604 100644
--- a/kernel/trace/trace.c
+++ b/kernel/trace/trace.c
@@ -3947,7 +3947,10 @@ void trace_check_vprintf(struct trace_iterator *iter, const char *fmt,
 		/* Copy up to the %s, and print that */
 		strncpy(iter->fmt, p, i);
 		iter->fmt[i] = '\0';
+__diag_push()
+__diag_ignore(GCC, 4, "-Wformat-security", "The format is checked as being %s")
 		trace_seq_vprintf(&iter->seq, iter->fmt, ap);
+__diag_pop()
 
 		/*
 		 * If iter->seq is full, the above call no longer guarantees
@@ -4005,10 +4008,13 @@ void trace_check_vprintf(struct trace_iterator *iter, const char *fmt,
 			strncpy(iter->fmt, p + i, j + 1);
 			iter->fmt[j+1] = '\0';
 		}
+__diag_push()
+__diag_ignore(GCC, 4, "-Wformat-security", "The format is checked beforehand")
 		if (star)
 			trace_seq_printf(&iter->seq, iter->fmt, len, str);
 		else
 			trace_seq_printf(&iter->seq, iter->fmt, str);
+__diag_pop()
 
 		p += i + j + 1;
 	}
diff --git a/kernel/trace/trace_events_synth.c b/kernel/trace/trace_events_synth.c
index d6a70aff2410..cba05613926f 100644
--- a/kernel/trace/trace_events_synth.c
+++ b/kernel/trace/trace_events_synth.c
@@ -323,6 +323,8 @@ static void print_synth_event_num_val(struct trace_seq *s,
 				      char *print_fmt, char *name,
 				      int size, u64 val, char *space)
 {
+__diag_push()
+__diag(ignored "-Wformat-security")
 	switch (size) {
 	case 1:
 		trace_seq_printf(s, print_fmt, name, (u8)val, space);
@@ -340,6 +342,7 @@ static void print_synth_event_num_val(struct trace_seq *s,
 		trace_seq_printf(s, print_fmt, name, val, space);
 		break;
 	}
+__diag_pop()
 }
 
 static enum print_line_t print_synth_event(struct trace_iterator *iter,
@@ -382,16 +385,22 @@ static enum print_line_t print_synth_event(struct trace_iterator *iter,
 
 				str_field = (char *)entry + data_offset;
 
+__diag_push()
+__diag(ignored "-Wformat-security")
 				trace_seq_printf(s, print_fmt, se->fields[i]->name,
 						 STR_VAR_LEN_MAX,
 						 str_field,
 						 i == se->n_fields - 1 ? "" : " ");
+__diag_pop()
 				n_u64++;
 			} else {
+__diag_push()
+__diag(ignored "-Wformat-security")
 				trace_seq_printf(s, print_fmt, se->fields[i]->name,
 						 STR_VAR_LEN_MAX,
 						 (char *)&entry->fields[n_u64],
 						 i == se->n_fields - 1 ? "" : " ");
+__diag_pop()
 				n_u64 += STR_VAR_LEN_MAX / sizeof(u64);
 			}
 		} else if (se->fields[i]->is_stack) {
diff --git a/kernel/trace/trace_probe.c b/kernel/trace/trace_probe.c
index 2d2616678295..8be68d9fef82 100644
--- a/kernel/trace/trace_probe.c
+++ b/kernel/trace/trace_probe.c
@@ -941,6 +941,8 @@ static int __set_print_fmt(struct trace_probe *tp, char *buf, int len,
 
 	for (i = 0; i < tp->nr_args; i++) {
 		parg = tp->args + i;
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 		if (parg->count) {
 			if (parg->type->is_string)
 				fmt = ", __get_str(%s[%d])";
@@ -957,6 +959,7 @@ static int __set_print_fmt(struct trace_probe *tp, char *buf, int len,
 			pos += snprintf(buf + pos, LEN_OR_ZERO,
 					fmt, parg->name);
 		}
+#pragma GCC diagnostic pop
 	}
 
 	/* return the length of print_fmt */
diff --git a/lib/globtest.c b/lib/globtest.c
index d8e97d43b905..67385a661778 100644
--- a/lib/globtest.c
+++ b/lib/globtest.c
@@ -36,7 +36,11 @@ static bool __pure __init test(char const *pat, char const *str, bool expected)
 	else
 		return success;
 
+/* TODO extend the plugin to catch such cases */
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	printk(message, pat, str, mismatch + 3*match);
+#pragma GCC diagnostic pop
 	return success;
 }
 
diff --git a/lib/test_printf.c b/lib/test_printf.c
index 6dce1ea3ce51..e138d404bb81 100644
--- a/lib/test_printf.c
+++ b/lib/test_printf.c
@@ -153,7 +153,10 @@ test_basic(void)
 	/* Work around annoying "warning: zero-length gnu_printf format string". */
 	const char nul = '\0';
 
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	test("", &nul);
+#pragma GCC diagnostic pop
 	test("100%", "100%%");
 	test("xxx%yyy", "xxx%cyyy", '%');
 	__test("xxx\0yyy", 7, "xxx%cyyy", '\0');
@@ -338,7 +341,10 @@ test_hashed(const char *fmt, const void *p)
 	if (ret)
 		return;
 
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	test(buf, fmt, p);
+#pragma GCC diagnostic pop
 }
 
 /*
@@ -632,8 +638,12 @@ page_flags_test(int section, int node, int zone, int last_cpupid,
 
 		size += scnprintf(cmp_buf + size, BUF_SIZE - size, "%s=",
 				pft[i].name);
+__diag_push()
+__diag(ignored "-Wformat-security")
 		size += scnprintf(cmp_buf + size, BUF_SIZE - size, pft[i].fmt,
 				values[i] & pft[i].mask);
+__diag_pop()
+		size = strlen(cmp_buf);
 		append = true;
 	}
 
diff --git a/mm/kasan/report.c b/mm/kasan/report.c
index 892a9dc9d4d3..a2c7bf9eac8d 100644
--- a/mm/kasan/report.c
+++ b/mm/kasan/report.c
@@ -427,9 +427,12 @@ static void print_memory_metadata(const void *addr)
 		char buffer[4 + (BITS_PER_LONG / 8) * 2];
 		char metadata[META_BYTES_PER_ROW];
 
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 		snprintf(buffer, sizeof(buffer),
 				(i == 0) ? ">%px: " : " %px: ", row);
 
+#pragma GCC diagnostic pop
 		/*
 		 * We should not pass a shadow pointer to generic
 		 * function, because generic functions may try to
diff --git a/mm/shmem.c b/mm/shmem.c
index e40a08c5c6d7..9cdc0384ca85 100644
--- a/mm/shmem.c
+++ b/mm/shmem.c
@@ -4141,10 +4141,13 @@ static ssize_t shmem_enabled_show(struct kobject *kobj,
 	int i;
 
 	for (i = 0; i < ARRAY_SIZE(values); i++) {
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 		len += sysfs_emit_at(buf, len,
 				     shmem_huge == values[i] ? "%s[%s]" : "%s%s",
 				     i ? " " : "",
 				     shmem_format_huge(values[i]));
+#pragma GCC diagnostic pop
 	}
 
 	len += sysfs_emit_at(buf, len, "\n");
diff --git a/mm/slub.c b/mm/slub.c
index c87628cd8a9a..43231af1e6b9 100644
--- a/mm/slub.c
+++ b/mm/slub.c
@@ -4549,7 +4549,10 @@ static void list_slab_objects(struct kmem_cache *s, struct slab *slab,
 	void *addr = slab_address(slab);
 	void *p;
 
+	__diag_push()
+	__diag_ignore(GCC, 4, "-Wformat-security", "text has a %s")
 	slab_err(s, slab, text, s->name);
+	__diag_pop()
 
 	spin_lock(&object_map_lock);
 	__fill_map(object_map, s, slab);
diff --git a/net/8021q/vlanproc.c b/net/8021q/vlanproc.c
index 7825c129742a..10c6171be321 100644
--- a/net/8021q/vlanproc.c
+++ b/net/8021q/vlanproc.c
@@ -256,12 +256,15 @@ static int vlandev_seq_show(struct seq_file *seq, void *offset)
 		   vlandev->name, vlan->vlan_id,
 		   (int)(vlan->flags & 1), vlandev->priv_flags);
 
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	seq_printf(seq, fmt64, "total frames received", stats->rx_packets);
 	seq_printf(seq, fmt64, "total bytes received", stats->rx_bytes);
 	seq_printf(seq, fmt64, "Broadcast/Multicast Rcvd", stats->multicast);
 	seq_puts(seq, "\n");
 	seq_printf(seq, fmt64, "total frames transmitted", stats->tx_packets);
 	seq_printf(seq, fmt64, "total bytes transmitted", stats->tx_bytes);
+#pragma GCC diagnostic pop
 	seq_printf(seq, "Device: %s", vlan->real_dev->name);
 	/* now show all PRIORITY mappings relating to this VLAN */
 	seq_printf(seq, "\nINGRESS priority mappings: "
diff --git a/net/can/proc.c b/net/can/proc.c
index bbce97825f13..32c3a856cdcd 100644
--- a/net/can/proc.c
+++ b/net/can/proc.c
@@ -190,8 +190,11 @@ static void can_print_rcvlist(struct seq_file *m, struct hlist_head *rx_list,
 			"   %-5s  %08x  %08x  %pK  %pK  %8ld  %s\n" :
 			"   %-5s     %03x    %08x  %pK  %pK  %8ld  %s\n";
 
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 		seq_printf(m, fmt, DNAME(dev), r->can_id, r->mask,
 				r->func, r->data, r->matches, r->ident);
+#pragma GCC diagnostic pop
 	}
 }
 
diff --git a/net/core/dev.c b/net/core/dev.c
index b3c13e041935..0b024d1aff18 100644
--- a/net/core/dev.c
+++ b/net/core/dev.c
@@ -1058,7 +1058,10 @@ static int __dev_alloc_name(struct net *net, const char *name, char *buf)
 					continue;
 
 				/*  avoid cases where sscanf is not exact inverse of printf */
+__diag_push()
+__diag(ignored "-Wformat-security")
 				snprintf(buf, IFNAMSIZ, name, i);
+__diag_pop()
 				if (!strncmp(buf, name_node->name, IFNAMSIZ))
 					__set_bit(i, inuse);
 			}
@@ -1068,7 +1071,10 @@ static int __dev_alloc_name(struct net *net, const char *name, char *buf)
 				continue;
 
 			/*  avoid cases where sscanf is not exact inverse of printf */
+__diag_push()
+__diag(ignored "-Wformat-security")
 			snprintf(buf, IFNAMSIZ, name, i);
+__diag_pop()
 			if (!strncmp(buf, d->name, IFNAMSIZ))
 				__set_bit(i, inuse);
 		}
@@ -1077,7 +1083,10 @@ static int __dev_alloc_name(struct net *net, const char *name, char *buf)
 		free_page((unsigned long) inuse);
 	}
 
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	snprintf(buf, IFNAMSIZ, name, i);
+#pragma GCC diagnostic pop
 	if (!netdev_name_in_use(net, buf))
 		return i;
 
@@ -7445,8 +7454,11 @@ static int netdev_adjacent_sysfs_add(struct net_device *dev,
 {
 	char linkname[IFNAMSIZ+7];
 
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	sprintf(linkname, dev_list == &dev->adj_list.upper ?
 		"upper_%s" : "lower_%s", adj_dev->name);
+#pragma GCC diagnostic pop
 	return sysfs_create_link(&(dev->dev.kobj), &(adj_dev->dev.kobj),
 				 linkname);
 }
@@ -7456,8 +7468,11 @@ static void netdev_adjacent_sysfs_del(struct net_device *dev,
 {
 	char linkname[IFNAMSIZ+7];
 
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	sprintf(linkname, dev_list == &dev->adj_list.upper ?
 		"upper_%s" : "lower_%s", name);
+#pragma GCC diagnostic pop
 	sysfs_remove_link(&(dev->dev.kobj), linkname);
 }
 
diff --git a/net/netfilter/ipvs/ip_vs_sync.c b/net/netfilter/ipvs/ip_vs_sync.c
index 264f2f87a437..b5d3e7631bd6 100644
--- a/net/netfilter/ipvs/ip_vs_sync.c
+++ b/net/netfilter/ipvs/ip_vs_sync.c
@@ -1871,7 +1871,11 @@ int start_sync_thread(struct netns_ipvs *ipvs, struct ipvs_sync_daemon_cfg *c,
 		if (result < 0)
 			goto out;
 
+/* name is always initialized */
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 		task = kthread_run(threadfn, tinfo, name, ipvs->gen, id);
+#pragma GCC diagnostic pop
 		if (IS_ERR(task)) {
 			result = PTR_ERR(task);
 			goto out;
diff --git a/net/netfilter/nf_tables_api.c b/net/netfilter/nf_tables_api.c
index dc5675962de4..9c6f4ed2aa30 100644
--- a/net/netfilter/nf_tables_api.c
+++ b/net/netfilter/nf_tables_api.c
@@ -4180,7 +4180,11 @@ static int nf_tables_set_alloc_name(struct nft_ctx *ctx, struct nft_set *set,
 		free_page((unsigned long)inuse);
 	}
 
+/* TODO/maybe BUG: how/where is name computed? */
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	set->name = kasprintf(GFP_KERNEL_ACCOUNT, name, min + n);
+#pragma GCC diagnostic pop
 	if (!set->name)
 		return -ENOMEM;
 
diff --git a/net/netfilter/nft_compat.c b/net/netfilter/nft_compat.c
index 5284cd2ad532..57b05ebd0bd1 100644
--- a/net/netfilter/nft_compat.c
+++ b/net/netfilter/nft_compat.c
@@ -680,8 +680,11 @@ static int nfnl_compat_get_rcu(struct sk_buff *skb,
 		return -EINVAL;
 
 	rcu_read_unlock();
+	__diag_push()
+	__diag_ignore(GCC, 4, "-Wformat-security", "fmt is always initialized by the kernel");
 	try_then_request_module(xt_find_revision(family, name, rev, target, &ret),
 				fmt, name);
+	__diag_pop();
 	if (ret < 0)
 		goto out_put;
 
diff --git a/net/tipc/netlink_compat.c b/net/tipc/netlink_compat.c
index 9b47c8409231..cfaaf7d5915d 100644
--- a/net/tipc/netlink_compat.c
+++ b/net/tipc/netlink_compat.c
@@ -884,7 +884,10 @@ static int tipc_nl_compat_name_table_dump_header(struct tipc_nl_compat_msg *msg)
 	if (depth > 4)
 		depth = 4;
 	for (i = 0; i < depth; i++)
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 		tipc_tlv_sprintf(msg->rep, header[i]);
+#pragma GCC diagnostic pop
 	tipc_tlv_sprintf(msg->rep, "\n");
 
 	return 0;
diff --git a/security/integrity/ima/ima_policy.c b/security/integrity/ima/ima_policy.c
index 3ca8b7348c2e..b89702dec268 100644
--- a/security/integrity/ima/ima_policy.c
+++ b/security/integrity/ima/ima_policy.c
@@ -2106,6 +2106,8 @@ int ima_policy_show(struct seq_file *m, void *v)
 	if (entry->flags & IMA_FUNC)
 		policy_func_show(m, entry->func);
 
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	if ((entry->flags & IMA_MASK) || (entry->flags & IMA_INMASK)) {
 		if (entry->flags & IMA_MASK)
 			offset = 1;
@@ -2258,6 +2260,7 @@ int ima_policy_show(struct seq_file *m, void *v)
 			seq_puts(m, " ");
 		}
 	}
+#pragma GCC diagnostic pop
 	if (entry->template)
 		seq_printf(m, "template=%s ", entry->template->name);
 	if (entry->flags & IMA_DIGSIG_REQUIRED) {
diff --git a/sound/core/ctljack.c b/sound/core/ctljack.c
index 709b1a9c2caa..ccd40f87e600 100644
--- a/sound/core/ctljack.c
+++ b/sound/core/ctljack.c
@@ -55,7 +55,10 @@ static void jack_kctl_name_gen(char *name, const char *src_name, int size)
 	if (count >= 5)
 		need_cat = strncmp(&src_name[count - 5], " Jack", 5) ? true : false;
 
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	snprintf(name, size, need_cat ? "%s Jack" : "%s", src_name);
+#pragma GCC diagnostic pop
 
 }
 
diff --git a/sound/core/misc.c b/sound/core/misc.c
index d32a19976a2b..4e4972fe1383 100644
--- a/sound/core/misc.c
+++ b/sound/core/misc.c
@@ -84,7 +84,10 @@ void __snd_printk(unsigned int level, const char *path, int line,
 	if (!level_found && level)
 		memcpy(verbose_fmt, KERN_DEBUG, sizeof(KERN_DEBUG) - 1);
 
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	printk(verbose_fmt, sanity_file_name(path), line, &vaf);
+#pragma GCC diagnostic pop
 #else
 	vprintk(format, args);
 #endif
diff --git a/sound/core/seq/seq_clientmgr.c b/sound/core/seq/seq_clientmgr.c
index 2d707afa1ef1..97b42c513569 100644
--- a/sound/core/seq/seq_clientmgr.c
+++ b/sound/core/seq/seq_clientmgr.c
@@ -2409,7 +2409,10 @@ static void snd_seq_info_dump_subscribers(struct snd_info_buffer *buffer,
 		up_read(&group->list_mutex);
 		return;
 	}
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	snd_iprintf(buffer, msg);
+#pragma GCC diagnostic pop
 	list_for_each(p, &group->list_head) {
 		if (is_src)
 			s = list_entry(p, struct snd_seq_subscribers, src_list);
diff --git a/sound/drivers/dummy.c b/sound/drivers/dummy.c
index 9c17b49a2ae1..083b4ba2e950 100644
--- a/sound/drivers/dummy.c
+++ b/sound/drivers/dummy.c
@@ -973,12 +973,15 @@ static void dummy_proc_read(struct snd_info_entry *entry,
 
 	for (i = 0; i < ARRAY_SIZE(fields); i++) {
 		snd_iprintf(buffer, "%s ", fields[i].name);
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 		if (fields[i].size == sizeof(int))
 			snd_iprintf(buffer, fields[i].format,
 				*get_dummy_int_ptr(dummy, fields[i].offset));
 		else
 			snd_iprintf(buffer, fields[i].format,
 				*get_dummy_ll_ptr(dummy, fields[i].offset));
+#pragma GCC diagnostic pop
 		if (!strcmp(fields[i].name, "formats"))
 			print_formats(dummy, buffer);
 		else if (!strcmp(fields[i].name, "rates"))
diff --git a/sound/drivers/opl3/opl3_seq.c b/sound/drivers/opl3/opl3_seq.c
index 75de1299c3dc..c729b06db0c3 100644
--- a/sound/drivers/opl3/opl3_seq.c
+++ b/sound/drivers/opl3/opl3_seq.c
@@ -223,9 +223,12 @@ static int snd_opl3_seq_probe(struct device *_dev)
 	/* allocate new client */
 	opl_ver = (opl3->hardware & OPL3_HW_MASK) >> 8;
 	sprintf(name, "OPL%i FM synth", opl_ver);
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	client = opl3->seq_client =
 		snd_seq_create_kernel_client(opl3->card, opl3->seq_dev_num,
 					     name);
+#pragma GCC diagnostic pop
 	if (client < 0)
 		return client;
 
diff --git a/sound/firewire/digi00x/digi00x-midi.c b/sound/firewire/digi00x/digi00x-midi.c
index 68eb8c39afa6..70a51f1a3819 100644
--- a/sound/firewire/digi00x/digi00x-midi.c
+++ b/sound/firewire/digi00x/digi00x-midi.c
@@ -141,8 +141,11 @@ static int add_substream_pair(struct snd_dg00x *dg00x, unsigned int out_ports,
 		label = "%s control";
 	else
 		label = "%s MIDI";
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	snprintf(rmidi->name, sizeof(rmidi->name), label,
 		 dg00x->card->shortname);
+#pragma GCC diagnostic pop
 
 	snd_rawmidi_set_ops(rmidi, SNDRV_RAWMIDI_STREAM_OUTPUT, &playback_ops);
 	snd_rawmidi_set_ops(rmidi, SNDRV_RAWMIDI_STREAM_INPUT, &capture_ops);
diff --git a/sound/pci/korg1212/korg1212.c b/sound/pci/korg1212/korg1212.c
index 33b4f95d65b3..1f7719352f91 100644
--- a/sound/pci/korg1212/korg1212.c
+++ b/sound/pci/korg1212/korg1212.c
@@ -2052,7 +2052,10 @@ static void snd_korg1212_proc_read(struct snd_info_entry *entry,
 	int n;
 	struct snd_korg1212 *korg1212 = entry->private_data;
 
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	snd_iprintf(buffer, korg1212->card->longname);
+#pragma GCC diagnostic pop
 	snd_iprintf(buffer, " (index #%d)\n", korg1212->card->number + 1);
 	snd_iprintf(buffer, "\nGeneral settings\n");
 	snd_iprintf(buffer, "    period size: %zd bytes\n", K1212_PERIOD_BYTES);
diff --git a/sound/pci/rme32.c b/sound/pci/rme32.c
index 9c0ac025e143..542ac68f3a6a 100644
--- a/sound/pci/rme32.c
+++ b/sound/pci/rme32.c
@@ -1434,7 +1434,10 @@ snd_rme32_proc_read(struct snd_info_entry * entry, struct snd_info_buffer *buffe
 
 	rme32->rcreg = readl(rme32->iobase + RME32_IO_CONTROL_REGISTER);
 
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	snd_iprintf(buffer, rme32->card->longname);
+#pragma GCC diagnostic pop
 	snd_iprintf(buffer, " (index #%d)\n", rme32->card->number + 1);
 
 	snd_iprintf(buffer, "\nGeneral settings\n");
diff --git a/sound/pci/rme96.c b/sound/pci/rme96.c
index bccb7e0d3d11..6733150e7647 100644
--- a/sound/pci/rme96.c
+++ b/sound/pci/rme96.c
@@ -1719,7 +1719,10 @@ snd_rme96_proc_read(struct snd_info_entry *entry, struct snd_info_buffer *buffer
 	
 	rme96->rcreg = readl(rme96->iobase + RME96_IO_CONTROL_REGISTER);
 
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	snd_iprintf(buffer, rme96->card->longname);
+#pragma GCC diagnostic pop
 	snd_iprintf(buffer, " (index #%d)\n", rme96->card->number + 1);
 
 	snd_iprintf(buffer, "\nGeneral settings\n");
diff --git a/sound/soc/intel/avs/topology.c b/sound/soc/intel/avs/topology.c
index cdb4ec500261..e713f29fb154 100644
--- a/sound/soc/intel/avs/topology.c
+++ b/sound/soc/intel/avs/topology.c
@@ -385,8 +385,11 @@ static int parse_link_formatted_string(struct snd_soc_component *comp, void *ele
 	if (hweight_long(mach->mach_params.i2s_link_mask) != 1)
 		return avs_parse_string_token(comp, elem, object, offset);
 
+	__diag_push()
+	__diag_ignore(GCC, 4, "-Wformat-security", "tuple->string contains a format")
 	snprintf(val, SNDRV_CTL_ELEM_ID_NAME_MAXLEN, tuple->string,
 		 __ffs(mach->mach_params.i2s_link_mask));
+	__diag_pop()
 
 	return 0;
 }
@@ -1387,6 +1390,8 @@ static int avs_route_load(struct snd_soc_component *comp, int index,
 	if (hweight_long(mach->mach_params.i2s_link_mask) == 1) {
 		port = __ffs(mach->mach_params.i2s_link_mask);
 
+		__diag_push()
+		__diag_ignore(GCC, 4, "-Wformat-security", "route->source and route->sink contain a format")
 		snprintf(buf, len, route->source, port);
 		strncpy((char *)route->source, buf, len);
 		snprintf(buf, len, route->sink, port);
@@ -1395,6 +1400,7 @@ static int avs_route_load(struct snd_soc_component *comp, int index,
 			snprintf(buf, len, route->control, port);
 			strncpy((char *)route->control, buf, len);
 		}
+		__diag_pop()
 	}
 
 	return 0;
@@ -1424,7 +1430,10 @@ static int avs_widget_load(struct snd_soc_component *comp, int index,
 	if (hweight_long(mach->mach_params.i2s_link_mask) == 1) {
 		kfree(w->name);
 		/* w->name is freed later by soc_tplg_dapm_widget_create() */
+		__diag_push()
+		__diag_ignore(GCC, 4, "-Wformat-security", "dw->name contains a format")
 		w->name = kasprintf(GFP_KERNEL, dw->name, __ffs(mach->mach_params.i2s_link_mask));
+		__diag_pop()
 		if (!w->name)
 			return -ENOMEM;
 	}
diff --git a/sound/soc/intel/boards/sof_sdw.c b/sound/soc/intel/boards/sof_sdw.c
index 6faf4a43eaf5..51b9449633a1 100644
--- a/sound/soc/intel/boards/sof_sdw.c
+++ b/sound/soc/intel/boards/sof_sdw.c
@@ -1120,6 +1120,8 @@ static int create_sdw_dailink(struct snd_soc_card *card,
 			continue;
 
 		/* create stream name according to first link id */
+		__diag_push()
+		__diag_ignore(GCC, 4, "-Wformat-security", "The format is known")
 		if (append_codec_type) {
 			name = devm_kasprintf(dev, GFP_KERNEL,
 					      sdw_stream_name[stream + 2], cpu_dai_id[0],
@@ -1128,6 +1130,7 @@ static int create_sdw_dailink(struct snd_soc_card *card,
 			name = devm_kasprintf(dev, GFP_KERNEL,
 					      sdw_stream_name[stream], cpu_dai_id[0]);
 		}
+		__diag_pop()
 		if (!name)
 			return -ENOMEM;
 
diff --git a/sound/usb/midi.c b/sound/usb/midi.c
index 2839f6b6f09b..dc381a336671 100644
--- a/sound/usb/midi.c
+++ b/sound/usb/midi.c
@@ -1842,8 +1842,11 @@ static void snd_usbmidi_init_substream(struct snd_usb_midi *umidi,
 	port_info = find_port_info(umidi, number);
 	name_format = port_info ? port_info->name :
 		(jack_name != default_jack_name  ? "%s %s" : "%s %s %d");
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	snprintf(substream->name, sizeof(substream->name),
 		 name_format, umidi->card->shortname, jack_name, number + 1);
+#pragma GCC diagnostic pop
 
 	*rsubstream = substream;
 }
diff --git a/sound/usb/mixer_quirks.c b/sound/usb/mixer_quirks.c
index ab0d459f4271..9cd6d0642c1d 100644
--- a/sound/usb/mixer_quirks.c
+++ b/sound/usb/mixer_quirks.c
@@ -91,7 +91,10 @@ static int snd_create_std_mono_ctl_offset(struct usb_mixer_interface *mixer,
 	}
 
 	/* Set name */
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	snprintf(kctl->id.name, sizeof(kctl->id.name), name);
+#pragma GCC diagnostic pop
 	kctl->private_free = snd_usb_mixer_elem_free;
 
 	/* set TLV */
diff --git a/sound/usb/mixer_scarlett_gen2.c b/sound/usb/mixer_scarlett_gen2.c
index 9d11bb08667e..33c7c391e7c6 100644
--- a/sound/usb/mixer_scarlett_gen2.c
+++ b/sound/usb/mixer_scarlett_gen2.c
@@ -3367,8 +3367,11 @@ static int scarlett2_mux_src_enum_ctl_info(struct snd_kcontrol *kctl,
 			const struct scarlett2_port *port =
 				&scarlett2_ports[port_type];
 
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 			sprintf(uinfo->value.enumerated.name,
 				port->src_descr, item + port->src_num_offset);
+#pragma GCC diagnostic pop
 			return 0;
 		}
 		item -= port_count[port_type][SCARLETT2_PORT_IN];
@@ -3462,7 +3465,10 @@ static int scarlett2_add_mux_enums(struct usb_mixer_interface *mixer)
 			const char *const descr =
 				scarlett2_ports[port_type].dst_descr;
 
-			snprintf(s, sizeof(s) - 5, descr, channel + 1);
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
+			snprintf(s, sizeof(s) - 5, descr, channel + 1); /* BUG: off by one with " Enum", needs -6? */
+#pragma GCC diagnostic pop
 			strcat(s, " Enum");
 
 			err = scarlett2_add_new_ctl(mixer,
-- 
