From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: Nicolas Iooss <nicolas.iooss_linux@m4x.org>
Date: Wed, 18 Mar 2015 23:20:16 +0800
Subject: [PATCH] {PRAGMA} disable -Wformat-security where it is safe

---
 arch/x86/kernel/cpu/mcheck/mce.c                   |  3 +++
 arch/x86/kernel/cpu/mcheck/mce_amd.c               | 16 ++++++++++++++++
 arch/x86/kernel/e820.c                             |  4 ++++
 arch/x86/xen/smp.c                                 |  5 ++++-
 crypto/pcrypt.c                                    |  3 +++
 drivers/acpi/acpi_apd.c                            |  3 +++
 drivers/acpi/acpi_lpss.c                           |  3 +++
 drivers/base/power/sysfs.c                         |  3 +++
 drivers/block/aoe/aoechr.c                         |  6 +++++-
 drivers/cdrom/cdrom.c                              |  3 +++
 drivers/char/mem.c                                 |  3 +++
 drivers/gpu/drm/ttm/ttm_memory.c                   |  6 ++++++
 drivers/infiniband/hw/qib/qib_file_ops.c           |  4 ++++
 drivers/input/tablet/aiptek.c                      |  3 +++
 drivers/iommu/irq_remapping.c                      |  3 +++
 drivers/isdn/hisax/config.c                        |  3 +++
 drivers/isdn/hisax/hfc_pci.c                       |  3 +++
 drivers/isdn/hisax/hfc_sx.c                        |  3 +++
 drivers/isdn/hisax/q931.c                          |  9 +++++++++
 drivers/md/bcache/util.h                           | 22 ++++++++++++++++++++++
 drivers/media/pci/cx23885/cx23885-dvb.c            |  3 +++
 drivers/media/usb/cx231xx/cx231xx-dvb.c            |  6 ++++++
 drivers/media/usb/pvrusb2/pvrusb2-std.c            |  4 ++++
 drivers/misc/mic/scif/scif_main.c                  |  3 +++
 drivers/misc/mic/scif/scif_nodeqp.c                |  3 +++
 .../net/ethernet/hisilicon/hns/hns_dsaf_xgmac.c    |  4 ++++
 drivers/net/fddi/defxx.c                           |  3 +++
 drivers/net/hippi/rrunner.c                        |  3 +++
 drivers/net/macvtap.c                              |  4 ++++
 drivers/parport/share.c                            |  3 +++
 drivers/pnp/interface.c                            |  4 ++++
 drivers/staging/lustre/lustre/ptlrpc/pinger.c      |  4 ++++
 drivers/staging/most/mostcore/core.c               |  4 ++++
 drivers/staging/speakup/kobjects.c                 |  6 ++++++
 drivers/tty/serial/pch_uart.c                      |  3 +++
 fs/btrfs/check-integrity.c                         |  6 ++++++
 fs/reiserfs/prints.c                               |  4 ++--
 include/linux/kernel.h                             |  7 +++++--
 kernel/debug/kdb/kdb_io.c                          | 18 ++++++++++++++++++
 lib/test_printf.c                                  |  3 +++
 net/tipc/netlink_compat.c                          |  3 +++
 sound/core/seq/seq_clientmgr.c                     |  3 +++
 sound/drivers/opl3/opl3_seq.c                      |  3 +++
 sound/pci/korg1212/korg1212.c                      |  3 +++
 sound/pci/rme32.c                                  |  3 +++
 sound/pci/rme96.c                                  |  3 +++
 sound/usb/mixer_quirks.c                           |  3 +++
 47 files changed, 218 insertions(+), 6 deletions(-)

diff --git a/arch/x86/kernel/cpu/mcheck/mce.c b/arch/x86/kernel/cpu/mcheck/mce.c
index 00ef43233e03..a6de9c962662 100644
--- a/arch/x86/kernel/cpu/mcheck/mce.c
+++ b/arch/x86/kernel/cpu/mcheck/mce.c
@@ -412,7 +412,10 @@ static void mce_panic(const char *msg, struct mce *final, char *exp)
 	if (!fake_panic) {
 		if (panic_timeout == 0)
 			panic_timeout = mca_cfg.panic_timeout;
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 		panic(msg);
+#pragma GCC diagnostic pop
 	} else
 		pr_emerg(HW_ERR "Fake kernel panic: %s\n", msg);
 }
diff --git a/arch/x86/kernel/cpu/mcheck/mce_amd.c b/arch/x86/kernel/cpu/mcheck/mce_amd.c
index a5fd137417a2..695f9cf8b9d5 100644
--- a/arch/x86/kernel/cpu/mcheck/mce_amd.c
+++ b/arch/x86/kernel/cpu/mcheck/mce_amd.c
@@ -1122,9 +1122,13 @@ static int allocate_threshold_blocks(unsigned int cpu, unsigned int bank,
 		per_cpu(threshold_banks, cpu)[bank]->blocks = b;
 	}
 
+/* bank4_names(b) and th_names[bank] are well-defined constant string */
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	err = kobject_init_and_add(&b->kobj, &threshold_ktype,
 				   per_cpu(threshold_banks, cpu)[bank]->kobj,
 				   get_name(bank, b));
+#pragma GCC diagnostic pop
 	if (err)
 		goto out_free;
 recurse:
@@ -1157,13 +1161,21 @@ static int __threshold_add_blocks(struct threshold_bank *b)
 	struct threshold_block *tmp = NULL;
 	int err = 0;
 
+/* b->blocks->kobj.name comes from allocate_threshold_blocks */
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	err = kobject_add(&b->blocks->kobj, b->kobj, b->blocks->kobj.name);
+#pragma GCC diagnostic pop
 	if (err)
 		return err;
 
 	list_for_each_entry_safe(pos, tmp, head, miscj) {
 
+/* pos->kobj.name comes from allocate_threshold_blocks */
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 		err = kobject_add(&pos->kobj, b->kobj, pos->kobj.name);
+#pragma GCC diagnostic pop
 		if (err) {
 			list_for_each_entry_safe_reverse(pos, tmp, head, miscj)
 				kobject_del(&pos->kobj);
@@ -1192,7 +1204,11 @@ static int threshold_create_bank(unsigned int cpu, unsigned int bank)
 		if (nb && nb->bank4) {
 			/* yes, use it */
 			b = nb->bank4;
+/* name is a constant string */
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 			err = kobject_add(b->kobj, &dev->kobj, name);
+#pragma GCC diagnostic pop
 			if (err)
 				goto out;
 
diff --git a/arch/x86/kernel/e820.c b/arch/x86/kernel/e820.c
index 90e8dde3ec26..6161f0d70fe5 100644
--- a/arch/x86/kernel/e820.c
+++ b/arch/x86/kernel/e820.c
@@ -829,8 +829,12 @@ unsigned long __init e820_end_of_low_ram_pfn(void)
 
 static void __init early_panic(char *msg)
 {
+/* format is safe here */
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	early_printk(msg);
 	panic(msg);
+#pragma GCC diagnostic pop
 }
 
 static int userdef __initdata;
diff --git a/arch/x86/xen/smp.c b/arch/x86/xen/smp.c
index 311acad7dad2..669a26ce2d64 100644
--- a/arch/x86/xen/smp.c
+++ b/arch/x86/xen/smp.c
@@ -344,13 +344,16 @@ static void __init xen_smp_prepare_cpus(unsigned int max_cpus)
 	unsigned int i;
 
 	if (skip_ioapic_setup) {
-		char *m = (max_cpus == 0) ?
+		const char *m = (max_cpus == 0) ?
 			"The nosmp parameter is incompatible with Xen; " \
 			"use Xen dom0_max_vcpus=1 parameter" :
 			"The noapic parameter is incompatible with Xen";
 
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 		xen_raw_printk(m);
 		panic(m);
+#pragma GCC diagnostic pop
 	}
 	xen_init_lock_cpu(0);
 
diff --git a/crypto/pcrypt.c b/crypto/pcrypt.c
index ee9cfb99fe25..32b30972d32a 100644
--- a/crypto/pcrypt.c
+++ b/crypto/pcrypt.c
@@ -392,7 +392,10 @@ static int pcrypt_sysfs_add(struct padata_instance *pinst, const char *name)
 	int ret;
 
 	pinst->kobj.kset = pcrypt_kset;
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	ret = kobject_add(&pinst->kobj, NULL, name);
+#pragma GCC diagnostic pop
 	if (!ret)
 		kobject_uevent(&pinst->kobj, KOBJ_ADD);
 
diff --git a/drivers/acpi/acpi_apd.c b/drivers/acpi/acpi_apd.c
index 26696b693e63..e6e5827038e2 100644
--- a/drivers/acpi/acpi_apd.c
+++ b/drivers/acpi/acpi_apd.c
@@ -64,7 +64,10 @@ static int acpi_apd_setup(struct apd_private_data *pdata)
 		clk = clk_register_fixed_rate(&pdata->adev->dev,
 					dev_name(&pdata->adev->dev),
 					NULL, 0, dev_desc->fixed_clk_rate);
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 		clk_register_clkdev(clk, NULL, dev_name(&pdata->adev->dev));
+#pragma GCC diagnostic pop
 		pdata->clk = clk;
 	}
 
diff --git a/drivers/acpi/acpi_lpss.c b/drivers/acpi/acpi_lpss.c
index 8ea836c046f8..6f1694563ba6 100644
--- a/drivers/acpi/acpi_lpss.c
+++ b/drivers/acpi/acpi_lpss.c
@@ -379,7 +379,10 @@ static int register_device_clock(struct acpi_device *adev,
 		return PTR_ERR(clk);
 
 	pdata->clk = clk;
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	clk_register_clkdev(clk, dev_desc->clk_con_id, devname);
+#pragma GCC diagnostic pop
 	return 0;
 }
 
diff --git a/drivers/base/power/sysfs.c b/drivers/base/power/sysfs.c
index 33b4b902741a..9f8dd96dbd29 100644
--- a/drivers/base/power/sysfs.c
+++ b/drivers/base/power/sysfs.c
@@ -181,7 +181,10 @@ static ssize_t rtpm_status_show(struct device *dev,
 			return -EIO;
 		}
 	}
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	return sprintf(buf, p);
+#pragma GCC diagnostic pop
 }
 
 static DEVICE_ATTR(runtime_status, 0444, rtpm_status_show, NULL);
diff --git a/drivers/block/aoe/aoechr.c b/drivers/block/aoe/aoechr.c
index ab41be625a53..ece88bcd2e00 100644
--- a/drivers/block/aoe/aoechr.c
+++ b/drivers/block/aoe/aoechr.c
@@ -299,10 +299,14 @@ aoechr_init(void)
 	}
 	aoe_class->devnode = aoe_devnode;
 
-	for (i = 0; i < ARRAY_SIZE(chardevs); ++i)
+	for (i = 0; i < ARRAY_SIZE(chardevs); ++i) {
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 		device_create(aoe_class, NULL,
 			      MKDEV(AOE_MAJOR, chardevs[i].minor), NULL,
 			      chardevs[i].name);
+#pragma GCC diagnostic pop
+	}
 
 	return 0;
 }
diff --git a/drivers/cdrom/cdrom.c b/drivers/cdrom/cdrom.c
index 59cca72647a6..66f03256cf02 100644
--- a/drivers/cdrom/cdrom.c
+++ b/drivers/cdrom/cdrom.c
@@ -3441,7 +3441,10 @@ static int cdrom_print_info(const char *header, int val, char *info,
 	struct cdrom_device_info *cdi;
 	int ret;
 
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	ret = scnprintf(info + *pos, max_size - *pos, header);
+#pragma GCC diagnostic pop
 	if (!ret)
 		return 1;
 
diff --git a/drivers/char/mem.c b/drivers/char/mem.c
index 5bb1985ec484..cc74d75ab5a8 100644
--- a/drivers/char/mem.c
+++ b/drivers/char/mem.c
@@ -888,8 +888,11 @@ static int __init chr_dev_init(void)
 		if ((minor == DEVPORT_MINOR) && !arch_has_dev_port())
 			continue;
 
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 		device_create(mem_class, NULL, MKDEV(MEM_MAJOR, minor),
 			      NULL, devlist[minor].name);
+#pragma GCC diagnostic pop
 	}
 
 	return tty_init();
diff --git a/drivers/gpu/drm/ttm/ttm_memory.c b/drivers/gpu/drm/ttm/ttm_memory.c
index 29855be96be0..62b8131e084a 100644
--- a/drivers/gpu/drm/ttm/ttm_memory.c
+++ b/drivers/gpu/drm/ttm/ttm_memory.c
@@ -263,8 +263,11 @@ static int ttm_mem_init_kernel_zone(struct ttm_mem_global *glob,
 	zone->used_mem = 0;
 	zone->glob = glob;
 	glob->zone_kernel = zone;
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	ret = kobject_init_and_add(
 		&zone->kobj, &ttm_mem_zone_kobj_type, &glob->kobj, zone->name);
+#pragma GCC diagnostic pop
 	if (unlikely(ret != 0)) {
 		kobject_put(&zone->kobj);
 		return ret;
@@ -347,8 +350,11 @@ static int ttm_mem_init_dma32_zone(struct ttm_mem_global *glob,
 	zone->used_mem = 0;
 	zone->glob = glob;
 	glob->zone_dma32 = zone;
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	ret = kobject_init_and_add(
 		&zone->kobj, &ttm_mem_zone_kobj_type, &glob->kobj, zone->name);
+#pragma GCC diagnostic pop
 	if (unlikely(ret != 0)) {
 		kobject_put(&zone->kobj);
 		return ret;
diff --git a/drivers/infiniband/hw/qib/qib_file_ops.c b/drivers/infiniband/hw/qib/qib_file_ops.c
index 2d1eacf1dfed..3eb847581f6d 100644
--- a/drivers/infiniband/hw/qib/qib_file_ops.c
+++ b/drivers/infiniband/hw/qib/qib_file_ops.c
@@ -2298,7 +2298,11 @@ int qib_cdev_init(int minor, const char *name,
 
 	cdev->owner = THIS_MODULE;
 	cdev->ops = fops;
+/* All callers use semi-constants strings for name */
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	kobject_set_name(&cdev->kobj, name);
+#pragma GCC diagnostic pop
 
 	ret = cdev_add(cdev, dev, 1);
 	if (ret < 0) {
diff --git a/drivers/input/tablet/aiptek.c b/drivers/input/tablet/aiptek.c
index d67547bded3e..ff1d5df2e384 100644
--- a/drivers/input/tablet/aiptek.c
+++ b/drivers/input/tablet/aiptek.c
@@ -1375,7 +1375,10 @@ static ssize_t show_tabletDiagnosticMessage(struct device *dev, struct device_at
 	default:
 		return 0;
 	}
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	return snprintf(buf, PAGE_SIZE, retMsg);
+#pragma GCC diagnostic pop
 }
 
 static DEVICE_ATTR(diagnostic, S_IRUGO, show_tabletDiagnosticMessage, NULL);
diff --git a/drivers/iommu/irq_remapping.c b/drivers/iommu/irq_remapping.c
index 49721b4e1975..f6f9b0c9bb91 100644
--- a/drivers/iommu/irq_remapping.c
+++ b/drivers/iommu/irq_remapping.c
@@ -153,7 +153,10 @@ int __init irq_remap_enable_fault_handling(void)
 void panic_if_irq_remap(const char *msg)
 {
 	if (irq_remapping_enabled)
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 		panic(msg);
+#pragma GCC diagnostic pop
 }
 
 void ir_ack_apic_edge(struct irq_data *data)
diff --git a/drivers/isdn/hisax/config.c b/drivers/isdn/hisax/config.c
index 2d12c6ceeb89..53a86c335e6d 100644
--- a/drivers/isdn/hisax/config.c
+++ b/drivers/isdn/hisax/config.c
@@ -1896,7 +1896,10 @@ static void EChannel_proc_rcv(struct hisax_d_if *d_if)
 				ptr--;
 				*ptr++ = '\n';
 				*ptr = 0;
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 				HiSax_putstatus(cs, NULL, cs->dlog);
+#pragma GCC diagnostic pop
 			} else
 				HiSax_putstatus(cs, "LogEcho: ",
 						"warning Frame too big (%d)",
diff --git a/drivers/isdn/hisax/hfc_pci.c b/drivers/isdn/hisax/hfc_pci.c
index 90449e1e91e5..1fd599003780 100644
--- a/drivers/isdn/hisax/hfc_pci.c
+++ b/drivers/isdn/hisax/hfc_pci.c
@@ -901,7 +901,10 @@ receive_emsg(struct IsdnCardState *cs)
 					ptr--;
 					*ptr++ = '\n';
 					*ptr = 0;
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 					HiSax_putstatus(cs, NULL, cs->dlog);
+#pragma GCC diagnostic pop
 				} else
 					HiSax_putstatus(cs, "LogEcho: ", "warning Frame too big (%d)", total - 3);
 			}
diff --git a/drivers/isdn/hisax/hfc_sx.c b/drivers/isdn/hisax/hfc_sx.c
index 13b2151c10f5..881dccab1315 100644
--- a/drivers/isdn/hisax/hfc_sx.c
+++ b/drivers/isdn/hisax/hfc_sx.c
@@ -674,7 +674,10 @@ receive_emsg(struct IsdnCardState *cs)
 					ptr--;
 					*ptr++ = '\n';
 					*ptr = 0;
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 					HiSax_putstatus(cs, NULL, cs->dlog);
+#pragma GCC diagnostic pop
 				} else
 					HiSax_putstatus(cs, "LogEcho: ", "warning Frame too big (%d)", skb->len);
 			}
diff --git a/drivers/isdn/hisax/q931.c b/drivers/isdn/hisax/q931.c
index 298c8dba0321..4fa97f8faa48 100644
--- a/drivers/isdn/hisax/q931.c
+++ b/drivers/isdn/hisax/q931.c
@@ -1179,7 +1179,10 @@ LogFrame(struct IsdnCardState *cs, u_char *buf, int size)
 		dp--;
 		*dp++ = '\n';
 		*dp = 0;
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 		HiSax_putstatus(cs, NULL, cs->dlog);
+#pragma GCC diagnostic pop
 	} else
 		HiSax_putstatus(cs, "LogFrame: ", "warning Frame too big (%d)", size);
 }
@@ -1246,7 +1249,10 @@ dlogframe(struct IsdnCardState *cs, struct sk_buff *skb, int dir)
 	}
 	if (finish) {
 		*dp = 0;
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 		HiSax_putstatus(cs, NULL, cs->dlog);
+#pragma GCC diagnostic pop
 		return;
 	}
 	if ((0xfe & buf[0]) == PROTO_DIS_N0) {	/* 1TR6 */
@@ -1509,5 +1515,8 @@ dlogframe(struct IsdnCardState *cs, struct sk_buff *skb, int dir)
 		dp += sprintf(dp, "Unknown protocol %x!", buf[0]);
 	}
 	*dp = 0;
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	HiSax_putstatus(cs, NULL, cs->dlog);
+#pragma GCC diagnostic pop
 }
diff --git a/drivers/md/bcache/util.h b/drivers/md/bcache/util.h
index eedfe339d057..bc829c233126 100644
--- a/drivers/md/bcache/util.h
+++ b/drivers/md/bcache/util.h
@@ -348,6 +348,27 @@ static inline int bch_strtoul_h(const char *cp, long *res)
 	_r;								\
 })
 
+#ifdef __clang__
+#define snprint(buf, size, var)						\
+_Pragma("GCC diagnostic push") \
+_Pragma("GCC diagnostic ignored \"-Wformat\"") \
+	snprintf(buf, size,						\
+		__builtin_types_compatible_p(typeof(var), int)		\
+		     ? "%i\n" :						\
+		__builtin_types_compatible_p(typeof(var), unsigned)	\
+		     ? "%u\n" :						\
+		__builtin_types_compatible_p(typeof(var), long)		\
+		     ? "%li\n" :					\
+		__builtin_types_compatible_p(typeof(var), unsigned long)\
+		     ? "%lu\n" :					\
+		__builtin_types_compatible_p(typeof(var), int64_t)	\
+		     ? "%lli\n" :					\
+		__builtin_types_compatible_p(typeof(var), uint64_t)	\
+		     ? "%llu\n" :					\
+		__builtin_types_compatible_p(typeof(var), const char *)	\
+		     ? "%s\n" : "%i\n", var) \
+_Pragma("GCC diagnostic pop")
+#else
 #define snprint(buf, size, var)						\
 	snprintf(buf, size,						\
 		__builtin_types_compatible_p(typeof(var), int)		\
@@ -364,6 +385,7 @@ static inline int bch_strtoul_h(const char *cp, long *res)
 		     ? "%llu\n" :					\
 		__builtin_types_compatible_p(typeof(var), const char *)	\
 		     ? "%s\n" : "%i\n", var)
+#endif
 
 ssize_t bch_hprint(char *buf, int64_t v);
 
diff --git a/drivers/media/pci/cx23885/cx23885-dvb.c b/drivers/media/pci/cx23885/cx23885-dvb.c
index 589a168d1df4..fe668e21c132 100644
--- a/drivers/media/pci/cx23885/cx23885-dvb.c
+++ b/drivers/media/pci/cx23885/cx23885-dvb.c
@@ -1871,7 +1871,10 @@ static int dvb_register(struct cx23885_tsport *port)
 			strlcpy(info.type, "si2165", I2C_NAME_SIZE);
 			info.addr = 0x64;
 			info.platform_data = &si2165_pdata;
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 			request_module(info.type);
+#pragma GCC diagnostic pop
 			client_demod = i2c_new_device(&i2c_bus->i2c_adap, &info);
 			if (client_demod == NULL ||
 					client_demod->dev.driver == NULL)
diff --git a/drivers/media/usb/cx231xx/cx231xx-dvb.c b/drivers/media/usb/cx231xx/cx231xx-dvb.c
index 2868546999ca..ba8a88e385ff 100644
--- a/drivers/media/usb/cx231xx/cx231xx-dvb.c
+++ b/drivers/media/usb/cx231xx/cx231xx-dvb.c
@@ -759,7 +759,10 @@ static int dvb_init(struct cx231xx *dev)
 		strlcpy(info.type, "si2165", I2C_NAME_SIZE);
 		info.addr = 0x64;
 		info.platform_data = &si2165_pdata;
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 		request_module(info.type);
+#pragma GCC diagnostic pop
 		client = i2c_new_device(demod_i2c, &info);
 		if (client == NULL || client->dev.driver == NULL || dev->dvb->frontend == NULL) {
 			dev_err(dev->dev,
@@ -806,7 +809,10 @@ static int dvb_init(struct cx231xx *dev)
 		strlcpy(info.type, "si2165", I2C_NAME_SIZE);
 		info.addr = 0x64;
 		info.platform_data = &si2165_pdata;
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 		request_module(info.type);
+#pragma GCC diagnostic pop
 		client = i2c_new_device(demod_i2c, &info);
 		if (client == NULL || client->dev.driver == NULL || dev->dvb->frontend == NULL) {
 			dev_err(dev->dev,
diff --git a/drivers/media/usb/pvrusb2/pvrusb2-std.c b/drivers/media/usb/pvrusb2/pvrusb2-std.c
index cd7bc18a1ba2..9c067378d64e 100644
--- a/drivers/media/usb/pvrusb2/pvrusb2-std.c
+++ b/drivers/media/usb/pvrusb2/pvrusb2-std.c
@@ -215,8 +215,12 @@ unsigned int pvr2_std_id_to_str(char *bufPtr, unsigned int bufSize,
 			c1 += c2;
 			bufSize -= c2;
 			bufPtr += c2;
+/* ip->name are constants strings from the top of this file */
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 			c2 = scnprintf(bufPtr,bufSize,
 				       ip->name);
+#pragma GCC diagnostic pop
 			c1 += c2;
 			bufSize -= c2;
 			bufPtr += c2;
diff --git a/drivers/misc/mic/scif/scif_main.c b/drivers/misc/mic/scif/scif_main.c
index 36d847af1209..3ac4dac56cca 100644
--- a/drivers/misc/mic/scif/scif_main.c
+++ b/drivers/misc/mic/scif/scif_main.c
@@ -54,8 +54,11 @@ int scif_setup_intr_wq(struct scif_dev *scifdev)
 	if (!scifdev->intr_wq) {
 		snprintf(scifdev->intr_wqname, sizeof(scifdev->intr_wqname),
 			 "SCIF INTR %d", scifdev->node);
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 		scifdev->intr_wq =
 			alloc_ordered_workqueue(scifdev->intr_wqname, 0);
+#pragma GCC diagnostic pop
 		if (!scifdev->intr_wq)
 			return -ENOMEM;
 		INIT_WORK(&scifdev->intr_bh, scif_intr_bh_handler);
diff --git a/drivers/misc/mic/scif/scif_nodeqp.c b/drivers/misc/mic/scif/scif_nodeqp.c
index c66ca1a5814e..845819ce0b0e 100644
--- a/drivers/misc/mic/scif/scif_nodeqp.c
+++ b/drivers/misc/mic/scif/scif_nodeqp.c
@@ -1234,8 +1234,11 @@ int scif_setup_loopback_qp(struct scif_dev *scifdev)
 	INIT_LIST_HEAD(&scif_info.loopb_recv_q);
 	snprintf(scif_info.loopb_wqname, sizeof(scif_info.loopb_wqname),
 		 "SCIF LOOPB %d", scifdev->node);
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	scif_info.loopb_wq =
 		alloc_ordered_workqueue(scif_info.loopb_wqname, 0);
+#pragma GCC diagnostic pop
 	if (!scif_info.loopb_wq) {
 		err = -ENOMEM;
 		goto destroy_intr;
diff --git a/drivers/net/ethernet/hisilicon/hns/hns_dsaf_xgmac.c b/drivers/net/ethernet/hisilicon/hns/hns_dsaf_xgmac.c
index aae830a93050..65f0ff236214 100644
--- a/drivers/net/ethernet/hisilicon/hns/hns_dsaf_xgmac.c
+++ b/drivers/net/ethernet/hisilicon/hns/hns_dsaf_xgmac.c
@@ -781,7 +781,11 @@ static void hns_xgmac_get_strings(u32 stringset, u8 *data)
 		return;
 
 	for (i = 0; i < ARRAY_SIZE(g_xgmac_stats_string); i++) {
+/* g_xgmac_stats_string is a constant array */
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 		snprintf(buff, ETH_GSTRING_LEN, g_xgmac_stats_string[i].desc);
+#pragma GCC diagnostic pop
 		buff = buff + ETH_GSTRING_LEN;
 	}
 }
diff --git a/drivers/net/fddi/defxx.c b/drivers/net/fddi/defxx.c
index b0de8ecd7fe8..3359e4b12819 100644
--- a/drivers/net/fddi/defxx.c
+++ b/drivers/net/fddi/defxx.c
@@ -541,7 +541,10 @@ static int dfx_register(struct device *bdev)
 
 	if (!version_disp) {	/* display version info if adapter is found */
 		version_disp = 1;	/* set display flag to TRUE so that */
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 		printk(version);	/* we only display this string ONCE */
+#pragma GCC diagnostic pop
 	}
 
 	dev = alloc_fddidev(sizeof(*bp));
diff --git a/drivers/net/hippi/rrunner.c b/drivers/net/hippi/rrunner.c
index dd7fc6659ad4..9139e6ea92c0 100644
--- a/drivers/net/hippi/rrunner.c
+++ b/drivers/net/hippi/rrunner.c
@@ -127,7 +127,10 @@ static int rr_init_one(struct pci_dev *pdev, const struct pci_device_id *ent)
 		/* set display flag to TRUE so that */
 		/* we only display this string ONCE */
 		version_disp = 1;
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 		printk(version);
+#pragma GCC diagnostic pop
 	}
 
 	pci_read_config_byte(pdev, PCI_LATENCY_TIMER, &pci_latency);
diff --git a/drivers/net/macvtap.c b/drivers/net/macvtap.c
index e0f708b045df..812382cb8322 100644
--- a/drivers/net/macvtap.c
+++ b/drivers/net/macvtap.c
@@ -1284,8 +1284,12 @@ static int macvtap_device_event(struct notifier_block *unused,
 			return notifier_from_errno(err);
 
 		devt = MKDEV(MAJOR(macvtap_major), vlan->minor);
+/* tap_name is under full control ("tap%d") */
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 		classdev = device_create(&macvtap_class, &dev->dev, devt,
 					 dev, tap_name);
+#pragma GCC diagnostic pop
 		if (IS_ERR(classdev)) {
 			macvtap_free_minor(vlan);
 			return notifier_from_errno(PTR_ERR(classdev));
diff --git a/drivers/parport/share.c b/drivers/parport/share.c
index 3308427ed9f7..5c5dead343ec 100644
--- a/drivers/parport/share.c
+++ b/drivers/parport/share.c
@@ -493,7 +493,10 @@ struct parport *parport_register_port(unsigned long base, int irq, int dma,
 	tmp->name = name;
 	tmp->bus_dev.bus = &parport_bus_type;
 	tmp->bus_dev.release = free_port;
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	dev_set_name(&tmp->bus_dev, name);
+#pragma GCC diagnostic pop
 	tmp->bus_dev.type = &parport_device_type;
 
 	for (device = 0; device < 5; device++)
diff --git a/drivers/pnp/interface.c b/drivers/pnp/interface.c
index 4509dd039921..8657bbed0ca4 100644
--- a/drivers/pnp/interface.c
+++ b/drivers/pnp/interface.c
@@ -268,7 +268,11 @@ static ssize_t resources_show(struct device *dmdev,
 	list_for_each_entry(pnp_res, &dev->resources, list) {
 		res = &pnp_res->res;
 
+/* pnp_resource_type_name returns constant strings */
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 		pnp_printf(buffer, pnp_resource_type_name(res));
+#pragma GCC diagnostic pop
 
 		if (res->flags & IORESOURCE_DISABLED) {
 			pnp_printf(buffer, " disabled\n");
diff --git a/drivers/staging/lustre/lustre/ptlrpc/pinger.c b/drivers/staging/lustre/lustre/ptlrpc/pinger.c
index 5504fc2363ac..1ca24e60e186 100644
--- a/drivers/staging/lustre/lustre/ptlrpc/pinger.c
+++ b/drivers/staging/lustre/lustre/ptlrpc/pinger.c
@@ -302,8 +302,12 @@ int ptlrpc_start_pinger(void)
 
 	strcpy(pinger_thread.t_name, "ll_ping");
 
+/* Even though there may be a race in pinger_thread.t_name usage, the format string is safe */
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	task = kthread_run(ptlrpc_pinger_main, &pinger_thread,
 			   pinger_thread.t_name);
+#pragma GCC diagnostic pop
 	if (IS_ERR(task)) {
 		rc = PTR_ERR(task);
 		CERROR("cannot start pinger thread: rc = %d\n", rc);
diff --git a/drivers/staging/most/mostcore/core.c b/drivers/staging/most/mostcore/core.c
index 191404bc5906..57ceeff38446 100644
--- a/drivers/staging/most/mostcore/core.c
+++ b/drivers/staging/most/mostcore/core.c
@@ -429,7 +429,11 @@ static ssize_t show_set_datatype(struct most_c_obj *c,
 
 	for (i = 0; i < ARRAY_SIZE(ch_data_type); i++) {
 		if (c->cfg.data_type & ch_data_type[i].most_ch_data_type)
+/* ch_data_type is a const global variable with string literals */
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 			return snprintf(buf, PAGE_SIZE, ch_data_type[i].name);
+#pragma GCC diagnostic pop
 	}
 	return snprintf(buf, PAGE_SIZE, "unconfigured\n");
 }
diff --git a/drivers/staging/speakup/kobjects.c b/drivers/staging/speakup/kobjects.c
index e744aa9730ff..e9c78d1950a1 100644
--- a/drivers/staging/speakup/kobjects.c
+++ b/drivers/staging/speakup/kobjects.c
@@ -98,7 +98,10 @@ static void report_char_chartab_status(int reset, int received, int used,
 			snprintf(buf + (len - 1), sizeof(buf) - (len - 1),
 				 " with %d reject%s\n",
 				 rejected, rejected > 1 ? "s" : "");
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 		printk(buf);
+#pragma GCC diagnostic pop
 	}
 }
 
@@ -738,7 +741,10 @@ static void report_msg_status(int reset, int received, int used,
 			snprintf(buf + (len - 1), sizeof(buf) - (len - 1),
 				 " with %d reject%s\n",
 				 rejected, rejected > 1 ? "s" : "");
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 		printk(buf);
+#pragma GCC diagnostic pop
 	}
 }
 
diff --git a/drivers/tty/serial/pch_uart.c b/drivers/tty/serial/pch_uart.c
index 42caccb5e87e..40f7356d27d0 100644
--- a/drivers/tty/serial/pch_uart.c
+++ b/drivers/tty/serial/pch_uart.c
@@ -1093,7 +1093,10 @@ static void pch_uart_err_ir(struct eg20t_port *priv, unsigned int lsr)
 
 	if (tty == NULL) {
 		for (i = 0; error_msg[i] != NULL; i++)
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 			dev_err(&priv->pdev->dev, error_msg[i]);
+#pragma GCC diagnostic pop
 	} else {
 		tty_kref_put(tty);
 	}
diff --git a/fs/btrfs/check-integrity.c b/fs/btrfs/check-integrity.c
index ab14c2e635ca..853b7fa433e0 100644
--- a/fs/btrfs/check-integrity.c
+++ b/fs/btrfs/check-integrity.c
@@ -2561,7 +2561,10 @@ static void btrfsic_dump_tree_sub(const struct btrfsic_state *state,
 		printk("[...]\n");
 		return;
 	}
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	printk(buf);
+#pragma GCC diagnostic pop
 	indent_level += indent_add;
 	if (list_empty(&block->ref_to_list)) {
 		printk("\n");
@@ -2590,7 +2593,10 @@ static void btrfsic_dump_tree_sub(const struct btrfsic_state *state,
 			continue;
 		}
 
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 		printk(buf);
+#pragma GCC diagnostic pop
 
 		btrfsic_dump_tree_sub(state, l->block_ref_to,
 				      indent_level + indent_add);
diff --git a/fs/reiserfs/prints.c b/fs/reiserfs/prints.c
index 42d82f436cdd..5ee76629b048 100644
--- a/fs/reiserfs/prints.c
+++ b/fs/reiserfs/prints.c
@@ -289,7 +289,7 @@ void reiserfs_info(struct super_block *sb, const char *fmt, ...)
 static __printf(1, 2) void reiserfs_printk(const char *fmt, ...)
 {
 	do_reiserfs_warning(fmt);
-	printk(error_buf);
+	printk("%s", error_buf);
 }
 
 void reiserfs_debug(struct super_block *s, int level, const char *fmt, ...)
@@ -377,7 +377,7 @@ void __reiserfs_error(struct super_block *sb, const char *id,
 	BUG_ON(sb == NULL);
 
 	if (reiserfs_error_panic(sb))
-		__reiserfs_panic(sb, id, function, error_buf);
+		__reiserfs_panic(sb, id, function, "%s", error_buf);
 
 	if (id && id[0])
 		printk(KERN_CRIT "REISERFS error (device %s): %s %s: %s\n",
diff --git a/include/linux/kernel.h b/include/linux/kernel.h
index 56aec84237ad..c12ea3c8d6e6 100644
--- a/include/linux/kernel.h
+++ b/include/linux/kernel.h
@@ -642,9 +642,12 @@ do {									\
 									\
 	__trace_printk_check_format(fmt, ##args);			\
 									\
-	if (__builtin_constant_p(fmt))					\
+	if (__builtin_constant_p(fmt)) {					\
+_Pragma("GCC diagnostic push") \
+_Pragma("GCC diagnostic ignored \"-Wformat-security\"") \
 		__trace_bprintk(_THIS_IP_, trace_printk_fmt, ##args);	\
-	else								\
+_Pragma("GCC diagnostic pop") \
+	} else								\
 		__trace_printk(_THIS_IP_, fmt, ##args);			\
 } while (0)
 
diff --git a/kernel/debug/kdb/kdb_io.c b/kernel/debug/kdb/kdb_io.c
index e74be38245ad..3ca45bfe3496 100644
--- a/kernel/debug/kdb/kdb_io.c
+++ b/kernel/debug/kdb/kdb_io.c
@@ -250,7 +250,10 @@ static char *kdb_read(char *buffer, size_t bufsize)
 			kdb_printf("\b%s \r", cp);
 			tmp = *cp;
 			*cp = '\0';
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 			kdb_printf(kdb_prompt_str);
+#pragma GCC diagnostic pop
 			kdb_printf("%s", buffer);
 			*cp = tmp;
 		}
@@ -272,7 +275,10 @@ static char *kdb_read(char *buffer, size_t bufsize)
 			kdb_printf("%s \r", cp);
 			tmp = *cp;
 			*cp = '\0';
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 			kdb_printf(kdb_prompt_str);
+#pragma GCC diagnostic pop
 			kdb_printf("%s", buffer);
 			*cp = tmp;
 		}
@@ -280,7 +286,10 @@ static char *kdb_read(char *buffer, size_t bufsize)
 	case 1: /* Home */
 		if (cp > buffer) {
 			kdb_printf("\r");
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 			kdb_printf(kdb_prompt_str);
+#pragma GCC diagnostic pop
 			cp = buffer;
 		}
 		break;
@@ -358,7 +367,10 @@ static char *kdb_read(char *buffer, size_t bufsize)
 			if (i >= dtab_count)
 				kdb_printf("...");
 			kdb_printf("\n");
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 			kdb_printf(kdb_prompt_str);
+#pragma GCC diagnostic pop
 			kdb_printf("%s", buffer);
 		} else if (tab != 2 && count > 0) {
 			len_tmp = strlen(p_tmp);
@@ -383,7 +395,10 @@ static char *kdb_read(char *buffer, size_t bufsize)
 				++cp;
 				tmp = *cp;
 				*cp = '\0';
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 				kdb_printf(kdb_prompt_str);
+#pragma GCC diagnostic pop
 				kdb_printf("%s", buffer);
 				*cp = tmp;
 			} else {
@@ -444,7 +459,10 @@ char *kdb_getstr(char *buffer, size_t bufsize, const char *prompt)
 {
 	if (prompt && kdb_prompt_str != prompt)
 		strncpy(kdb_prompt_str, prompt, CMD_BUFLEN);
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	kdb_printf(kdb_prompt_str);
+#pragma GCC diagnostic pop
 	kdb_nextline = 1;	/* Prompt and input resets line number */
 	return kdb_read(buffer, bufsize);
 }
diff --git a/lib/test_printf.c b/lib/test_printf.c
index fe7087bdeb54..6d87504c6acc 100644
--- a/lib/test_printf.c
+++ b/lib/test_printf.c
@@ -152,7 +152,10 @@ test_basic(void)
 	/* Work around annoying "warning: zero-length gnu_printf format string". */
 	const char nul = '\0';
 
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	test("", &nul);
+#pragma GCC diagnostic pop
 	test("100%", "100%%");
 	test("xxx%yyy", "xxx%cyyy", '%');
 	__test("xxx\0yyy", 7, "xxx%cyyy", '\0');
diff --git a/net/tipc/netlink_compat.c b/net/tipc/netlink_compat.c
index 30f028c811fe..7a0531ef93ff 100644
--- a/net/tipc/netlink_compat.c
+++ b/net/tipc/netlink_compat.c
@@ -773,7 +773,10 @@ static int tipc_nl_compat_name_table_dump_header(struct tipc_nl_compat_msg *msg)
 	if (depth > 4)
 		depth = 4;
 	for (i = 0; i < depth; i++)
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 		tipc_tlv_sprintf(msg->rep, header[i]);
+#pragma GCC diagnostic pop
 	tipc_tlv_sprintf(msg->rep, "\n");
 
 	return 0;
diff --git a/sound/core/seq/seq_clientmgr.c b/sound/core/seq/seq_clientmgr.c
index 4c935202ce23..fe6dffa9a9a6 100644
--- a/sound/core/seq/seq_clientmgr.c
+++ b/sound/core/seq/seq_clientmgr.c
@@ -2393,7 +2393,10 @@ static void snd_seq_info_dump_subscribers(struct snd_info_buffer *buffer,
 		up_read(&group->list_mutex);
 		return;
 	}
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	snd_iprintf(buffer, msg);
+#pragma GCC diagnostic pop
 	list_for_each(p, &group->list_head) {
 		if (is_src)
 			s = list_entry(p, struct snd_seq_subscribers, src_list);
diff --git a/sound/drivers/opl3/opl3_seq.c b/sound/drivers/opl3/opl3_seq.c
index fdae5d7f421f..cb8a46fab811 100644
--- a/sound/drivers/opl3/opl3_seq.c
+++ b/sound/drivers/opl3/opl3_seq.c
@@ -235,9 +235,12 @@ static int snd_opl3_seq_probe(struct device *_dev)
 	/* allocate new client */
 	opl_ver = (opl3->hardware & OPL3_HW_MASK) >> 8;
 	sprintf(name, "OPL%i FM synth", opl_ver);
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	client = opl3->seq_client =
 		snd_seq_create_kernel_client(opl3->card, opl3->seq_dev_num,
 					     name);
+#pragma GCC diagnostic pop
 	if (client < 0)
 		return client;
 
diff --git a/sound/pci/korg1212/korg1212.c b/sound/pci/korg1212/korg1212.c
index 565f7f55c3ca..688fdacce40e 100644
--- a/sound/pci/korg1212/korg1212.c
+++ b/sound/pci/korg1212/korg1212.c
@@ -2048,7 +2048,10 @@ static void snd_korg1212_proc_read(struct snd_info_entry *entry,
 	int n;
 	struct snd_korg1212 *korg1212 = entry->private_data;
 
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	snd_iprintf(buffer, korg1212->card->longname);
+#pragma GCC diagnostic pop
 	snd_iprintf(buffer, " (index #%d)\n", korg1212->card->number + 1);
 	snd_iprintf(buffer, "\nGeneral settings\n");
 	snd_iprintf(buffer, "    period size: %Zd bytes\n", K1212_PERIOD_BYTES);
diff --git a/sound/pci/rme32.c b/sound/pci/rme32.c
index 96d15db65dfd..d7c2f80b7804 100644
--- a/sound/pci/rme32.c
+++ b/sound/pci/rme32.c
@@ -1467,7 +1467,10 @@ snd_rme32_proc_read(struct snd_info_entry * entry, struct snd_info_buffer *buffe
 
 	rme32->rcreg = readl(rme32->iobase + RME32_IO_CONTROL_REGISTER);
 
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	snd_iprintf(buffer, rme32->card->longname);
+#pragma GCC diagnostic pop
 	snd_iprintf(buffer, " (index #%d)\n", rme32->card->number + 1);
 
 	snd_iprintf(buffer, "\nGeneral settings\n");
diff --git a/sound/pci/rme96.c b/sound/pci/rme96.c
index 05b9da30990d..bdb7382965f8 100644
--- a/sound/pci/rme96.c
+++ b/sound/pci/rme96.c
@@ -1727,7 +1727,10 @@ snd_rme96_proc_read(struct snd_info_entry *entry, struct snd_info_buffer *buffer
 	
 	rme96->rcreg = readl(rme96->iobase + RME96_IO_CONTROL_REGISTER);
 
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	snd_iprintf(buffer, rme96->card->longname);
+#pragma GCC diagnostic pop
 	snd_iprintf(buffer, " (index #%d)\n", rme96->card->number + 1);
 
 	snd_iprintf(buffer, "\nGeneral settings\n");
diff --git a/sound/usb/mixer_quirks.c b/sound/usb/mixer_quirks.c
index 04991b009132..8f3f2697c96a 100644
--- a/sound/usb/mixer_quirks.c
+++ b/sound/usb/mixer_quirks.c
@@ -100,7 +100,10 @@ static int snd_create_std_mono_ctl_offset(struct usb_mixer_interface *mixer,
 	}
 
 	/* Set name */
+#pragma GCC diagnostic push
+#pragma GCC diagnostic ignored "-Wformat-security"
 	snprintf(kctl->id.name, sizeof(kctl->id.name), name);
+#pragma GCC diagnostic pop
 	kctl->private_free = snd_usb_mixer_elem_free;
 
 	/* set TLV */
-- 
